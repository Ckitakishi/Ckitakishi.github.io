<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Ckitakishi.playground</title><description>Ckitakishi ç›®å‰åœ¨æ—¥æœ¬ä»äº‹ iOS å¼€å‘ï¼Œåœ¨æ­¤ä¹‹å‰æ˜¯ä¸€åå‰ç«¯å¼€å‘è€…ï¼Œå¯¹åŠ¨ç”»å’Œå›¾åƒæ„Ÿå…´è¶£ï¼Œæ­£åœ¨ä¸ºå†™å‡ºä¼˜ç¾çš„ä»£ç è€Œä¿®ç‚¼ã€‚åˆå‡ºèŒ…åºçš„è¯‘è€…ï¼Œå‚ä¸è¯‘æœ‰ã€Šå‡½æ•°å¼ Swiftã€‹å’Œã€Šé›†åˆç±»å‹ä¼˜åŒ–ã€‹ã€‚</description><link>ckitakishi.com</link><language>zh</language><lastBuildDate>Thu, 10 Feb 2022 00:33:18 +0900</lastBuildDate><pubDate>Thu, 10 Feb 2022 00:33:18 +0900</pubDate><ttl>250</ttl><atom:link href="ckitakishi.com/feed.rss" rel="self" type="application/rss+xml"/><item><guid isPermaLink="true">ckitakishi.com/posts/TIL-%E4%B8%8E%E8%A5%BF%E7%93%9C%E4%B8%BA%E4%BC%B4%E7%9A%84%E5%85%AD%E6%9C%88</guid><title>[TIL] ä¸è¥¿ç“œä¸ºä¼´çš„å…­æœˆ</title><description>å…­æœˆä¸»é¢˜ï¼šè™šçœŸè®ºæ–­ï¼ŒWWDC</description><link>ckitakishi.com/posts/TIL-%E4%B8%8E%E8%A5%BF%E7%93%9C%E4%B8%BA%E4%BC%B4%E7%9A%84%E5%85%AD%E6%9C%88</link><pubDate>Thu, 1 Jul 2021 18:46:00 +0900</pubDate><content:encoded><![CDATA[<h1>06/21</h1><h2>Vacuous truth è™šçœŸè®ºæ–­</h2><pre><code>[].<span class="call">allSatisfy</span> { $0 &gt; <span class="number">0</span> }   <span class="comment">// 1</span>
[].<span class="call">allSatisfy</span> { $0 &lt;= <span class="number">0</span> }  <span class="comment">// 2</span>
</code></pre><p>è¯·å›ç­”ï¼Œä¸Šé¢ä¸¤ä¸ªè¡¨è¾¾å¼çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ ç»“æœæ˜¯ï¼Œå®ƒä»¬çš„å€¼éƒ½æ˜¯ <code>true</code>ï¼Œä¸å¾—ä¸æ‰¿è®¤ï¼Œè¿™å¤šå°‘æœ‰ä¸€äº›è¿èƒŒäººçš„ç›´è§‰ã€‚</p><p>åœ¨ swift forums ä¸Šä¹Ÿæœ‰äººå¯¹æ­¤è¡¨ç¤ºäº†ç–‘æƒ‘ï¼š <a href="https://forums.swift.org/t/unexpected-behaviour-of-allsatisfy/20136">https://forums.swift.org/t/unexpected-behaviour-of-allsatisfy/20136</a></p><blockquote><p>Everything is true of the elements of the empty set.</p></blockquote><p>äº‹å®ä¸Šï¼Œå…¶ä¸­è•´å«äº†ç»å…¸çš„é€»è¾‘æ‚–è®ºï¼šå®è´¨è•´å«æ‚–è®ºã€‚å¦‚æœè½¬æ¢ä¸ºä¸­æ–‡ï¼Œå°±æ˜¯ä¸€ç§â€œå¦‚æœ...é‚£ä¹ˆ...â€çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼š</p><ul><li>ï¼ˆç»´åŸºç™¾ç§‘ä¸­è®°è½½çš„ç»å…¸æ¡ˆä¾‹ï¼‰å¦‚æœæˆ¿é—´é‡Œæ²¡æœ‰æ‰‹æœºï¼Œé‚£ä¹ˆæ‰€æœ‰æ‰‹æœºéƒ½æ˜¯å…³æœºçŠ¶æ€ã€‚</li><li>ï¼ˆä¸å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…ï¼‰å¦‚æœå›åˆ°åå¹´å‰ï¼Œé‚£ä¹ˆæˆ‘è¦å¥½å¥½å­¦ä¹ ã€‚</li></ul><p>å¦‚æœ <code>p</code> é‚£ä¹ˆ <code>q</code> è¢«ç§°ä¸º <code>p</code> ä¸ <code>q</code> çš„è•´å«å¼ï¼Œè®°ä½œ <code>p â†’ q</code>ã€‚å…¶çœŸå€¼è¡¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="center">p</th><th align="center">q</th><th align="center">p â†’ q</th></tr></thead><tbody><tr><td align="center">T</td><td align="center">T</td><td align="center">T</td></tr><tr><td align="center">T</td><td align="center">F</td><td align="center">F</td></tr><tr><td align="center">F</td><td align="center">T</td><td align="center">T</td></tr><tr><td align="center">F</td><td align="center">F</td><td align="center">T</td></tr></tbody></table><p>ç»¼ä¸Šï¼Œå½“é›†åˆä¸ºç©ºï¼ˆ<code>p == false</code>ï¼‰æ—¶ï¼Œæ— è®º <code>q</code> æ˜¯ä»€ä¹ˆæ¡ä»¶å®ƒä»¬çš„è•´å«å¼éƒ½ä¸€å®šä¸ºçœŸï¼Œè¿™ä¹Ÿå°±æ˜¯éœ€çœŸè®ºæ–­ã€‚è•´å«å¼çš„æ­£ç¡®å¹¶ä¸æ„å‘³ç€ç”Ÿæ´»ä¸­ä¸€äº›å…³ç³»çš„åˆç†æ€§ï¼Œå°†å®ƒå½“ä½œä¸€ç§æ—¢å®šçš„é€»è¾‘å°±å¯ä»¥ã€‚</p><hr><h1>06/xx</h1><p>åšäº†è‡ªå·±è®¤ä¸ºåº”å½“æœ‰äººå»åšçš„äº‹æƒ…ï¼Œæ·±å…¥å­¦ä¹ äº†ä»Šå¹´ WWDC çš„ Accessibility ä¸“é¢˜ï¼Œå¹¶å†™äº†ä»¥ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š</p><p>ä¸ºå†…å®¹ä¸°å¯Œçš„åº”ç”¨é‡èº«æ‰“é€ é«˜æ•ˆ VoiceOver ä½“éªŒï¼šhttps://xiaozhuanlan.com/topic/7392456081 å›¾è¡¨çš„æ— éšœç¢æ”¯æŒè¿›é˜¶ï¼šhttps://xiaozhuanlan.com/topic/7904561328</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/TIL-%E6%A2%85%E9%9B%A8%E6%8F%90%E6%97%A9%E5%88%B0%E6%9D%A5%E7%9A%84%E4%BA%94%E6%9C%88</guid><title>[TIL] æ¢…é›¨ææ—©åˆ°ä¾†çš„äº”æœˆ</title><description>äº”æœˆä¸»é¢˜ï¼šbyWordWrapping - å­¤ç‹¬çš„å•è¯ï¼ŒfileSystemRepresentation, stat - st_size æ˜¯ä»€ä¹ˆç±»å‹, lineHeight and lineSpacing...</description><link>ckitakishi.com/posts/TIL-%E6%A2%85%E9%9B%A8%E6%8F%90%E6%97%A9%E5%88%B0%E6%9D%A5%E7%9A%84%E4%BA%94%E6%9C%88</link><pubDate>Tue, 1 Jun 2021 00:10:00 +0900</pubDate><content:encoded><![CDATA[<p>è®°å½•æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„</p><ol><li>æ–°çŸ¥</li><li>å¯¹æ—§çŸ¥è¯†çš„æ–°è®¤çŸ¥</li><li>é‡æ–°å”¤èµ·çš„è®°å¿†</li><li>review ä¸­é‡åˆ°çš„ä¸€äº›æœ‰è¶£çš„é—®é¢˜</li></ol><h1>05/30</h1><h2>byWordWrapping - å­¤ç‹¬çš„å•è¯</h2><p>æœ‰ä¸€æ®µç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼Œå’Œä¸€ä¸ªå­—ç¬¦ä¸² â€œThis message could not be deliveredâ€ï¼Œå‡è®¾ label çš„å®½åº¦æ­£å¥½ä¼šå¯¼è‡´å­—ç¬¦ä¸²åœ¨ delivered å‰è¢«æˆªæ–­ã€‚</p><pre><code>label.<span class="property">numberOfLines</span> = <span class="number">0</span>
label.<span class="property">lineBreakMode</span> = .<span class="dotAccess">byWordWrapping</span>
</code></pre><p>è¿™æ—¶å€™ï¼Œä¸‹é¢è¿™æ ·çš„æ¢è¡Œæ–¹å¼æ˜¯ä¸ä¼šå‡ºç°çš„ï¼š</p><pre><code><span class="type">This</span> message could not be
delivered
</code></pre><p>å®é™…ä¸Šå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯ä»¥ä¸‹ï¼š</p><pre><code><span class="type">This</span> message could not 
be delivered
</code></pre><p>ä¹ä¸€çœ‹ï¼Œå¤šå°‘è®©äººæœ‰äº›æ‘¸ä¸ç€å¤´è„‘ï¼Œç„¶è€Œè¿™æ˜¯ä¸€ä¸ª Apple åˆ»æ„è€Œä¸ºä¹‹çš„è®¾è®¡ï¼Œç›®çš„åœ¨äºé¿å…å­¤è¯å¯¡è¡Œçš„å‡ºç°ã€‚å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="https://stackoverflow.com/questions/46200027/uilabel-wrong-word-wrap-in-ios-11">https://stackoverflow.com/questions/46200027/uilabel-wrong-word-wrap-in-ios-11</a></li></ul><p>ä¸ªäººè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„è®¾è®¡ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ä»»ä½•é€”å¾„å¯ä»¥ç¦æ­¢è¿™ç§æ¢è¡Œæ–¹å¼ï¼Œè¿™å¤šå°‘ä¼šå¸¦æ¥ä¸€äº›ä¸ä¾¿ï¼Œå¥½åœ¨ä» iOS 14 å¼€å§‹ï¼Œç»ˆäºå¯ä»¥é€šè¿‡è®¾ç½® <code>lineBreakStrategy</code> æ¥é¿å…è¿™æ ·çš„æ¢è¡Œã€‚</p><pre><code><span class="keyword">if #available</span>(iOS <span class="number">14.0</span>, *) {
    label.<span class="property">lineBreakStrategy</span> = []
}
</code></pre><hr><h1>05/27</h1><h2>fileSystemRepresentation</h2><p>æœ€è¿‘ä¾ç„¶åœ¨ä¸º ZIPFoundation åš zip64 çš„æ”¯æŒï¼Œå½“ä½¿ç”¨ <code>fopen</code> æ‰“å¼€æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ç±»ä¼¼ä¸‹è¿°çš„ä»£ç ã€‚åœ¨ POSIX ç³»ç»Ÿä¸­ç›´æ¥ä½¿ç”¨ <code>UTF8String</code> å¹¶ä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„åŠæ³•ï¼Œä½¿ç”¨ <code>fileSystemRepresentation</code> å…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ–‡ä»¶ç³»ç»Ÿçš„è§„èŒƒå½¢å¼ç„¶åç”¨ <code>UTF-8</code> ç¼–ç ä¼šæ¯”è¾ƒå®‰å…¨ã€‚</p><pre><code><span class="keyword">let</span> representation = <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">fileSystemRepresentation</span>(withPath: path)
<span class="keyword">let</span> file: <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">FILE</span>&gt; = <span class="call">fopen</span>(representation, <span class="string">"r+b"</span>)
</code></pre><p>å‚è€ƒé“¾æ¥ï¼š</p><ol><li><a href="https://objccn.io/issue-9-2/">https://objccn.io/issue-9-2/</a></li><li><a href="https://github.com/ZipArchive/ZipArchive/issues/326">https://github.com/ZipArchive/ZipArchive/issues/326</a><ul><li>è¿™å…¶ä¸­æåˆ°ä¸€ä¸ªçœŸå®å‘ç”Ÿçš„æ¡ˆä¾‹ï¼Œåœ¨ iOS 10.2 ä¸­ä½¿ç”¨ <code>UTF8String</code> æ¥åˆ›å»ºæ–‡ä»¶åï¼Œå¾ˆæœ‰å¯èƒ½åœ¨ iOS 10.3 ä¸Šæ— æ³•æ‰“å¼€ã€‚è¿™å…¶ä¸­çš„åŸå› ï¼Œå¤§æ¦‚ç‡åœ¨äº 10.2 çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ <code>HFS+</code>ï¼Œè€Œ 10.3 æ˜¯ <code>APFS</code>ã€‚</li></ul></li></ol><hr><h1>05/19</h1><h2>stat - st_size æ˜¯ä»€ä¹ˆç±»å‹</h2><p>è·å–æ–‡ä»¶å¤§å°çš„æ–¹å¼ï¼š</p><ol><li>FileAttributeKey</li></ol><pre><code><span class="keyword">let</span> attr = <span class="keyword">try</span> <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">attributesOfItem</span>(atPath: filePath)
<span class="keyword">let</span> fileSize = attr[<span class="type">FileAttributeKey</span>.<span class="property">size</span>] <span class="keyword">as</span>? <span class="type">UInt64</span>
</code></pre><ol start="2"><li>stat</li></ol><pre><code><span class="keyword">let</span> representation = <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">fileSystemRepresentation</span>(withPath: filePath)
<span class="keyword">var</span> fileStat = <span class="call">stat</span>()
<span class="call">lstat</span>(representation, &amp;fileStat)
<span class="keyword">let</span> fileSize = fileStat.<span class="property">st_size</span>
</code></pre><ul><li>å…³äº <code>st_size</code> çš„ç±»å‹ï¼Œæ ¹æ® link1ï¼Œå®ƒæ˜¯ <code>off_t</code>ï¼›æ ¹æ® link2ï¼Œ<code>off_t</code> æ˜¯ <code>__darwin_off_t</code> ï¼›æ ¹æ®æœ€åä¸€ä¸ª linkï¼Œå¯ä»¥çŸ¥é“å…¶å®æ˜¯ <code>int64</code> ã€‚å¿…é¡»è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡ç”¨äºè¡¨ç¤º sizeï¼Œå®ƒå¹¶éä¸€ä¸ªæ— ç¬¦å·çš„æ•°ã€‚<ol><li><a href="https://opensource.apple.com/source/xnu/xnu-4570.41.2/bsd/sys/stat.h.auto.html">https://opensource.apple.com/source/xnu/xnu-4570.41.2/bsd/sys/stat.h.auto.html</a></li><li><a href="https://opensource.apple.com/source/xnu/xnu-2422.1.72/bsd/sys/_types/_off_t.h.auto.html">https://opensource.apple.com/source/xnu/xnu-2422.1.72/bsd/sys/<em>types/</em>off_t.h.auto.html</a></li><li><a href="https://opensource.apple.com/source/xnu/xnu-2782.30.5/bsd/sys/_types.h.auto.html">https://opensource.apple.com/source/xnu/xnu-2782.30.5/bsd/sys/_types.h.auto.html</a></li></ol></li></ul><hr><h1>05/14</h1><h2>AVPlayer</h2><p>ä¸€ç¯‡éå¸¸ç®€æ˜çš„é˜è¿°å¦‚ä½•ä½¿ç”¨ <code>AVPlayer</code> çš„æ–‡ç« ï¼š</p><p><a href="https://medium.com/free-code-camp/how-to-set-up-video-streaming-in-your-app-with-avplayer-7dc21bb82f3">https://medium.com/free-code-camp/how-to-set-up-video-streaming-in-your-app-with-avplayer-7dc21bb82f3</a></p><h2>HLS - HTTP Live Streaming</h2><p>HLS æ˜¯ä¸€ä¸ª Apple å®šä¹‰çš„æµä¼ è¾“åè®®ï¼ŒåŸºäº HTTP å®ç°ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒçš„åç¼€æ˜¯ <code>.m3u8</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨ <code>UTF-8</code> ç¼–ç çš„ Unicode ç‰ˆæœ¬ <code>M3U</code> ã€‚å¯¹äºè§†é¢‘æŠ€æœ¯çŸ¥ä¹‹ç”šå°‘çš„æˆ‘è€Œè¨€åˆè¦é—®ï¼Œé‚£ M3U æ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç»´åŸºï¼ŒM3U æ–‡ä»¶æ˜¯ä¸€ç§çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªå¤šåª’ä½“æ–‡ä»¶çš„ä½ç½®ã€‚</p><p>å…³äº HLS æ˜¯ä»€ä¹ˆï¼Œ<code>m3u8</code> çš„ç»“æ„æ˜¯ä»€ä¹ˆæ ·ï¼Œæ–‡æ¡£ä¸­çš„å›¾ç‰‡éå¸¸æ¸…æ™°æ˜“æ‡‚ï¼š<a href="https://developer.apple.com/library/archive/referencelibrary/GettingStarted/AboutHTTPLiveStreaming/about/about.html">https://developer.apple.com/library/archive/referencelibrary/GettingStarted/AboutHTTPLiveStreaming/about/about.html</a></p><p>HLS æ‹¥æœ‰é«˜æ€§èƒ½ï¼Œé«˜å…¼å®¹æ€§ï¼Œä½œä¸ºä»£ä»·ï¼Œåˆ‡ç‰‡å’ŒæŸ¥è¯¢å¯¼è‡´äº†è¾ƒé«˜çš„å»¶è¿Ÿã€‚2019 å¹´ï¼ŒApple ä»‹ç»äº†</p><p><a href="[https://developer.apple.com/videos/play/wwdc2019/502/](https://developer.apple.com/videos/play/wwdc2019/502/">ILow-Latency HLS</a>)ã€‚</p><hr><h1>05/13</h1><h2>lineHeight and lineSpacing</h2><p>æ— æ³•é€šè¿‡ <code>UILabel</code> çš„å±æ€§æ¥ç›´æ¥è®¾ç½®è¡Œé«˜ï¼Œä½†æ˜¯å¯ä»¥ä¸º Attributed String æ¥è®¾ç½®è¿™äº›å€¼ã€‚</p><p>é™¤äº† lineSpacingï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ lineHeight ç›¸å…³çš„å‡ ä¸ªå±æ€§ï¼Œä¾‹å¦‚:</p><pre><code>minimumLineHeight
maximumLineHeight
lineHeightMultiple
</code></pre><p>ä½†äº‹å®ä¸Š iOS çš„è¡Œé«˜å’Œ CSS Flexbox ä¸­ä»¥åŠé€šå¸¸è®¤çŸ¥ä¸­çš„è¡Œé«˜å¹¶ä¸å®Œå…¨ç›¸åŒã€‚å‚è§ä¸‹å›¾ï¼š</p><p>æ‰€ä»¥å¦‚æœéœ€è¦é€šå¸¸æ„ä¹‰ä¸Šçš„è¡Œé«˜ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® baselineOffset æ¥å®ç°ã€‚</p><pre><code><span class="keyword">let</span> paragraphStyle = <span class="type">NSMutableParagraphStyle</span>()
paragraphStyle.<span class="property">lineHeightMultiple</span> = <span class="number">1.6</span>

label.<span class="property">attributedText</span> = <span class="type">NSAttributedString</span>(
    string: <span class="string">"......"</span>,
    attributes: [
        .<span class="dotAccess">baselineOffset</span>: ......,
        .<span class="dotAccess">paragraphStyle</span>: paragraphStyle
    ]
)
</code></pre><hr><h1>05/07</h1><h2>Apple's Compression Algorithms</h2><p>å½“è®¨è®ºä¸€ä¸ªå‹ç¼©ç®—æ³•çš„æ—¶å€™ï¼Œå‹ç¼©ç‡å’Œé€Ÿåº¦æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªç»´åº¦ã€‚</p><p>Apple è‡ªå·±çš„å‹ç¼©æ¡†æ¶ä¹Ÿæä¾›äº†å¤šç§ç®—æ³•:</p><blockquote><p>WWDC2015 Session 712</p></blockquote><p>Balanced: <code>zlib</code> and <code>lzfse</code> High compression, slow: <code>lzma</code> Low compression, fast: <code>lz4</code></p><hr><h1>05/06</h1><h2>setUp()/tearDown()</h2><ul><li>instance method: each test method</li><li>class method: all test methods</li></ul><h2>globallyUniqueString</h2><p>ä¸€èˆ¬æ¥è¯´æåˆ°å”¯ä¸€æ ‡å¿—ç¬¦æˆ‘ä»¬å¸¸å¸¸ä¼šå…ˆæƒ³åˆ° <code>UUID</code> ï¼Œä¾‹å¦‚ç”¨ä¸‹è¿°æ–¹æ³•æ¥ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„å­—ç¬¦ä¸²ï¼š</p><pre><code><span class="type">UUID</span>().<span class="property">uuidString</span>
</code></pre><p>ä½†å¦‚æœæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä½¿ç”¨è¿›ç¨‹çº§åˆ«çš„å”¯ä¸€å­—ç¬¦ä¸²ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªå¥½åŠæ³•ã€‚å…¶ä¸­åŒ…å«äº†ä¸»æœºåï¼Œè¿›ç¨‹ IDï¼Œæ—¶é—´æˆ³ï¼Œæ¥ä¿è¯å…¶å”¯ä¸€æ€§ã€‚</p><pre><code><span class="type">ProcessInfo</span>.<span class="property">processInfo</span>.<span class="property">globallyUniqueString</span>
</code></pre>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/TIL-%E5%B9%B4%E5%A4%8D%E4%B8%80%E5%B9%B4%E6%84%8F%E8%AF%86%E5%88%B0%E6%88%90%E9%95%BF%E7%9A%84%E5%9B%9B%E6%9C%88</guid><title>[TIL] å¹´å¤ä¸€å¹´æ„è¯†åˆ°æˆé•¿çš„å››æœˆ</title><description>ä¸ƒæœˆä¸»é¢˜ï¼šUniform Type Identifierï¼Œautoreleasepool, ZIPFoundation(ZIP64), CRC32 (Cyclic redundancy check), SQL - Prepared Statement, Attributes in Swift...</description><link>ckitakishi.com/posts/TIL-%E5%B9%B4%E5%A4%8D%E4%B8%80%E5%B9%B4%E6%84%8F%E8%AF%86%E5%88%B0%E6%88%90%E9%95%BF%E7%9A%84%E5%9 ... E6%9C%88</link><pubDate>Sat, 1 May 2021 19:29:00 +0900</pubDate><content:encoded><![CDATA[<p>è®°å½•æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„ 1. æ–°çŸ¥ 2. å¯¹æ—§çŸ¥è¯†çš„æ–°è®¤çŸ¥ 3. é‡æ–°å”¤èµ·çš„è®°å¿† 4. review ä¸­é‡åˆ°çš„ä¸€äº›æœ‰è¶£çš„é—®é¢˜</p><h1>04/23</h1><hr><h2>UTI - Uniform Type Identifier</h2><p>åŒäº‹åœ¨åˆ†äº«ä¼šä¸­è¯¦ç»†è®²äº† UTIï¼Œç”¨è¿‡å¾ˆå¤šæ¬¡ï¼Œä½†å¤§æ¦‚ä¸€ç›´éƒ½åªæ‡‚ä¸‰æˆå§ï¼Œå¬å®Œåå¯¹ UTI çš„ç†è§£æ˜æ˜¾æ›´ç³»ç»ŸåŒ–äº†ä¸€äº›XD</p><p>èƒ½ä¸€ç¬é—´æƒ³èµ·æ¥çš„è¿ç”¨åœºæ™¯æœ‰ï¼š</p><ol><li>Share Extension</li><li>Drag and Drop</li><li>Pasteboard</li></ol><p>ç®€å•æ¥è¯´ï¼Œå¯¹äºæ–‡æœ¬ç±»å‹è€Œè¨€ï¼Œæ‰©å±•åå¯ä»¥æ˜¯ <code>.txt</code> æˆ– <code>.text</code>ï¼Œè€Œ MIME ç±»å‹æ˜¯ <code>text/plain</code>ï¼Œå½“æˆ‘ä»¬è¦å¤„ç†æ–‡æœ¬ç±»å‹æ—¶ï¼Œå¿…é¡»å°†ä»¥ä¸Šæ‰€æœ‰ç±»å‹å…¨éƒ¨è§†ä¸ºå¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä»¶éå¸¸ç¼ºä¹æ•ˆç‡çš„äº‹æƒ…ï¼Œè€Œ UTI å°±æ˜¯ç”¨æ¥å¤„ç†è¿™ä¸ªé—®é¢˜çš„ï¼Œä»–å°†æ‰€æœ‰ç±»å‹éƒ½ç»Ÿä¸€ä¸ºäº† <code>public.text</code>ï¼ŒUTI ç±»å‹å’Œå…¶ä»–æ‰€æœ‰ç±»å‹ç›¸äº’å…¼å®¹ã€‚</p><p>Refï¼šå…³äºè‡ªå®šä¹‰ UTI ç±»å‹ï¼ŒUTI ç±»å‹çš„ç»§æ‰¿æ€§ â€” <a href="https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html">https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding<em>utis/understand</em>utis<em>conc/understand</em>utis_conc.html</a></p><h1>04/20</h1><hr><h2>autoreleasepool</h2><p>æœ€è¿‘åšäº†ä¸€ç‚¹ Objective-C è½¬ Swiftï¼Œåœ¨ Objective-C ä¸­æˆ‘ä»¬å¸¸å¸¸ä¼šéœ€è¦ä½¿ç”¨ autoreleasepoolï¼Œä½†å¹¶ä¸æ„å‘³ç€é‡åˆ° Swift ä¹‹å <code>autoreleasepool</code> å°±ä¸å†éœ€è¦è€ƒè™‘ã€‚å½“ Swift è°ƒç”¨ Objective-C ä»£ç ï¼Œäº¦æˆ–æ˜¯ Objective-C è°ƒç”¨è¢«æ ‡è®°ä¸º @objc çš„ Swift æ–¹æ³•æ—¶ï¼Œå¦‚æœæ–¹æ³•è¿”å›çš„æ˜¯ autorelease çš„å€¼ï¼Œé‚£ Swift ä¹Ÿä¼šä¿æŒè¿™ä¸ªå€¼çš„ autorelease ç‰¹æ€§ã€‚</p><p>åœ¨ Objective-C ä¸­ï¼Œæœ‰æ—¶å€™ä¼šåœ¨å¾ªç¯ä¸­å†™ <code>autoreleasepool</code> æ¥é¿å…å†…å­˜çˆ†ç‚¸ï¼Œå› ä¸ºå¾ªç¯çš„æŒç»­ä¼šå¯¼è‡´æ²¡æœ‰æœºä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€‚</p><h1>04/15</h1><hr><h2>ZIPFoundation</h2><p><a href="https://thomas.zoechling.me/journal/2017/07/ZIPFoundation.html">https://thomas.zoechling.me/journal/2017/07/ZIPFoundation.html</a></p><p>A ZIP compression framework don't based on any 3rd party framework. Almost all of the swift ZIP framework based on minizip.</p><p>å°½ç®¡è¿™ä¸ªæ¡†æ¶ååˆ†ç®€æ´ç”šè‡³æ— æ³•å®Œå…¨æ»¡è¶³è¦æ±‚ï¼Œä½†ä½œè€…çš„è¿™ç¯‡æ–‡ç« è¿˜æ˜¯å¾ˆå€¼å¾—ä¸€è¯»ï¼Œåœ¨è®¾è®¡æ¡†æ¶æ—¶è€ƒè™‘çš„ä¸€äº›ç‚¹å¾ˆæœ‰å‚è€ƒä»·å€¼ã€‚</p><h2>ZIP64</h2><p><a href="https://en.wikipedia.org/wiki/ZIP_(file_format">https://en.wikipedia.org/wiki/ZIP<em>(file</em>format)#ZIP64</a>#ZIP64)</p><p>æ ‡å‡† ZIP æœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚ä¸èƒ½å®¹çº³è¶…è¿‡ 65535 ä¸ªæ–‡ä»¶ï¼ˆå› ä¸º eocd ä¸­åªæœ‰ 2 bytes ç”¨æ¥å­˜ entry çš„ä¿¡æ¯ã€‚ã€‚ï¼‰ï¼Œå‹ç¼©æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 4G ä¹‹ç±»ï¼Œå› æ­¤å‡ºç°äº† ZIP64 æ ‡å‡†ã€‚</p><h1>04/13</h1><hr><h2>CRC32 (Cyclic redundancy check)</h2><p>ZIP å‹ç¼©ä¸­ä½¿ç”¨çš„æ ¡éªŒæ–¹å¼æ˜¯ CRC32ï¼Œæ˜¯ CRCï¼ˆå¾ªç¯å†—ä½™æ ¡éªŒï¼‰æ–¹æ³•ä¸­çš„å…¶ä¸­ä¸€ç§ã€‚</p><p>è®°å¿†ä¸­ç¬¬ä¸€æ¬¡çŸ¥é“ CRC æ˜¯åœ¨å¯†ç å­¦çš„è¯¾æœ¬ä¸Šï¼Œå¥‡å¶æ ¡éªŒï¼Œ50% çš„å‡ºé”™æ¦‚ç‡ï¼Œè¿˜æœ‰æ ¡éªŒå’Œï¼Œä¹Ÿæœ‰ä¸å°çš„å‡ºé”™å¯èƒ½æ€§ï¼Œæ­¤å¤–å°±æ˜¯ CRC äº†ï¼Œå› ä¸ºé«˜æ•ˆä¸”æ£€é”™åŠ›å¾ˆé«˜ï¼Œè¢«å¹¿æ³›ç”¨åœ¨å­˜å‚¨ï¼Œå‹ç¼©ç­‰ä¹‹ä¸­ã€‚CRC32 æ˜¯ CRC æ ¡éªŒä¸­æœ€è¢«å¹¿æ³›ä½¿ç”¨çš„ä¹‹ä¸€ï¼Œä½†ä»–å¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå³ä¾¿ç¯¡æ”¹äº†å†…å®¹ï¼Œç”¨ CRC32 è¿›è¡Œæ ¡éªŒä¾ç„¶å¯èƒ½ä¼šå¾—åˆ°ç›¸åŒçš„å€¼ã€‚</p><p>é¢˜å¤–è¯ï¼Œå¦‚ä½•åœ¨å„ç§è¯­è¨€ä¸­ä½¿ç”¨ CRC32ï¼š<a href="https://rosettacode.org/wiki/CRC-32#Swift">https://rosettacode.org/wiki/CRC-32#Swift</a>ã€‚Swift çš„å®ç°æ³•å¯ä»¥è¯´å¹¶ä¸ä¸€å®šå®ç”¨ï¼Œä»–é€‰æ‹©äº†ç›´æ¥è°ƒç”¨ zlib ä¸­çš„ crc32 æ–¹æ³•w</p><h2>Strange Date Format</h2><p>e.g. 04/01, template = "Md"</p><p>en_US â‡’ 4/1</p><p>ja_JP â‡’ 4/1</p><p>en_JP â‡’ 04/01</p><blockquote><p><a href="https://stackoverflow.com/questions/67073224/get-a-unexpected-date-string-when-setting-template-to-md">https://stackoverflow.com/questions/67073224/get-a-unexpected-date-string-when-setting-template-to-md</a></p></blockquote><p>Still donâ€˜t know why Apple making this design..But we could resolve this <em>unexpected problem</em> by:</p><pre><code>formatter.<span class="property">dateFormat</span> = <span class="type">DateFormatter</span>.<span class="call">dateFormat</span>(
    fromTemplate: <span class="string">" Md"</span>,
    options: <span class="number">0</span>,
    locale: <span class="type">Locale</span>(identifier: <span class="string">"en_JP"</span>)
)?
.<span class="call">replacingOccurrences</span>(of: <span class="string">"MM"</span>, with: <span class="string">"M"</span>)
.<span class="call">replacingOccurrences</span>(of: <span class="string">"dd"</span>, with: <span class="string">"d"</span>)
</code></pre><h1>04/12</h1><hr><h2>SQL - Prepared Statement</h2><blockquote><p>INSERT INTO products (name, price) VALUES (?, ?);</p></blockquote><p>é€šå¸¸è¿™ä¹ˆåšçš„ä¼˜ç‚¹æ˜¯ï¼š</p><ol><li>é˜²æ­¢ SQL æ³¨å…¥</li><li>æ•ˆç‡æ›´é«˜ï¼Œé¿å…äº†å¤šæ¬¡è§£æç›¸åŒç»“æ„çš„ SQL è¯­å¥</li><li>...</li></ol><h1>04/08</h1><hr><h2>Attributes in Swift</h2><p>åˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><pre><code><span class="number">1</span>. <span class="keyword">@attribute</span> name
<span class="number">2</span>. <span class="keyword">@attribute</span>(attribute arguments)
</code></pre><p>ä»Šå¤©å†™äº†å†™ @inlineï¼Œå›å¿†äº†å‡ ä¸ªå¸¸ç”¨çš„ï¼š</p><h3>@inline å†…è”</h3><p>åœ¨ç¼–è¯‘çš„é˜¶æ®µç”¨å‡½æ•°ä½“å»æ›¿æ¢å‡½æ•°è°ƒç”¨ã€‚ä¼˜ç‚¹æ˜¯å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œä½†ä½œä¸ºäº¤æ¢ï¼Œbinary size ä¼šç•¥æœ‰å¢å¤§ã€‚</p><ul><li>@inline(_always) å¼ºåˆ¶å†…è”ï¼ˆä¸æ˜¯ 100%ï¼Œä¹Ÿæœ‰ä¾‹å¤–ï¼‰</li><li>@inline(never) æ— è®ºå¦‚ä½•éƒ½ä¸å†…è”</li></ul><h3>@inlinable å¯å†…è”</h3><p>å’Œ @inline çœ‹èµ·æ¥å¾ˆåƒï¼Œä½†æœ‰ç€æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚@inlinable å¯ä»¥ç”¨åœ¨ public å’Œ internal çš„æ–¹æ³•ï¼Œè®¡ç®—å±æ€§ç­‰ä¹‹ä¸Šï¼Œè¿™æ ·åœ¨æ¨¡å—å¤–è¢«è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œå†…è”ä¼˜åŒ–ã€‚è™½ç„¶å¯ä»¥è¢«ä¼˜åŒ–ï¼Œä½† internal ä¾ç„¶æ˜¯ä¸å¯ä»¥è¢«è®¿é—®çš„ï¼Œå¦å¤–ï¼Œå½“ä¸”ä»…ä½† internal è¢«æ ‡è®°ä¸º @usableFromInline çš„æ—¶å€™æ‰ä¼šè¢«ä½œä¸ºå¯¹è±¡ã€‚å¦‚æœåªå­˜åœ¨ä¸€ä¸ªæ¨¡å—ï¼Œå¹¶æ²¡æœ‰åªç”¨ @inlinable çš„å¿…è¦ã€‚</p><h3>@discardableResult å¯å¿½ç•¥çš„è¿”å›å€¼</h3><p>å…è®¸æœ‰è¿”å›å€¼çš„æ–¹æ³•ä¸è¿”å›ä»»ä½•å€¼</p><h3>@available</h3><p>æ˜¯ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„ attributeï¼Œç”¨äºæŒ‡å®šæœ€ä½ swift ç‰ˆæœ¬ï¼Œplatform çš„ç‰ˆæœ¬ä¹‹ç±»ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¼šå†™ @available(swift 99) æ¥é¿å…è¢« swift è°ƒç”¨ï¼Œ@available(iOS 14.0) æ¥ä½¿ç”¨ 14.0 æœ€æ–°çš„ APIã€‚</p><p>Ref. <a href="https://docs.swift.org/swift-book/ReferenceManual/Attributes.html#">https://docs.swift.org/swift-book/ReferenceManual/Attributes.html#</a></p><h1>04/07</h1><hr><h2>Access Photo Library</h2><p>Plist</p><ul><li>NSPhotoLibraryAddUsageDescription</li><li>NSPhotoLibraryUsageDescription</li><li>NSCameraUsageDescription</li></ul><h2>Render a UIView to a UIImage</h2><pre><code><span class="keyword">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(size: view.<span class="property">bounds</span>.<span class="property">size</span>)
<span class="keyword">let</span> image = renderer.<span class="call">image</span> { context <span class="keyword">in</span>
    view.<span class="call">drawHierarchy</span>(in: view.<span class="property">bounds</span>, afterScreenUpdates: <span class="keyword">true</span>)
}
</code></pre><h2>Take screenshot programmatically</h2><p><a href="https://developer.apple.com/library/archive/qa/qa1703/_index.html">https://developer.apple.com/library/archive/qa/qa1703/_index.html</a> (Outdated..)</p><h1>04/06</h1><hr><h2>Multi-cursor editing in Xcode</h2><ul><li>To add a new cursor, hold Control and SHIFT then click.</li><li>Hold Control and SHIFT then â†‘ or â†“</li><li>Hold Option then drag cursor around.</li></ul><h2>Formatter</h2><p><a href="https://nshipster.com/formatter/">https://nshipster.com/formatter/</a></p><p>å½“ä¸è®¾ç½®é»˜è®¤ template çš„æƒ…å†µä¸‹ï¼Œä¼šæŒ‰ç…§å„ <code>locale</code> çš„é»˜è®¤æ¨¡ç‰ˆæ¥æ˜¾ç¤ºæ—¥æœŸã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code><span class="comment">// JP: 2021/03/01
// KR: 2021.3.1.</span>

<span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()
formatter.<span class="property">locale</span> = locale
formatter.<span class="property">calendar</span> = <span class="type">Calendar</span>.<span class="property">autoupdatingCurrent</span>
formatter.<span class="property">dateStyle</span> = .<span class="dotAccess">short</span>
formatter.<span class="property">timeStyle</span> = .<span class="dotAccess">none</span>
</code></pre><p>è¿™åº”å½“è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¥½çš„å®è·µï¼Œå®Œå…¨å¯ä»¥å½“ä¸”ä»…å½“å¿…è¦çš„æ—¶å€™ä¸º <code>formatter</code> è®¾ç½® templateã€‚</p><h2>Detect user takes a screenshot</h2><pre><code><span class="type">NotificationCenter</span>.<span class="property">default</span>.<span class="call">addObserver</span>(
    <span class="keyword">self</span>,
    selector: <span class="keyword">#selector</span>(xxxxxx),
    name: <span class="type">UIApplication</span>.<span class="property">userDidTakeScreenshotNotification</span>,
    object: <span class="keyword">nil</span>
)
</code></pre><p>æ ¹æ®æ–‡æ¡£å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªé€šçŸ¥çš„ <code>userInfo</code> ä¸­å¹¶ä¸åŒ…å«ä»»ä½•ä¿¡æ¯ï¼Œä¸€ä¸ªæœ‰äº›ä»¤äººç»æœ›çš„æ¶ˆæ¯ã€‚è€ƒè™‘ä¸¤ä¸ªæ–¹æ¡ˆæ¥è·å¾—å›¾ç‰‡ã€‚</p><ol><li>ä»ç›¸å†Œè¯»å–ç¬¬ä¸€å¼ ç…§ç‰‡ï¼Œå¤šå°‘æœ‰äº› workaround çš„æ„å‘³ï¼Œå¹¶ä¸”éœ€è¦ç›¸å†Œæƒé™ã€‚</li><li>é‡æ–°æˆªå–å›¾ç‰‡ï¼Œæ½œåœ¨çš„é—®é¢˜æ˜¯æˆªå›¾å’Œç³»ç»Ÿæˆªå›¾å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚</li></ol><h1>04/05</h1><hr><h2>Long polling</h2><p>é•¿è½®è¯¢ï¼Œä¸è½®è¯¢çš„åŒºåˆ«åœ¨äºï¼Œåè€…æ˜¯ client å®šæœŸå»æ‹‰å–æ›´æ–°ï¼Œç»å¸¸ä¼šå¾—åˆ°ç©º responseï¼›è€Œé•¿è½®è¯¢ä¼š hold ä½è¿æ¥ï¼Œç›´åˆ° server æœ‰æ›´æ–°æ‰ä¼šè¿”å›ã€‚çœ‹ä¼¼ä¸€ç§ push çš„æ–¹å¼ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ pullã€‚</p><h1>04/02</h1><hr><h2>XCTUnwrap()</h2><p><a href="https://www.hackingwithswift.com/example-code/testing/how-to-check-and-unwrap-optionals-in-tests-using-xctunwrap">https://www.hackingwithswift.com/example-code/testing/how-to-check-and-unwrap-optionals-in-tests-using-xctunwrap</a></p><p>Easy to read than <code>guard</code> and <code>let</code>..</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/2020-%E6%9C%80%E5%90%8E%E4%B8%80%E5%A4%A9%E6%88%91%E5%9C%A8%E6%83%B3%E4%BB%80%E4%B9%88</guid><title>2020 æœ€åä¸€å¤©æˆ‘åœ¨æƒ³ä»€ä¹ˆ</title><description>2020 å›é¡¾ &amp; 2021 æœŸè®¸</description><link>ckitakishi.com/posts/2020-%E6%9C%80%E5%90%8E%E4%B8%80%E5%A4%A9%E6%88%91%E5%9C%A8%E6%83%B3%E4%BB%80%E4%B9%88</link><pubDate>Fri, 1 Jan 2021 21:43:00 +0900</pubDate><content:encoded><![CDATA[<h1>2020 æœ€åä¸€å¤©æˆ‘åœ¨æƒ³ä»€ä¹ˆ</h1><blockquote><p>2020.12.31 / æ™´</p></blockquote><h2>2020</h2><p>æ¯•ä¸šåçš„å‡ å¹´é—´ï¼Œå¤§å¤šæ•°çš„å¹´æœ«å¹´å§‹éƒ½åœ¨è·¯ä¸Šæˆ–è€…å³å°†å¯ç¨‹ï¼Œ15 çš„æ¹˜å—ï¼Œ17 çš„åŒ—æµ·é“ï¼Œ18 çš„å·æ¸ï¼Œ19 çš„åŒ—é™†...åœ¨ä¸€ä¸ªä¸ªæ™®é€šçš„æ—¥å­é‡Œå†™ä¸‹çè´µçš„è®°å¿†ï¼Œè®©å®ƒä»¬æœ‰äº†ç‰¹åˆ«çš„æ„ä¹‰ã€‚ä¸‹åˆèµ°åœ¨è¡—ä¸Šï¼Œæ—¥è½å°†è¿‘ï¼Œèµ¶ç´§éšæ‰‹æ‹äº†ä¸€å¼ ç…§ç‰‡æ¥è®°å½• 2020 æœ€åçš„å¤•æ—¥ï¼Œä¸€ç¬é—´æœ‰äº›ææƒšï¼Œä¸ç¡®å®šæ˜å¹´çš„æ­¤åˆ»æˆ‘æ˜¯å¦è¿˜ä¼šè®°å¾—è¿™ä¸€å¤©ã€‚</p><p>å…³äº 2020ï¼Œå¤§å¤šæ•°äººçš„ç”Ÿæ´»æˆ–å¤šæˆ–å°‘éƒ½å—åˆ°äº†ä¸€äº›è´Ÿé¢å½±å“ï¼ŒçŒœæƒ³å¾ˆå¤šäººéƒ½åœ¨å¿ƒä¸­é»˜é»˜æƒ³è¿‡ï¼Œâ€œå¦‚æœæ²¡æœ‰ç–«æƒ…...â€ï¼Œâ€œç–«æƒ…è¿‡å...â€ã€‚æˆ‘äº¦æ˜¯å¦‚æ­¤ï¼Œä¸€æ–¹é¢è¿™å‡ å¹´å¤šäº†ä¸€äº›çƒ¦æ¼å’Œå¿§è™‘ï¼Œå†åŠ ä¹‹é•¿æœŸåœ¨å®¶çš„å‹æŠ‘ï¼Œæœ‰å‡ ä¸ªæœˆçœŸçš„ä¸å¤ªå¿«ä¹ï¼Œåˆ‡èº«é¢†ä¼šäº†çœ‹ä¼¼æ™®é€šçš„æ—¥å­å…¶å®éš¾èƒ½å¯è´µè¿™ä¸ªé“ç†ã€‚å¥½åœ¨å¹¶ä¸ä¼šå±ˆæœäºç”Ÿæ´»å¸¦æ¥çš„è‹¦ç—›ï¼Œè€Œä¸”å¾ˆå¤šäº‹éƒ½ç¿»ç¯‡äº†ï¼Œåˆå¼€å§‹å¯¹æ–°çš„ä¸€å¹´æœ‰äº†æœŸå¾…ï¼ˆç¬‘</p><p>ä¸è¿‡å¹¶éä¸€åˆ‡éƒ½é‚£ä¹ˆç³Ÿç³•ï¼Œ2020 ä¹Ÿæœ‰å‡ ä»¶å€¼å¾—æµ“å¢¨é‡å½©è®°ä¸‹ä¸€ç¬”çš„äº‹æƒ…ï¼š</p><ul><li>æ˜¥èŠ‚å›äº†è¶Ÿå®¶ï¼Œå› ä¸ºç–«æƒ…å“ªä¹Ÿæ²¡å»ï¼Œå¦¥å¦¥çš„åœ¨å®¶é™ªäº†å®¶äººä¸¤æ˜ŸæœŸï¼Œæ­¤åˆ»æƒ³æ¥ç”šæ˜¯éš¾å¾—ã€‚</li><li>å¨è‰ºæœ‰äº†è¿›æ­¥ï¼Œå°¤å…¶æ˜¯æ™´åŒå­¦ï¼Œå¦‚ä»ŠåšæŸå‡ å“ä¸­åæ–™ç†çš„æ°´å¹³å¯ä»¥è¯´æ˜¯æƒŠä¸ºå¤©äººã€‚</li><li>åœ¨é€‚åº”äº†æ–°çš„ç”Ÿæ´»/å·¥ä½œèŠ‚å¥ä¹‹åï¼ŒWFH çš„ä½“éªŒå˜å¾—è¶³å¤Ÿä»¤äººæ„‰æ‚¦ï¼Œå†åŠ ä¸Šå…äºé€šå‹¤ï¼Œæœ‰äº†æ›´å¤šæ‚ é—²ï¼ˆåšé¥­ï¼Œæ´—ç¢—ï¼‰çš„æ—¶é—´ã€‚</li><li>å‘Šåˆ«èˆ’é€‚åœˆï¼Œ10 æœˆç¦»å¼€äº†å¥‹æ–—ä¸¤å¹´çš„å›¢é˜Ÿï¼Œå¤šäºé‡åˆ°äº†ä¸€ç¾¤å¾ˆæ£’çš„åŒäº‹ï¼Œè¿‡å»ä¸¤å¹´ç«Ÿç„¶çœŸçš„è§‰å¾—å·¥ä½œå¼€å¿ƒã€‚åœ¨æ–°çš„å›¢é˜Ÿå¾—åˆ°äº†æ›´å¥½çš„ WLBï¼Œä¸‹ä¸€ä¸ªé˜¶æ®µå¸Œæœ›è‡ªå·±èƒ½æ›´æœ‰å‹‡æ°”ä¸€äº›ã€‚</li><li>èµ¶åœ¨ä¸œäº¬ç–«æƒ…çˆ†å‘å‰è·Ÿæˆ–è®¸å¤šå¹´éƒ½ä¸å†è§å¾—åˆ°çš„æœ‹å‹å»äº†ä¸€è¶Ÿè½»äº•æ³½ï¼Œæ‰“äº†é›ªä»—ï¼Œåƒå­©ç«¥æ—¶æœŸä¸€æ ·å¼€å¿ƒï¼ˆå°½ç®¡å­©ç«¥æ—¶æœŸè§è¿‡çš„é›ªä¸€åªæ‰‹éƒ½æ•°å¾—è¿‡æ¥ï¼‰ã€‚</li><li>å­¦äº†å‡ ä¸ªæœˆéŸ©è¯­ï¼Œå£è¯­ç¨ç¨è®°ä½äº†ä¸€äº›ï¼Œå´å†™ä¸å‡ºå‡ ä¸ªå¯¹çš„å•è¯ï¼Œæˆ‘å¯èƒ½æ˜¯ä¸ªæ–‡ç›²äº†ï¼Œæœ‰æ„§äºä¸€ç›´è·Ÿæˆ‘è¯´ Good Job çš„è€å¸ˆã€‚</li><li>åŠ¨æ£®ç§°å¾—ä¸Š 2020 å¯¹æˆ‘å½±å“æœ€å¤§çš„æ¸¸æˆï¼Œå’Œæœ‹å‹ä»¬åœ¨æ— æ•°ä¸ªä¸çœ çš„å¤œæ™šä¸€èµ·é’“é±¼ç æ ‘ï¼Œè¿˜æœ‰å°åŠ¨ç‰©ä»¬çš„é™ªä¼´ï¼Œåœ¨å‡ºä¸äº†é—¨çš„æ—¥å­é‡Œæ„Ÿå—è¿™ç§ç”±è™šæ‹Ÿå‘çœŸå®è½¬æ¢çš„æ¸©æš–ã€‚</li></ul><h2>2021</h2><p>å‰ä¸¤å¤©çœ‹åˆ°ä¸€ä¸ªè±†ç“£è¯é¢˜ï¼šä½ æœ€å¹³é™æ”¾æ¾çš„æ—¶åˆ»ã€‚æˆ‘æƒ³è¿™ä¸€åˆ»å¤§æ¦‚å°±æ˜¯å§ï¼Œå¯ä»¥å¹³é™ä¸”å¦ç™½çš„æ€è€ƒè‡ªå·±å¯¹æœªæ¥çš„æœŸè®¸ï¼Œç®€è¨€ä¹‹ï¼š</p><ul><li>ä¿æŒå¥åº·è‰¯å¥½çš„å¿ƒæƒ…ï¼Œæ—©ç¡</li><li>å¤šè·Ÿäº²å‹è”ç»œï¼Œå¤šäº¤æœ‹å‹</li><li>æŠ•å…¥æ—¶é—´åšä¸ªäººäº§å“</li><li>æŠ•èµ„æœªæ¥ï¼Œä¿æŒå­¦ä¹ </li><li>ç‚¹äº®æ–°æŠ€èƒ½æ ‘ï¼ˆä¸ŠåŠå¹´å°±æ˜¯éŸ©è¯­äº†å§ï¼‰</li><li>æ€è€ƒä¹‹ä½™ï¼Œè¡¨è¾¾å’Œè®°å½•è‡ªå·±çš„æƒ³æ³•</li><li>æ¢é©¾ç…§</li><li>ä¿æŒå¯¹èµ°è¡—ä¸²å··ï¼Œæ‘„å½±ï¼Œæ–™ç†çš„çƒ­æƒ…</li></ul><p>å®³æ€•ç€å†™å¤ªå¤šå®ç°ä¸äº†æ˜å¹´è‡ªå·±çœ‹ç€å°´å°¬ï¼Œå´è¿˜æ˜¯å†™äº†é‚£ä¹ˆå¤šğŸ˜‚</p><p>Anywayï¼Œå¸Œæœ›æ¯ä¸ªäººéƒ½èƒ½æœ‰å¾—å¿æ‰€æ„¿çš„ä¸€å¹´ã€‚</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-2</guid><title>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2</title><description>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚åœ¨ Part.2 ä¸­å°†ä¼šé’ˆå¯¹æ›´ä¼˜é›…åœ°ä½¿ç”¨ `NSAttributedString` å†å‘å‰è¿ˆè¿›ä¸€æ­¥ã€‚</description><link>ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-2</link><pubDate>Sat, 27 Jun 2020 22:59:00 +0900</pubDate><content:encoded><![CDATA[<h1>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2</h1><p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”±å¾ˆå¤šå±æ€§ä¸åŒçš„éƒ¨åˆ†æ„æˆçš„å®Œæ•´å­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯æƒ³è¦å®ç°å›¾æ–‡æ··æ’ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä¸å¯é¿å…çš„éœ€è¦å°†æ‰€æœ‰éƒ¨åˆ†ç»„è£…åœ¨ä¸€èµ·ï¼Œæœ€åŸºç¡€çš„æ–¹æ³•æ˜¯åˆ›å»º <code>NSMutableAttributedString</code> ï¼Œç„¶åé€šè¿‡ <code>append(_:)</code> æ–¹æ³•æ¥å®Œæˆå­—ç¬¦ä¸²çš„æ„å»ºã€‚ç®€å•æ˜“æ‡‚æ˜¯å®ƒçš„æœ‰ç‚¹ï¼Œç„¶è€Œä¸çŸ¥ä¸è§‰ä¸­å¯èƒ½å°±ä¼šå†™å‡ºç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p><pre><code><span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: str1)
mutableAttributedString.<span class="call">append</span>(str2)
mutableAttributedString.<span class="call">append</span>(str3)
mutableAttributedString.<span class="call">append</span>(str4)
...
</code></pre><p>è¿™æ®µä»£ç å¤šå°‘æœ‰ä¸€äº›ç¹é‡æ„Ÿï¼Œä¹Ÿä¸å¤Ÿç›´è§‚ï¼Œæœ‰å¾ˆå¤§çš„ä¼˜åŒ–ä½™åœ°ã€‚æ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œä¹Ÿè®¸ä¸€åƒä¸ªå¼€å‘è€…å°±æœ‰ä¸€åƒç§æ”¹å–„çš„æ€è·¯ï¼Œæ¥ä¸‹æ¥æƒ³è¦è®¨è®ºä¸¤ç§æ›´ä¼˜é›…çš„æ–¹æ¡ˆï¼Œåˆ†åˆ«å€ŸåŠ›äºæšä¸¾ (Enum) å’Œ å­—ç¬¦ä¸²æ’å€¼ (StringInterpolation)ã€‚</p><h2>æšä¸¾</h2><p>å’Œå‰æ–‡ç±»ä¼¼ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å†æ¬¡å®šä¹‰ä¸€ä¸ªæšä¸¾æ¥ä¼˜åŒ–ä»£ç çš„å¯è¯»æ€§ã€‚æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œå®šä¹‰ä¸€äº›å¸¸ç”¨çš„ caseï¼Œåªå®šä¹‰å­—ç¬¦ä¸²å®åœ¨æ˜¯æœ‰ä¸€äº›å­¤ç‹¬ï¼Œæˆ‘ä»¬å¯ä»¥å†è¿½åŠ ä¸€ä¸ªç”¨äºæ’å›¾çš„ caseï¼š</p><pre><code><span class="keyword">enum</span> AttributedString {
    <span class="keyword">case</span> string(<span class="type">String</span>, [<span class="type">StringAttribute</span>]?)
    <span class="keyword">case</span> image(<span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span> = <span class="number">0.0</span>, offsetY: <span class="type">CGFloat</span> = <span class="number">0.0</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>)
    
    <span class="keyword">static func</span> assemble(<span class="keyword">_</span> attrStrings: [<span class="type">AttributedString</span>]) -&gt; <span class="type">NSAttributedString</span> {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(string: <span class="string">""</span>)
        attrStrings.<span class="call">forEach</span> { (attrString: <span class="type">AttributedString</span>) <span class="keyword">in
            switch</span> attrString {
            <span class="keyword">case</span> .<span class="dotAccess">string</span>(<span class="keyword">let</span> string, <span class="keyword">let</span> attributes):
                mutableAttributedString.<span class="call">append</span>(.<span class="keyword">init</span>(string: string, attributes: attributes?.<span class="property">attributesDictionary</span>))
            <span class="keyword">case</span> .<span class="dotAccess">image</span>(<span class="keyword">let</span> image, <span class="keyword">let</span> offsetX, <span class="keyword">let</span> offsetY, <span class="keyword">let</span> scale):
                mutableAttributedString.<span class="call">append</span>(.<span class="keyword">init</span>(image: image, offsetX: offsetX, offsetY: offsetY, scale: scale))
            }
        }
        <span class="keyword">return</span> mutableAttributedString
    }
}

<span class="keyword">extension</span> <span class="type">NSAttributedString</span> {
    <span class="keyword">convenience init</span>(image: <span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span>, offsetY: <span class="type">CGFloat</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>) {
        <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()
        
        <span class="keyword">let</span> size: <span class="type">CGSize</span> = {
            <span class="keyword">guard</span> scale != <span class="number">1.0</span> <span class="keyword">else</span> { <span class="keyword">return</span> image.<span class="property">size</span> }
            <span class="keyword">return</span> image.<span class="property">size</span>.<span class="call">applying</span>(<span class="type">CGAffineTransform</span>(scaleX: scale, y: scale))
        }()
        
        attachment.<span class="property">bounds</span> = .<span class="keyword">init</span>(origin: .<span class="keyword">init</span>(x: offsetX, y: offsetY), size: size)
        attachment.<span class="property">image</span> = image
        
        <span class="keyword">self</span>.<span class="keyword">init</span>(attachment: attachment)
    }
}
</code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œå³ç®€å•æ˜äº†ï¼Œè¿˜å¯ä»¥é¿å…å¾ˆå¤šæ™¦æ¶©ä¸”é‡å¤çš„ä»£ç ã€‚</p><pre><code>xxxxxx.<span class="property">attributedText</span> = <span class="type">AttributedString</span>.<span class="call">assemble</span>([
    .<span class="call">image</span>(<span class="type">UIImage</span>(named: <span class="string">"stop"</span>) ?? <span class="type">UIImage</span>(), offsetX: <span class="number">0.0</span>, offsetY: -<span class="number">8.0</span>, scale: <span class="number">0.5</span>),
    .<span class="call">string</span>(<span class="string">"è¸Ÿè¹°ä¸å¦‚"</span>, [ .<span class="call">foregroundColor</span>(.<span class="dotAccess">gray</span>) ]),
    .<span class="call">string</span>(<span class="string">"åœæ­¢æŠ±æ­‰"</span>, [ .<span class="call">foregroundColor</span>(.<span class="dotAccess">orange</span>) ])
])
</code></pre><h2>å­—ç¬¦ä¸²æ’å€¼ (StringInterpolation)</h2><p>ç›¸è¾ƒäºæšä¸¾ï¼Œå€ŸåŠ©å­—ç¬¦ä¸²æ’å€¼çš„æ–¹æ³•ä¸ä¼šé‚£ä¹ˆç›´è§‚ã€‚è¿™æ˜¯ä¸€ä¸ª Swift 5 çš„æ–°ç‰¹æ€§ï¼Œåˆè§ä¹‹æ—¶æˆ‘å…¶å®å¹¶æ²¡æœ‰å½»åº•æ„Ÿå—åˆ°å­—ç¬¦ä¸²æ’å€¼çš„å¼ºå¤§ï¼Œç§ä»¥ä¸ºåªæ˜¯èƒ½å¤Ÿå°†ä¸€äº›å­—ç¬¦ä¸²çš„å…±é€šå¤„ç†å†™çš„æ›´ä¼˜é›…ï¼Œå°½ç®¡è¿™ä¹Ÿè¶³ä»¥ä»¤äººæ¬£å–œã€‚ç›´åˆ°å¾ˆä¹…ä¹‹åè¯»äº† <a href="https://nshipster.com/expressiblebystringinterpolation/">ExpressibleByStringInterpolation</a>ï¼Œæ‰çœŸæ˜¯ç†è§£äº†ä¸€äº›å­—ç¬¦ä¸²æ’å€¼ä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä¾¿åˆ©ã€‚æ–‡ä¸­å…³äºå­—ç¬¦ä¸²æ’å€¼åˆçº§ä½¿ç”¨æ‰€ä¸¾çš„ä¾‹å­ååˆ†å·§å¦™ï¼Œå¾ˆä¼˜é›…çš„é¿å¼€äº† <code>DateFormatter</code> æ ¼å¼å®šä¹‰çš„å‘ã€‚ä½†å­—ç¬¦ä¸²æ’å€¼çš„èƒ½åŠ›æ›´å¤šä½“ç°åœ¨è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼ç±»å‹ä¸­ã€‚</p><p>ç”±äºæˆ‘ä»¬æœŸå¾…çš„æ’å€¼ç±»å‹æ˜¯å±æ€§å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»å®šä¹‰ç»“æ„ä½“å¼€å§‹ç€æ‰‹ï¼Œé¦–å…ˆä¸ºè¯¥ç»“æ„ä½“å®šä¹‰ä¸€ä¸ª <code>NSAttributedString</code> ç±»å‹çš„å±æ€§ï¼š</p><pre><code><span class="keyword">struct</span> AttributedString {
    <span class="keyword">var</span> attributedString: <span class="type">NSAttributedString</span>
}
</code></pre><p>æ­¤æ—¶éœ€è¦äº†è§£ä¸¤ä¸ªåè®®ï¼š<code>ExpressibleByStringLiteral</code> å’Œ <code>ExpressibleByStringInterpolation</code>ï¼Œåè€…ç»§æ‰¿äºå‰è€…ï¼ŒäºŒè€…åˆ†åˆ«æœ‰ä¸€ä¸ªå¿…é¡»å®ç°çš„åˆå§‹åŒ–æ–¹æ³•ï¼š</p><pre><code><span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringLiteral</span> {
    <span class="keyword">init</span>(stringLiteral: <span class="type">String</span>) {
        <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSAttributedString</span>(string: stringLiteral)
    }
}

<span class="comment">// ExpressibleByStringInterpolation inherits from ExpressibleByStringLiteral</span>
<span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringInterpolation</span> {
    <span class="keyword">init</span>(stringInterpolation: <span class="type">StringInterpolation</span>) {
        <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSAttributedString</span>(attributedString: stringInterpolation.<span class="property">attributedString</span>)
    }
}
</code></pre><p>å­—é¢é‡éƒ¨åˆ†åªéœ€è¦åˆå§‹åŒ–æ–¹æ³•å³å¯ï¼Œæ’å€¼çš„æƒ…å†µä¸‹è‡ªç„¶ä¼šå¤æ‚ä¸€äº›ï¼Œä»åˆå§‹åŒ–æ–¹æ³•æ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªå…³è”ç±»å‹å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚<code>StringInterpolation</code> æ‰çœŸæ­£åœ¨è´Ÿè´£åœ¨å¤„ç†æ’å€¼ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯å°†å„ä¸ªç»„æˆéƒ¨åˆ†é€šè¿‡ä¸€ç³»åˆ— append æ–¹æ³•ç»„è£…èµ·æ¥ï¼Œå†ä½œä¸ºå‚æ•°ä¼ ç»™ä¸Šé¢çš„åˆå§‹åŒ–æ–¹æ³• <code>init(stringInterpolation:)</code>ã€‚<code>appendLiteral(_:)</code> çš„èŒè´£æ˜¯å¤„ç†æ™®é€šçš„å­—ç¬¦ä¸²å­—é¢é‡ï¼Œåä¸º <code>appendInterpolation</code> çš„æ–¹æ³•ä»¬åˆ™æ˜¯æ‰¿æ‹…äº†å¤„ç†ç±»å‹äº”èŠ±å…«é—¨çš„æ’å€¼çš„ä»»åŠ¡ã€‚</p><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå°±åˆ†åˆ«ä¸ºå­—ç¬¦ä¸²åŠå…¶å±æ€§ï¼Œå›¾ç‰‡å®šä¹‰äº†ä¸åŒçš„ <code>appendInterpolation</code> æ–¹æ³•ï¼š</p><pre><code><span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringInterpolation</span> {
    <span class="comment">// Custom String Interpolation Type</span>
    <span class="keyword">struct</span> StringInterpolation: <span class="type">StringInterpolationProtocol</span> {
        <span class="keyword">var</span> attributedString: <span class="type">NSMutableAttributedString</span>
        
        <span class="keyword">init</span>(literalCapacity: <span class="type">Int</span>, interpolationCount: <span class="type">Int</span>) {
            <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSMutableAttributedString</span>()
        }

        <span class="keyword">mutating func</span> appendLiteral(<span class="keyword">_</span> literal: <span class="type">String</span>) {
            <span class="keyword">let</span> attrString = <span class="type">NSAttributedString</span>(string: literal)
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(attrString)
        }
        
        <span class="keyword">mutating func</span> appendInterpolation(<span class="keyword">_</span> string: <span class="type">String</span>, stringAttributes: [<span class="type">StringAttribute</span>]) {
            <span class="keyword">let</span> attrString = <span class="type">NSAttributedString</span>(string: string,
                                                stringAttributes: stringAttributes)
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(attrString)
        }
        
        <span class="comment">// for UIImage</span>
        <span class="keyword">mutating func</span> appendInterpolation(image: <span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span>, offsetY: <span class="type">CGFloat</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>) {
            <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()
            
            <span class="keyword">let</span> size: <span class="type">CGSize</span> = {
                <span class="keyword">guard</span> scale != <span class="number">1.0</span> <span class="keyword">else</span> { <span class="keyword">return</span> image.<span class="property">size</span> }
                <span class="keyword">return</span> image.<span class="property">size</span>.<span class="call">applying</span>(<span class="type">CGAffineTransform</span>(scaleX: scale, y: scale))
            }()
            
            attachment.<span class="property">bounds</span> = .<span class="keyword">init</span>(origin: .<span class="keyword">init</span>(x: offsetX, y: offsetY), size: size)
            attachment.<span class="property">image</span> = image
        
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(<span class="type">NSAttributedString</span>(attachment: attachment))
        }
    }
}
</code></pre><p>å…³äº <code>appendLiteral(_:)</code> æ–¹æ³•ï¼Œæœ‰ä¸€ç‚¹ä¸å¾—ä¸è¯´ï¼Œå¦‚æœæƒ³è¦åœ¨å…¶ä¸­åšé™¤äº† append ä¹‹å¤–çš„äº‹ï¼ŒåŠ¡å¿…è¦ä¸‡åˆ†å°å¿ƒï¼Œé™¤äº†æ˜¾ç„¶å¯è§çš„å­—é¢é‡ä¹‹å¤–ï¼Œç©ºæ ¼ï¼Œæ¢è¡Œï¼Œç”šè‡³æ˜¯å­—ç¬¦ä¸²å‰åçš„ä¸å¯è§éƒ¨åˆ†éƒ½ä¼šå—åˆ°å…¶å½±å“ã€‚</p><p>ä¸¥æ ¼æ„ä¹‰ä¸Šæˆ‘ä»¬å·²ç»å®Œæˆäº†ç”¨å­—ç¬¦ä¸²æ’å€¼çš„æ–¹æ³•æ¥ç»„è£…å±æ€§å­—ç¬¦ä¸²ï¼Œå®åœ¨æ˜¯æœ‰äº›ä»¤äººæ¿€åŠ¨ï¼ä¸å¦‚è¶çƒ­æ‰“é“ï¼Œé¡ºæ‰‹æ·»åŠ ä¸¤ä¸ªä¾¿åˆ©æ–¹æ³•ï¼Œä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿå†æå‡ä¸€ç‚¹ç‚¹çµæ´»åº¦ã€‚</p><pre><code><span class="keyword">struct</span> AttributedString {
    <span class="keyword">var</span> attributedString: <span class="type">NSAttributedString</span>
    
    <span class="keyword">mutating func</span> append(<span class="keyword">_</span> newStr: <span class="type">AttributedString</span>) {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: attributedString)
        mutableAttributedString.<span class="call">append</span>(newStr.<span class="property">attributedString</span>)
        <span class="keyword">self</span>.<span class="property">attributedString</span> = mutableAttributedString
    }
    
    <span class="keyword">mutating func</span> append(contentsOf newStrs: [<span class="type">AttributedString</span>]) {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: attributedString)
        newStrs.<span class="call">forEach</span> { str <span class="keyword">in</span>
            mutableAttributedString.<span class="call">append</span>(str.<span class="property">attributedString</span>)
        }
        <span class="keyword">self</span>.<span class="property">attributedString</span> = mutableAttributedString
    }
}
</code></pre><p>åˆ°è¿™é‡Œï¼Œç»„è£…å±æ€§å­—ç¬¦ä¸²çš„è¿‡ç¨‹å˜å¾—ä¼˜é›…ä¸”çµæ´»äº†ä¸€äº›ã€‚</p><pre><code><span class="keyword">var</span> attrString1: <span class="type">AttributedString</span> = <span class="string">"""</span>
\(<span class="string">"è¸Ÿè¹°ä¸å¦‚", stringAttributes: [ .foregroundColor(.systemGray), .font(.systemFont(ofSize: 14.0)) ])</span>
\(<span class="string">"åœæ­¢æŠ±æ­‰", stringAttributes: [ .foregroundColor(.systemGray2), .font(.systemFont(ofSize: 14.0)) ])
"""</span>

<span class="keyword">let</span> attrString2: <span class="type">AttributedString</span> = <span class="string">"""</span>
\(image<span class="string">: UIImage(named: "stop") ?? UIImage(), offsetX: 0.0, offsetY: 0.0, scale: 0.5)</span>
\(<span class="string">"å†è¿‡ç§‹å¤©", stringAttributes: [ .foregroundColor(.systemGray3), .font(.systemFont(ofSize: 14.0)) ])</span>
\(<span class="string">"çƒ‚äº†èœ¿èœ’", stringAttributes: [ .foregroundColor(.systemGray4), .font(.systemFont(ofSize: 14.0)) ])
"""</span>

attrString1.<span class="call">append</span>(attrString2)

xxxxxlabel.<span class="property">attributedText</span> = attrString1.<span class="property">attributedString</span>
</code></pre><h2>å°¾å£°</h2><p>æˆ‘æƒ³å¾ˆå¤šäººå¯¹å±æ€§å­—ç¬¦ä¸²çš„æ„Ÿæƒ…åº”è¯¥æ˜¯çˆ±æ¨äº¤ç»‡çš„ï¼Œå¸Œæœ›è¿™ä¸¤ç¯‡æ–‡ç« èƒ½ä¸ºå®ƒæ‹‰å›å‡ å¼ çš„ç¥¨...ğŸ˜‚</p><blockquote><p>Source Code: https://github.com/Ckitakishi/PlayWithAttributedString</p></blockquote>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-1</guid><title>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.1</title><description>Swift æ‹¥æœ‰å¯é€‰ç±»å‹ä¸”ç±»å‹å®‰å…¨ï¼Œè¿™äº›ç‰¹æ€§å¸®åŠ©å¼€å‘è€…é¿å…äº†å¾ˆå¤šéº»çƒ¦é—®é¢˜ã€‚ç„¶è€Œå³ä¾¿å¦‚æ­¤ï¼Œåœ¨ `NSAttributedString` çš„è¿ç”¨ä¸­åŒæ ·å­˜åœ¨ç€çš„æ½œåœ¨ä¸å®‰å…¨å› ç´ ï¼Œåœ¨ Part.1 ä¸­å°†ä¼šå›´ç»•å¦‚ä½•æ›´å®‰å…¨åœ°ä½¿ç”¨ `NSAttributedString` å±•å¼€è®¨è®ºã€‚</description><link>ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-1</link><pubDate>Sat, 6 Jun 2020 14:28:00 +0900</pubDate><content:encoded><![CDATA[<h1>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.1</h1><p>Swift æ‹¥æœ‰å¯é€‰ç±»å‹ä¸”ç±»å‹å®‰å…¨ï¼Œè¿™äº›ç‰¹æ€§å¸®åŠ©å¼€å‘è€…é¿å…äº†å¾ˆå¤šéº»çƒ¦é—®é¢˜ã€‚</p><p>ç„¶è€Œå½“æ¶‰åŠåˆ°å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¿˜æ˜¯æˆ–å¤šæˆ–å°‘å­˜åœ¨ä¸€äº›ç‘•ç–µã€‚ä¾‹å¦‚å¼•ç”¨èµ„æºæ–‡ä»¶ï¼Œå›¾ç‰‡æ–‡å­—ç­‰ï¼Œä¸€æ—¦æ‹¼å†™é”™è¯¯ï¼Œæ˜¯æ²¡æœ‰åŠæ³•åœ¨ç¼–è¯‘ä¹‹å‰çŸ¥é“çš„ï¼Œåˆæˆ–è€…æ˜¯ç»§ç»­åœ¨ä»£ç ä¸­å¼•ç”¨å·²ç»è¢«åˆ é™¤çš„èµ„æºï¼Œä¹Ÿä¸å®¹æ˜“è¢«å¯Ÿè§‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€äº›çŸ¥åçš„åº“åº”è¿è€Œç”Ÿï¼Œåƒæ˜¯ <a href="https://github.com/mac-cain13/R.swift">R.swift</a>, <a href="https://github.com/SwiftGen/SwiftGen">SwiftGen</a> ä¹‹ç±»ã€‚è§£å†³æ–¹æ¡ˆçš„å…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒæ˜¯ä½¿å¾—èµ„æºå¼•ç”¨è¿™ä¸ªè¿‡ç¨‹å˜å¾—ç±»å‹å®‰å…¨ï¼Œä»¥æ­¤æ¥å…‹æœæ½œåœ¨çš„ä¸æ˜äº†æ€§ï¼Œä¾‹å¦‚ï¼š</p><pre><code><span class="comment">// normal</span>
<span class="keyword">let</span> icon = <span class="type">UIImage</span>(named: <span class="string">"settings-icon"</span>)

<span class="comment">// R.swift</span>
<span class="keyword">let</span> icon = <span class="type">R</span>.<span class="property">image</span>.<span class="call">settingsIcon</span>()
</code></pre><p>ä¸è¿‡è¿™æ¬¡æƒ³è®¨è®ºçš„å¹¶ä¸æ˜¯ä¸Šè¿°é—®é¢˜ï¼Œè€Œæ˜¯åœ¨ <code>NSAttributedString</code> çš„è¿ç”¨ä¸­åŒæ ·å­˜åœ¨ç€çš„æ½œåœ¨ä¸å®‰å…¨å› ç´ ã€‚ä»æˆ‘çš„æ—¥å¸¸ä½“éªŒæ¥è¯´ï¼Œ<code>NSAttributedString</code> åœ¨æ— æ•°æƒ…å¢ƒä¹‹ä¸‹éƒ½ä¼šè¢«æˆ‘ä»¬æƒ³èµ·ï¼Œæ— è®ºæ˜¯å¯Œæ–‡æœ¬æ”¯æŒè¿˜æ˜¯å›¾æ–‡æ··æ’ï¼Œåˆæˆ–è€…æ˜¯æƒ³å®ç°ä¸€ä¸ª markdown ç»„ä»¶ç­‰ç­‰ã€‚</p><p>è™½ç„¶æˆ‘è®¤ä¸ºä» Objective-C åˆ° Swiftï¼Œåœ¨å®‰å…¨é—®é¢˜ä¸Šå·²ç»æ˜¯è¿ˆè¿›äº†ä¸€å¤§æ­¥ã€‚ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼Œä»¥å¾€å†™ Objective-C çš„æ—¶å€™ï¼Œä¼šæ³¨æ„é¿å…ä¸€ä¸ªé¢„æœŸå¤–çš„ <code>nil</code> è¢«ä½œä¸º <code>str</code> å‚æ•°ä¼ å…¥ï¼Œè€Œå¼•èµ·ä¸å¿…è¦çš„å´©æºƒã€‚</p><pre><code>- (instancetype)initWithString:(<span class="type">NSString</span> *)str
</code></pre><p>å¯¹äº Swift è€Œè¨€ï¼Œäº‹æƒ…ä¼šå˜å¾—ç®€å•å¾ˆå¤šï¼Œå¯é€‰å€¼çš„å£°æ˜è®©æˆ‘ä»¬æ›´å®¹æ˜“åšå‡ºæ­£ç¡®çš„åˆ¤æ–­ã€‚</p><pre><code><span class="keyword">init</span>(string str: <span class="type">String</span>)
</code></pre><p>å³ä¾¿å¦‚æ­¤ï¼Œå…³äºæ½œåœ¨çš„ä¸å®‰å…¨å› ç´ ä¾ç„¶æœ‰å¾ˆå¤šè¯å¯ä»¥è¯´ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªæå…¶ç®€å•çš„ä¾‹å­ï¼š</p><pre><code><span class="keyword">let</span> paragraphStyle = <span class="type">NSMutableParagraphStyle</span>()
paragraphStyle.<span class="property">lineSpacing</span> = <span class="number">1.0</span>
paragraphStyle.<span class="property">lineBreakMode</span> = .<span class="dotAccess">byTruncatingTail</span>
paragraphStyle.<span class="property">alignment</span> = .<span class="dotAccess">center</span>

xxxxxx.<span class="property">attributedText</span> = <span class="type">NSAttributedString</span>(
    string: <span class="string">"å®è¨€æ˜¥å¤© ç ´ç¢ç§‹åƒ"</span>,
    attributes: [
        .<span class="dotAccess">font</span>: <span class="type">UIFont</span>.<span class="call">systemFont</span>(ofSize: <span class="number">12.0</span>, weight: .<span class="dotAccess">regular</span>),
        .<span class="dotAccess">foregroundColor</span>: <span class="type">UIColor</span>.<span class="property">gray</span>,
        .<span class="dotAccess">paragraphStyle</span>: paragraphStyle
])
</code></pre><p>çœ‹å®Œè¿™æ®µä»£ç ï¼Œå¿ƒä¸­åº”è¯¥ä¼šå¾ˆå®¹æ˜“æµ®ç°å‡ ä¸ªç›´å‡»çµé­‚çš„é—®é¢˜ï¼š</p><ol><li>ä¸ºä»€ä¹ˆä¸º <code>foregroundColor</code> è®¾ç½®å€¼çš„æ—¶å€™ä¸èƒ½å¤Ÿçœç•¥ <code>UIColor</code>ï¼Ÿ</li><li>å¦‚æœä¼ å…¥çš„ä¸æ˜¯ <code>UIColor</code> ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å—ï¼Ÿ</li><li><code>paragraphStyle</code> çš„åˆå§‹åŒ–å’Œèµ‹å€¼æ˜¯ä¸æ˜¯å¯ä»¥å†™çš„æ›´ <code>swifty</code>ï¼Ÿ</li></ol><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œçœ‹å€¼ç±»å‹å„å¼å„æ ·äº”èŠ±å…«é—¨å°±ä¼šçŸ¥é“è¿™å¤§æ¦‚æ˜¯ <code>Any</code>ï¼Œå¦‚æœå°† <code>attributes</code> çš„åˆå§‹åŒ–åˆ†ç¦»å‡ºæ¥ï¼Œè¿™ä¸ªåŸå› ä¼šæ›´åŠ ä¸€ç›®äº†ç„¶ã€‚</p><pre><code><span class="keyword">let</span> attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [
    .<span class="dotAccess">font</span>: <span class="type">UIFont</span>.<span class="call">systemFont</span>(ofSize: <span class="number">12.0</span>, weight: .<span class="dotAccess">regular</span>),
    .<span class="dotAccess">foregroundColor</span>: <span class="type">UIColor</span>.<span class="property">gray</span>,
    .<span class="dotAccess">paragraphStyle</span>: paragraphStyle
]
</code></pre><p>ç¬¬äºŒä¸ªé—®é¢˜å®Œå…¨æ˜¯ç¬¬ä¸€é—®çš„å‰¯ä½œç”¨ã€‚å¯¹äºä¼šä¸ä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Œç­”æ¡ˆæ˜¯ä¼šã€‚æ›¾ç»ä¸€æ—¶å¤±ç¥ï¼Œä¸º <code>paragraphStyle</code> ä¼ å…¥äº†ä¸€ä¸ª <code>CGColor</code> çš„å€¼ï¼Œæœ€å¯æ€•çš„åœ¨äºä¸­æ–‡å’Œæ—¥è¯­éƒ½å¯ä»¥é¡ºåˆ©å‘ˆç°å‡ºæ‰€æœŸå¾…çš„é¢œè‰²ï¼Œä½†åˆ‡æ¢æˆè‹±è¯­ååº”ç”¨ç›´æ¥å°±å´©æºƒäº†ã€‚è‹¥é­é‡è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æƒ³ä¸ºäº†æ¢å¯»åŸå› ä¹Ÿè¿˜æ˜¯éœ€è¦èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´çš„ã€‚</p><p>ä¸ºäº†æ¶ˆè§£è¿™ä¸å®‰å…¨æ„Ÿï¼Œä¼°è®¡å¤§å®¶éƒ½ä¼šæƒ³è¦åšç‚¹ä»€ä¹ˆã€‚è¦ä¹ˆæ˜¯ä¸º <code>attributes</code> å†™ä¸€æ®µç±»å‹æ£€æŸ¥çš„ä»£ç é€šè¿‡è¾“å‡º log æ¥é¿å…æ„å¤–ï¼Œæˆ–è€…æ˜¯å°è£… <code>NSAttributedString</code> ä»¥å®ç°ç±»å‹å®‰å…¨ã€‚æ–¹æ¡ˆä¸€ç•¥æ˜¾å•è–„ï¼Œä½†ä¸Šè¿°æœ€è‡´å‘½çš„é—®é¢˜äºŒæ˜¯å¯ä»¥è¢«åœ†æ»¡è§£å†³çš„ï¼Œå”¯ä¸€çš„ç¼ºæ†¾æ˜¯åœ¨ç¼–è¯‘åæ‰èƒ½çŸ¥é“ç»“æœã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œä¸å¦‚å°±æ¥å®ç°æ–¹æ¡ˆäºŒã€‚</p><p>æ¯”è¾ƒç›´æ¥çš„æƒ³æ³•åº”è¯¥æ˜¯é¿å… <code>Any</code> çš„å­˜åœ¨ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¸å¦¨ç´¢æ€§æŠ›å¼ƒå­—å…¸ï¼Œä½¿å„ä¸ªå±æ€§æˆä¸ºä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„å­˜åœ¨ï¼Œå¯ä»¥é€‰æ‹©åˆ›å»ºä¸€äº›å‡½æ•°ç„¶åé“¾å¼è°ƒç”¨ï¼Œä½†æ›´å®¹æ˜“æµ®ç°åœ¨è„‘æµ·ä¸­çš„åº”è¯¥æ˜¯ç”¨æšä¸¾å»åšè¿™ä»¶äº‹ï¼š</p><pre><code><span class="keyword">enum</span> StringAttribute {
    <span class="keyword">case</span> font(<span class="type">UIFont</span>)
    <span class="keyword">case</span> foregroundColor(<span class="type">UIColor</span>)
    <span class="keyword">case</span> underlineColor(<span class="type">UIColor</span>?) <span class="comment">// The default value is nil</span>
    <span class="keyword">case</span> kern(<span class="type">CGFloat</span>)
    <span class="comment">// ...</span>
}
</code></pre><p>åœ¨å®šä¹‰äº†ä¸Šè¿°æšä¸¾ä¹‹åï¼ŒåŸºæœ¬ä¸Šç±»å‹ä¸å®‰å…¨çš„é—®é¢˜å°±å¾—åˆ°äº†è§£å†³ã€‚ä¸è¿‡ä½œä¸ºæ¢å–ç±»å‹å®‰å…¨çš„ä»£ä»·ï¼Œéœ€è¦å¤šä¸€é“å·¥åºæŠŠ <code>StringAttribute</code> è½¬å› <code>[NSAttributedString.Key: Any]</code>ï¼š</p><pre><code><span class="keyword">extension</span> <span class="type">NSAttributedString</span> {
    <span class="keyword">convenience init</span>(string str: <span class="type">String</span>, stringAttributes attrs: [<span class="type">StringAttribute</span>]) {
        <span class="keyword">self</span>.<span class="keyword">init</span>(string: str, attributes: attrs.<span class="property">attributesDictionary</span>)
    }
}

<span class="keyword">enum</span> StringAttribute {
    <span class="keyword">case</span> font(<span class="type">UIFont</span>)
    <span class="keyword">case</span> foregroundColor(<span class="type">UIColor</span>)
    <span class="keyword">case</span> underlineColor(<span class="type">UIColor</span>?) <span class="comment">// The default value is nil</span>
    <span class="keyword">case</span> kern(<span class="type">CGFloat</span>)
    <span class="comment">// ...</span>
    
    <span class="keyword">var</span> keyAndValue: (<span class="type">NSAttributedString</span>.<span class="type">Key</span>, <span class="type">Any</span>?) {
        <span class="keyword">switch self</span> {
        <span class="keyword">case</span> .<span class="dotAccess">font</span>(<span class="keyword">let</span> value):
            <span class="keyword">return</span> (.<span class="dotAccess">font</span>, value)
        <span class="keyword">case</span> .<span class="dotAccess">foregroundColor</span>(<span class="keyword">let</span> value):
            <span class="keyword">return</span> (.<span class="dotAccess">foregroundColor</span>, value)
        <span class="keyword">case</span> .<span class="dotAccess">underlineColor</span>(<span class="keyword">let</span> optionalValue):
            <span class="keyword">return</span> (.<span class="dotAccess">underlineColor</span>, optionalValue)
        <span class="keyword">case</span> .<span class="dotAccess">kern</span>(<span class="keyword">let</span> value):
            <span class="keyword">return</span> (.<span class="dotAccess">kern</span>, value <span class="keyword">as</span> <span class="type">NSNumber</span>)
        }
        <span class="comment">// ...</span>
    }
}

<span class="keyword">extension</span> <span class="type">Array</span> <span class="keyword">where</span> <span class="type">Element</span> == <span class="type">StringAttribute</span> {
    <span class="comment">// StringAttribute =&gt; [NSAttributedString.Key: Any]</span>
    <span class="keyword">var</span> attributesDictionary: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] {
        <span class="keyword">var</span> attributesDict: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [:]
        
        <span class="keyword">self</span>.<span class="call">forEach</span> { attribute <span class="keyword">in
            let</span> (key, value) = attribute.<span class="property">keyAndValue</span>
            attributesDict[key] = value
        }
        
        <span class="keyword">return</span> attributesDict
    }
}
</code></pre><p>åˆ°è¿™é‡Œå°±å¤§åŠŸå‘Šæˆäº†ï¼æˆ‘ä»¬å¯ä»¥å°è¯•æŠŠä¸Šé¢çš„ä»£ç æ”¹å†™ä¸€ä¸‹ï¼š</p><pre><code><span class="keyword">let</span> attributes: [<span class="type">StringAttribute</span>] = [
    .<span class="call">font</span>(.<span class="call">systemFont</span>(ofSize: <span class="number">12.0</span>, weight: .<span class="dotAccess">regular</span>)),
    .<span class="call">foregroundColor</span>(.<span class="dotAccess">gray</span>),
    .<span class="call">paragraphStyle</span>(paragraphStyle)
]
</code></pre><p>å¦‚æœå®Œæ•´å®ç°äº† <code>StringAttribute</code> çš„è¯ï¼Œä¸€å®šä¼šç•™æ„åˆ° <code>NSAttributedString</code> ä¸­æœ‰ä¸€ä¸ªç›¸å¯¹ç‰¹æ®Šçš„å±æ€§ï¼š<code>.paragraphStyle</code>ã€‚ä½¿ç”¨å®ƒä¹‹å‰éœ€è¦å…ˆå®Œæˆä¸€ç³»åˆ—çš„åˆå§‹åŒ–èµ‹å€¼ï¼Œæ­£æ˜¯ä¸Šé¢ä»£ç å—ä¸­å‡ºç°çš„ <code>paragraphStyle</code>ã€‚ä½œä¸ºä¸€ä¸ªä»£ç é£æ ¼ä¼˜åŒ–çš„å¯é€‰é¡¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ç”¨ä¸ <code>StringAttribute</code> ç›¸ä¼¼çš„æ‰‹æ®µæ¥å°è£… <code>NSMutableParagraphStyle</code>ã€‚</p><pre><code><span class="keyword">enum</span> ParagraphAttribute {
    <span class="keyword">case</span> alignment(<span class="type">NSTextAlignment</span>)
    <span class="keyword">case</span> lineSpacing(<span class="type">CGFloat</span>)
    <span class="keyword">case</span> lineBreakMode(<span class="type">NSLineBreakMode</span>)
}

<span class="keyword">enum</span> StringAttribute {
    <span class="keyword">case</span> paragraphStyle([<span class="type">ParagraphAttribute</span>])
    
    <span class="keyword">var</span> keyAndValue: (<span class="type">NSAttributedString</span>.<span class="type">Key</span>, <span class="type">Any</span>?) {
        <span class="keyword">switch self</span> {
        <span class="keyword">case</span> .<span class="dotAccess">paragraphStyle</span>(<span class="keyword">let</span> value):
            <span class="keyword">return</span> (.<span class="dotAccess">paragraphStyle</span>, <span class="keyword">self</span>.<span class="call">configureParagraphStyle</span>(value))
        }
    }
    
    <span class="comment">// [ParagraphAttribute] =&gt; NSMutableParagraphStyle</span>
    <span class="keyword">private func</span> configureParagraphStyle(<span class="keyword">_</span> attributes: [<span class="type">ParagraphAttribute</span>]) -&gt; <span class="type">NSMutableParagraphStyle</span> {
        
        <span class="keyword">let</span> paragraphStyle = <span class="type">NSMutableParagraphStyle</span>()

        attributes.<span class="call">forEach</span> {
            <span class="keyword">switch</span> $0 {
            <span class="keyword">case</span> .<span class="dotAccess">alignment</span>(<span class="keyword">let</span> value):
                paragraphStyle.<span class="property">alignment</span> = value
            <span class="keyword">case</span> .<span class="dotAccess">lineSpacing</span>(<span class="keyword">let</span> value):
                paragraphStyle.<span class="property">lineSpacing</span> = value
            <span class="keyword">case</span> .<span class="dotAccess">lineBreakMode</span>(<span class="keyword">let</span> value):
                paragraphStyle.<span class="property">lineBreakMode</span> = value
            }
        }
        
        <span class="keyword">return</span> paragraphStyle
    }
}
</code></pre><p>äºæ˜¯ï¼Œæœ€åˆçš„ä»£ç å°±å¯ä»¥ç”¨ä¸€ç§æ›´ <code>Swifty</code> çš„æ–¹å¼æ¥é‡å†™äº†ã€‚ ä»£ç é£æ ¼å„æœ‰æ‰€çˆ±ï¼Œå°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå®‰å…¨ä¸ä¼˜é›…çš„ä»£ç ç€å®ä»¤äººæ„ŸåŠ¨ï¼šP</p><pre><code>xxxxxx.<span class="property">attributedText</span> = <span class="type">NSAttributedString</span>(
    string: <span class="string">"å®è¨€æ˜¥å¤© ç ´ç¢ç§‹åƒ"</span>,
    stringAttributes: [
        .<span class="call">font</span>(.<span class="call">systemFont</span>(ofSize: <span class="number">12.0</span>, weight: .<span class="dotAccess">regular</span>)),
        .<span class="call">foregroundColor</span>(.<span class="dotAccess">gray</span>),
	      .<span class="call">paragraphStyle</span>([
	          .<span class="call">lineSpacing</span>(<span class="number">1.0</span>),
	          .<span class="call">lineBreakMode</span>(.<span class="dotAccess">byTruncatingTail</span>),
	          .<span class="call">alignment</span>(.<span class="dotAccess">center</span>)
	      ])

])
</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†ä¸€ä¸ªç±»å‹å®‰å…¨çš„ <code>NSAttributedString</code> åˆå§‹åŒ–æ–¹æ³•ã€‚ä¸è¿‡æ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œä¼´éšç€ <code>SwiftUI</code> çš„è¯ç”Ÿï¼ŒSwift 5.1 ä¸­æ–°å¢åŠ äº† <code>Function Builder</code>ï¼Œç”¨å®ƒæ¥è¾¾æˆæˆ‘ä»¬æœ€åˆçš„ç›®æ ‡ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªå¥½æ–¹æ³•ã€‚è¯»ä¸€è¯»è¿™ç¯‡ <a href="https://medium.com/@carson.katri/create-your-first-function-builder-in-5-minutes-b4a717390671">Create Your First Function Builder in 10 Minutes</a> åº”è¯¥ä¼šæœ‰ä¸å°‘å¯å‘ã€‚</p><h2>TBC</h2><p>(ä¸‹ä¸€ç¯‡è®¡åˆ’è®²ä¸€è®²åœ¨å…¶å®ƒä¸€äº›åœºæ™¯ä¸­ï¼Œå¦‚ä½•æ›´ä¼˜é›…åœ°ä½¿ç”¨ <code>NSAttributedString</code>)</p><blockquote><p>Source Code: https://github.com/Ckitakishi/PlayWithAttributedString</p></blockquote>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/Memory-warning-%E5%A4%A7%E9%9A%90%E9%9A%90%E4%BA%8E%E5%B8%82</guid><title>Memory warning: å¤§éšéšäºå¸‚</title><description>å¯¹ memory warning (å†…å­˜è­¦å‘Š) çš„å¤„ç†æ˜¯ä¸€ä¸ªåœ¨å¼€å‘ä¸­æå…¶å®¹æ˜“è¢«å¿½ç•¥çš„é—®é¢˜ï¼Œç©¶å…¶åŸå› ï¼Œæœ€é‡è¦è«è¿‡äº warning å¹¶ä¸é‚£ä¹ˆå®¹æ˜“å‘ç”Ÿï¼Œå¼€å‘ä¸­å°¤å…¶å¦‚æ­¤ã€‚å³ä½¿å‘ç”Ÿäº†ï¼Œåœ¨æˆ‘ä»¬åˆ†æå´©æºƒæ—¥å¿—çš„æ—¶å€™ï¼Œä¹Ÿæœªå¿…èƒ½å¤Ÿæ˜å¯Ÿä¸ä¹‹æ˜¯å¦æœ‰å…³ï¼Œå†è¿›ä¸€æ­¥è¯´ï¼Œå°±ç®—çŸ¥é“äº†åæœ‰å…«ä¹æ˜¯ memory warning å¯¼è‡´äº†å´©æºƒï¼Œæœ‰æ—¶å€™è¦å‡†ç¡®å®šä½æ ¹æºä»éœ€è€—è´¹ä¸€ç•ªåŠŸå¤«ã€‚</description><link>ckitakishi.com/posts/Memory-warning-%E5%A4%A7%E9%9A%90%E9%9A%90%E4%BA%8E%E5%B8%82</link><pubDate>Sat, 23 Feb 2019 12:32:00 +0900</pubDate><content:encoded><![CDATA[<h1>Memory warning: å¤§éšéšäºå¸‚</h1><p>å¯¹ memory warning (å†…å­˜è­¦å‘Š) çš„å¤„ç†æ˜¯ä¸€ä¸ªåœ¨å¼€å‘ä¸­æå…¶å®¹æ˜“è¢«å¿½ç•¥çš„é—®é¢˜ï¼Œç©¶å…¶åŸå› ï¼Œæœ€é‡è¦è«è¿‡äº warning å¹¶ä¸é‚£ä¹ˆå®¹æ˜“å‘ç”Ÿ<s>ï¼Œå¼€å‘ä¸­å°¤å…¶å¦‚æ­¤</s>ã€‚å³ä½¿å‘ç”Ÿäº†ï¼Œåœ¨æˆ‘ä»¬åˆ†æå´©æºƒæ—¥å¿—çš„æ—¶å€™ï¼Œä¹Ÿæœªå¿…èƒ½å¤Ÿæ˜å¯Ÿä¸ä¹‹æ˜¯å¦æœ‰å…³ï¼Œå†è¿›ä¸€æ­¥è¯´ï¼Œå°±ç®—çŸ¥é“äº†åæœ‰å…«ä¹æ˜¯ memory warning å¯¼è‡´äº†å´©æºƒï¼Œæœ‰æ—¶å€™è¦å‡†ç¡®å®šä½æ ¹æºä»éœ€è€—è´¹ä¸€ç•ªåŠŸå¤«ã€‚</p><h2>å¸¸è§åŸå› </h2><p>ç”±å†…å­˜åŸå› å¯¼è‡´çš„å´©æºƒç±»å‹å¤šä¸èƒœæ•°ï¼Œä¸è¿‡åœ¨è¿™é‡Œåªæ‰“ç®—è®¨è®ºå†…å­˜ä¸è¶³å¯¼è‡´åº”ç”¨è¢«å¼ºåˆ¶ç»ˆç»“è¿™ä¸€ç§ã€‚æ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸‹è¿°å‡ ç§ï¼š</p><ul><li>è‡ªç„¶æ¶ˆè€—ï¼Œå¤„ç†åª’ä½“èµ„æºå°¤å…¶å®¹æ˜“æ¶ˆè€—å†…å­˜ã€‚<ul><li>æœªå¤„ç† memory warning</li><li>å¯¹ memory warning çš„å¤„ç†ä¸æ­£ç¡®</li><li>memory leak (å†…å­˜æ³„æ¼)ï¼Œç¡®åˆ‡æ¥è¯´ memory leak ä¸æ˜¯ç›´æ¥åŸå› ï¼Œè€Œæ˜¯ä¸€ä¸ªåŠ é€Ÿå™¨ã€‚</li></ul></li></ul><h2>å®ä¾‹</h2><p>ä¹‹æ‰€ä»¥è®¤è¯†åˆ°è¿™ä¸ªé—®é¢˜çš„é‡è¦æ€§ï¼Œæ˜¯å› ä¸ºæœ€è¿‘åœ¨çœ‹å´©æºƒæ—¥å¿—çš„æ—¶å€™ï¼Œå‘ç°æœ‰å¾ˆå¤šä¸ªåŸå› è¿‘ä¼¼ï¼Œä½†å‘ç”Ÿåœºæ‰€ä¸å¤ªç›¸åŒçš„å´©æºƒï¼Œä¸è¿‡æ€»ä½“æ¥è¯´å‘ç”Ÿç‡åªæœ‰ 0.0X%ã€‚å› ä¸ºå¤¹æ‚ç€ä¸€äº› RxSwift çš„ä»£ç ï¼ŒçœŸæ­£å‘ç”Ÿå´©æºƒçš„ä½ç½®å˜å¾—å¾ˆéš¾åˆ¤æ–­ï¼ŒçœŸå®åŸå› æ›´æ˜¯æ‰‘æœ”è¿·ç¦»ã€‚æ‰€è°“å®¶å®¶æœ‰æœ¬éš¾å¿µçš„ç»ï¼Œç›¸ä¼¼çš„ï¼ŒçŸ­çŸ­ä»£ç éƒ½æœ‰è¯´ä¸å°½çš„æ•…äº‹ï¼Œæ‰€ä»¥å°±äº‹è®ºäº‹ï¼Œæ¥è¯´è¯´åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><!--more-->

é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå°è£…äº† `UICollectionView` çš„ `UIViewController`ï¼Œä¹Ÿå°±æ˜¯ `BaseCollectionViewController`ï¼Œåœ¨å…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªå¯ä»¥â€œä¿è¯â€ä¸æ˜¯ `nil` ä¸”ä¸ä¸º `weak` çš„ `collectionVIew`ï¼š

```Swift
// BaseCollectionViewController.swift
fileprivate(set) var collectionView: UICollectionView!
// ...
override func didReceiveMemoryWarning() {
    if isViewLoaded && view.window == nil && collectionView.isDescendant(of: view) {
        collectionView.removeFromSuperview()
        collectionView.delegate = nil
        collectionView.dataSource = nil
        collectionView = nil
    }
    super.didReceiveMemoryWarning()
}

override func loadView() {
    super.loadView()
    // init collectionView in code
}
```

æ­¤å¤–ï¼Œè¿˜æ‹¥æœ‰ä¸€ä¸ªç»§æ‰¿è‡ª BaseCollectionViewController çš„ XXViewControllerï¼š

```Swift
// XXViewController
class XXViewController: BaseCollectionViewController {
    override func didReceiveMemoryWarning() {
        if isViewLoaded && view.window == nil {
            // ...
        }
        super.didReceiveMemoryWarning()
    }

    private func reloadData() {
        // fetch data from server then reload collection view
        // ...
        collectionView.reloadData()
    }
}
```

å®é™…çš„è¿ç”¨æƒ…æ™¯æ˜¯ï¼Œåœ¨ `XXViewController`` ä¸­å­˜åœ¨ pop ä¸€ä¸ªæ–° ViewController çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒXXViewController` éœ€è¦é‡æ–°è·å–æ•°æ®æ¥åˆ·æ–°é¡µé¢å¹¶æ›´æ–° collectionView çš„ `contentOffset`ã€‚æŒ‰é“ç†æ¥è¯´ï¼Œåˆ·æ–°æ•°æ®åœ¨ä¸‹ä¸€æ¬¡ view will appear çš„æ—¶å€™è¿›è¡Œä¼šæ›´ä¿é™©ï¼Œä½†æ˜¯ç”±äºè¢«å¼ºçƒˆè¦æ±‚è°ƒæ•´ `contentOffset` è¿™ä¸ªè¿‡ç¨‹ä¸å¯è§ï¼Œæ‰€ä»¥â€¦è¿™æ ·ä¸€æ¥ï¼Œbug å°±â€œåº”è¿è€Œç”Ÿâ€äº†ã€‚

å½“æ–° ViewController ä½äºæœ€é¡¶ç«¯çš„æ—¶å€™ï¼ŒXXViewController å°±ä¸å†è¢« window æ‰€æŒæœ‰ã€‚ç”±äºå®ƒç»§æ‰¿è‡ª BaseCollectionViewControllerï¼Œ`didReceiveMemoryWarning` å‘ç”Ÿæ—¶ collectionView ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­è¢«ç½®ä¸º nilï¼Œå¦‚æœè¿™ä¸€åˆ‡å‘ç”Ÿåœ¨ collectionView.reloadData() ä¹‹å‰ï¼Œé‚£å™©æ¢¦å°±è¯ç”Ÿäº†ã€‚

è¿™ä¸ªæ—¶å€™ï¼Œæˆ–è®¸ä¼šåæ€ controller view ä¹‹é—´çš„ç»§æ‰¿å…³ç³»åˆ°åº•åˆç†ä¹ˆï¼Œè°ƒæ•´ `contentOffset` ä¸å¯è§åˆ°åº•åˆç†ä¹ˆï¼Œ`collectionView = nil` åˆ°åº•æœ‰æ²¡æœ‰æ„ä¹‰ã€‚æˆ‘è®¤ä¸ºè¿™äº›éƒ½æ˜¯åˆç†çš„ç€æ‰‹ç‚¹ï¼Œå¯¹äºè¿™ç±»é—®é¢˜ï¼Œæ‰¾åˆ°åŸå› å…¶å®å°±å·²ç»è§£å†³äº† 80% äº†ã€‚

## å®è·µ

æœªé›¨ç»¸ç¼ªè¿™å¥è¯åœ¨è¿™é‡Œéå¸¸é€‚ç”¨ï¼Œæå‰å»æ€è€ƒä¸€äº›é—®é¢˜æœ‰åŠ©äºæˆ‘ä»¬è§„é¿ memory warning å¸¦æ¥çš„éº»çƒ¦ï¼š

-  å½“æ¥æ”¶åˆ° memery warning æ—¶æˆ‘ä»¬è¯¥åšä»€ä¹ˆï¼Ÿ
- view controller  ä¸è¢« window æŒæœ‰çš„æ—¶å€™éœ€è¦åšä»€ä¹ˆï¼Ÿ
- å½“ä¸€ä¸ª view controller è¢«æ¢å¤çš„æ—¶å€™ï¼Œ`loadView`, `viewDidLoad` ä¼šé»˜è®¤è¢«è°ƒç”¨ï¼Œä½†æ˜¯è‡ªå®šä¹‰çš„ `init` æ–¹æ³•ä»¬å°±ä¸ä¸€å®šäº†ï¼Œè¿™æ ·ä»èƒ½é¡ºåˆ©å®Œæˆåˆå§‹åŒ–å—ï¼Ÿ
- æ˜¯å¦å­˜åœ¨æ˜¾è‘—çš„å†…å­˜æ³„æ¼ï¼Ÿ

å½“è¿™äº›é—®é¢˜éƒ½æ¢³ç†æ¸…æ¥šçš„æ—¶å€™ï¼Œä¹Ÿå°±å¤§å¤§å‡å°‘äº†åé¡¾ä¹‹å¿§ã€‚

é™¤äº†ä¸Šé¢æåˆ°è¿‡çš„ `didReceiveMemoryWarning`ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•ï¼š `applicationDidReceiveMemoryWarning`ï¼Œåè€…æ˜¯ App delegate çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå¯ä»¥ç”¨æ¥ç®¡ç†ä¸€äº›å…¨å±€å¯¹è±¡ï¼Œæˆ–æ˜¯ç¼“å­˜ä¹‹ç±»çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨å¿…è¦çš„æ—¶å€™ç›‘å¬åä¸º `UIApplicationDidReceiveMemoryWarningNotification` çš„é€šçŸ¥æ¥åšä¸€äº›ç‰¹æ®Šçš„å¤„ç†ã€‚

## è§¦å‘ memory warning

é‚£ä¹ˆï¼Œå½“å‡†å¤‡å°±ç»ªçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è§¦å‘ memory warning æ¥è¿›è¡Œæµ‹è¯•äº†ã€‚

1. æ¨¡æ‹Ÿå™¨ --> Debug --> Simulate Memory Warning (`Shift + Command + M`): æ¨¡æ‹Ÿå™¨è°ƒè¯•é€‰é¡¹ï¼Œç»“åˆæ–­ç‚¹æ¨¡æ‹Ÿ warning
2. `UIApplication.shared.perform(Selector(("_performMemoryWarning")))`: åœ¨ä»£ç ä¸­æŒ‡å®šä½ç½®è§¦å‘ warning

## æœ€å

å†…å­˜ç®¡ç†ç€å®ä¸æ˜¯ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œä¸Šè¿°å†…å®¹ä¸è¿‡æµ®äºæµ…è¡¨ã€‚å¦‚æœæƒ³è¦ç¨å¾®å†å¤šäº†è§£ä¸€ç‚¹ï¼Œæ¨èçœ‹ä¸€çœ‹ WWDC 2018 çš„ [Session 416](https://developer.apple.com/videos/play/wwdc2018/416/) ï¼Œæœ‰å¾ˆå¤šå†…å®¹åˆ·æ–°äº†æˆ‘çš„æ—¢å­˜è®¤çŸ¥...

]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%85%B3%E4%BA%8E-MetaX-%E7%9A%84%E4%B8%89%E8%A8%80%E4%B8%A4%E8%AF%AD</guid><title>å…³äº MetaX çš„ä¸‰è¨€ä¸¤è¯­</title><description>å¸¸å¸¸æŠŠç›¸æœºä¸­çš„ç…§ç‰‡ä¼ åˆ°æ‰‹æœºé‡Œï¼Œä½†æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ä¸€ç‚¹æ˜¯æ²¡æœ‰åœ°ç†ä¿¡æ¯ï¼Œæ‰€ä»¥å°±è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†ã€‚ ä½œä¸ºä¸€ä¸ªæ€»ç»“ï¼Œä¸‹æ–‡çš„ä¸»é¢˜æ˜¯ç…§ç‰‡æ¡†æ¶ PhotoKit å’Œç®€å•çš„é—®é¢˜è§£å†³è®°å½•ã€‚</description><link>ckitakishi.com/posts/%E5%85%B3%E4%BA%8E-MetaX-%E7%9A%84%E4%B8%89%E8%A8%80%E4%B8%A4%E8%AF%AD</link><pubDate>Sun, 29 Apr 2018 20:47:00 +0900</pubDate><content:encoded><![CDATA[<blockquote><p><strong>Support:</strong> If you have any question or comment for MetaX, please do not hesitateÂ toÂ contactÂ me via the ways on theÂ bottom left of this page.</p></blockquote><p>Source: <a href="https://github.com/Ckitakishi/MetaX">MetaX on Github</a></p><h1>å…³äº MetaX çš„ä¸‰è¨€ä¸¤è¯­</h1><h2>åˆè¡·</h2><p>å¸¸å¸¸æŠŠç›¸æœºä¸­çš„ç…§ç‰‡ä¼ åˆ°æ‰‹æœºé‡Œï¼Œä½†æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ä¸€ç‚¹æ˜¯æ²¡æœ‰åœ°ç†ä¿¡æ¯ï¼Œæ‰€ä»¥å°±è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†ã€‚ ä½œä¸ºä¸€ä¸ªæ€»ç»“ï¼Œä¸‹æ–‡çš„ä¸»é¢˜æ˜¯ç…§ç‰‡æ¡†æ¶ PhotoKit å’Œç®€å•çš„é—®é¢˜è§£å†³è®°å½•ã€‚</p><h2>å…³äºç…§ç‰‡æ¡†æ¶ - PhotoKit</h2><p>åœ¨ <strong>PhotoKit</strong> ä¹‹å‰ï¼ŒAssetsLibraryÂ æ˜¯è¢«å¹¿æ³›ä½¿ç”¨çš„ï¼Œç”±äºå¹¶æ²¡æœ‰å®é™…ç”¨è¿‡ï¼Œå°±ä¸å†èµ˜è¿°ã€‚ä» <strong>PhotoKit</strong> çš„æ–‡æ¡£å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªååˆ†åºå¤§çš„æ¡†æ¶ï¼ŒåŒ…å«äº†ç›¸å½“å¤šçš„ç±»ã€‚<strong>PhotoKit</strong> å¯ä»¥ä½¿å¾—è‡ªå·±çš„åº”ç”¨ä¸ç…§ç‰‡åº“ä»¥ç›¸åŒæµç¨‹å·¥ä½œï¼Œæ­¤å¤–æ€§èƒ½ä¹Ÿç›¸å½“ä¸é”™ã€‚</p><h3>ä»è·å–å›¾åƒå¼€å§‹</h3><h4>ç›¸å†Œå–å¾—</h4><p>å¦‚æœä»¥ä»ç›¸å†Œåˆ—è¡¨é€‰å–ç…§ç‰‡è¿™ä¸ªæµç¨‹ä¸ºä¾‹æ¥çœ‹ï¼Œç›¸å†Œåˆ—è¡¨ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ <code>PHCollection</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡çˆ¶ç±»ï¼Œæ‹¥æœ‰ä¸¤ä¸ªå­ç±»ï¼šÂ <code>PHAssetCollection</code>Â å’ŒÂ <code>PHCollectionList</code>ï¼Œå‰è€…è¡¨ç¤ºç›¸å†Œï¼Œåè€…è¡¨ç¤ºç›¸å†Œåˆ—è¡¨ä¹Ÿå°±æ˜¯æ–‡ä»¶å¤¹ã€‚é¢˜å¤–è¯ï¼Œåœ¨ iOS è®¾å¤‡ä¸Šåˆ›å»ºæ–‡ä»¶å¤¹å‡ ä¹å¯ä»¥è¯´æ˜¯ä¸€ä¸ªéšè—åŠŸèƒ½ï¼Œç‚¹å‡»è¿½åŠ æŒ‰é’®æ˜¯ç›¸å†Œï¼Œè€Œé•¿æŒ‰åˆ™å¯ä»¥é€‰æ‹©ç›¸å†Œæˆ–æ–‡ä»¶å¤¹ã€‚è€Œè·å–ç›¸å†Œçš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸Šè¿°å‡ ä¸ªç±»ä¸­çš„ fetch æ–¹æ³•ï¼Œè¿”å› <code>PHFetchResult&lt;XXX&gt;</code>ï¼Œå¯ä»¥ç”¨éƒ¨åˆ†ä¸ <code>Foundation</code> ä¸­é›†åˆç±»å‹ç›¸åŒçš„æ¥å£æ¥å¤„ç†è¿™ä¸ªç»“æœï¼Œæ¯”å¦‚ç”¨ <code>enumerateObjects(_:)</code> æ¥è¿›è¡Œéå†ã€‚è¯¥æ–¹æ³•é»˜è®¤ä¼šå–å›æ‰€æœ‰ç»“æœï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>PHFetchOptions</code> æ¥åšä¸€äº›è¿‡æ»¤æˆ–æ˜¯æ’åºå¤„ç†ã€‚ä¾‹å¦‚å–å›æ‰€æœ‰æ™ºèƒ½ç›¸å†Œï¼š</p><!--more-->

```swift
let options = PHFetchOptions()
options.sortDescriptors = [NSSortDescriptor(key: "creationDate", ascending: false)]
let smartAlbums: PHFetchResult<PHAssetCollection>?
smartAlbums = PHAssetCollection.fetchAssetCollections(with: .smartAlbum, subtype: .albumRegular, options: options)
```

æ™ºèƒ½ç›¸å†Œç”±ç³»ç»ŸæŒ‰ç…§å›¾åƒç±»å‹è‡ªåŠ¨ç”Ÿæˆï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå‡ºç°æ–‡ä»¶å¤¹ã€‚ç„¶è€Œï¼Œå¦‚æœä»¥ç³»ç»Ÿç…§ç‰‡åº“æ¥è¯´ï¼Œè¿˜æœ‰ä¸€ç±»ç›¸å†Œæ˜¯ç”¨æˆ·è‡ªå®šä¹‰ç›¸å†Œï¼Œå¤„ç†è¿™ç±»ç›¸å†Œçš„æ—¶å€™å¿…é¡»è¦æ³¨æ„åŒºåˆ†æ–‡ä»¶å¤¹ä¸ç›¸å†Œã€‚æˆ‘é€‰æ‹©çš„å¤„ç†æ–¹æ³•æ˜¯æš´åŠ›åœ°ç”¨ä¸€ä¸ªé€’å½’å°†æ–‡ä»¶å¤¹å®Œå…¨å¹³é“ºå±•å¼€ä½œä¸ºé¦–çº§ç›¸å†Œã€‚

å¦å¤–ï¼Œè®¿é—®å›¾ç‰‡åº“éœ€è¦è¯·æ±‚ç”¨æˆ·æƒé™ï¼Œåœ¨æƒé™æœªå†³å®šçš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ fetch æ–¹æ³•çš„æ—¶å€™ä¼šè‡ªåŠ¨è¯·æ±‚æƒé™ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ `PHPhotoLibrary` çš„ç±»æ–¹æ³• `requestAuthorization:` æ˜¾å¼åœ°å‘èµ·è¯·æ±‚ã€‚å¦‚æœè¢«æ‹’..ç»..äº†ï¼Œæ·»åŠ ä¸€ä¸ªç±»ä¼¼ 404 é¡µé¢çš„è§†å›¾å¹¶è®¾ç½®ä¸€ä¸ªæŒ‰é’®æŒ‡å‘åº”ç”¨çš„è®¾ç½®é¡µé¢æ˜¯ (æˆ‘è®¤ä¸º) æ¯”è¾ƒä¼˜é›…çš„åšæ³•ï¼š

```swift
let url = URL(string: UIApplicationOpenSettingsURLString)
UIApplication.shared.open(url!, options: [:], completionHandler: nil)
```

#### ç…§ç‰‡å–å¾— 

ç…§ç‰‡çš„å–å¾—æ˜¯ä¸€ä¸ªå±‚å±‚é€’è¿›çš„è¿‡ç¨‹ï¼Œåœ¨å–å¾—äº†ç›¸å†Œä¹‹åï¼Œä¾¿å¯ä»¥å°è¯•è·å– `PHAsset` å¯¹è±¡ï¼Œå°æ ‡é¢˜è¯´çš„æ¯”è¾ƒç‹­éš˜ä¸€äº›ï¼Œå®é™…ä¸Š `PHAsset` å¯¹è±¡åŒ…å«å›¾åƒï¼Œè§†é¢‘ï¼Œå’Œ Live Photoã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡è°ƒç”¨ `fetchAssets(in:options:)` æ¥å–å¾—ä¸€ä¸ªç±»å‹ä¸º `PHFetchResult<PHAsset>` çš„èµ„æºé›†ï¼š

```swift
let assetCollection = smartAlbums.object(at: 0)
let fetchResult = PHAsset.fetchAssets(in: assetCollection, options: options)
```

æ‰‹æ¡ `PHAsset`ï¼Œå‡ ä¹å°±æ‹¥æœ‰äº†ä¸€åˆ‡ã€‚æ­¤åˆ» `PHImageManager` è¯¥å‡ºåœºäº†ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºè¯·æ±‚ç‰¹å®š asset å¯¹åº”çš„åª’ä½“èµ„æºçš„ç±»ã€‚ä»¥è¯·æ±‚å›¾ç‰‡ä¸ºä¾‹ï¼Œå…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ `requestImage(for:targetSize:contentMode:options:resultHandler:)`ï¼Œé€šè¿‡å‚æ•°å°±ä¼šå‘ç°ï¼Œè¯·æ±‚çš„åŒæ—¶å°±å¯ä»¥ç¡®å®šå›¾ç‰‡çš„å°ºå¯¸ï¼Œå¹¶è¿›è¡Œè£å‰ªã€‚

æˆ‘ä»¬è¿˜èƒ½å¤Ÿä¸ºè¿™ä¸ªè¯·æ±‚è®¾å®šä¸€ä¸ªç±»å‹ä¸º `PHImageRequestOptions` çš„ optionï¼Œå€ŸåŠ©å®ƒçš„ `isSynchronous` å±æ€§å¯ä»¥å†³å®šä»¥åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„æ–¹å¼æ¥å‘èµ·è¯·æ±‚ï¼›è€Œ `deliverryMode` åˆ™æ˜¯è®©ä½ ä»¬èƒ½å¤Ÿåœ¨å›¾åƒçš„åŠ è½½æ—¶é—´å’Œè´¨é‡ä¸­åšä¸€ä¸ªæƒè¡¡æˆ–æŠ‰æ‹©ï¼Œ`.highQualityFormat` ä¸è®ºè€—æ—¶å¤šä¹…éƒ½ä¼šåŠ è½½åŸå°ºå¯¸å›¾ç‰‡ï¼Œ`.fastFormat` ä¼šèˆå¼ƒè´¨é‡æ¥å¿«é€ŸåŠ è½½å›¾åƒï¼Œ`.opportunistic` çº¦ç­‰äºå‰ä¸¤è€…çš„å’Œï¼Œå…ˆ `.fastFormat` å `.highQualityFormat`ï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿä¸¤æ¬¡è¯·æ±‚ï¼Œä½†æ˜¯ï¼Œå¦‚æœ `isSynchronous = true`ï¼Œé‚£ä¹ˆè¯·æ±‚ä¸€å®šæ˜¯ `.highQualityFormat`ï¼›è¿˜æœ‰ `isNetworkAccessAllowed`ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸ä» iCloud ä¸‹è½½å›¾ç‰‡ï¼Œå¦‚æœå…è®¸ï¼Œé‚£ `progressHandler` ä¹Ÿä¼šè¢«åŒæ—¶è°ƒç”¨ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†è¿›åº¦ä½“ç°åœ¨ UI ä¸Šã€‚

```swift
let options = PHImageRequestOptions()
options.deliveryMode = .opportunistic
// options.isSynchronous = true
options.isNetworkAccessAllowed = true
options.progressHandler = {(progress: Double, _, _, _) in
    DispatchQueue.main.async {
        ...
    }
}

imageRequestId = PHImageManager.default().requestImage(for: asset, targetSize: targetSize, contentMode: .aspectFit, options: options, resultHandler: { image, info in
    ...
})
```

åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šä¸€å¼ å›¾ç‰‡çš„å–å¾—å°±å®Œæˆäº†ã€‚ä¸è¿‡ï¼Œå¦‚æœç”±äºä¸€äº›åŸå› è¯·æ±‚å¤±è´¥æˆ–è€…ä¸å®Œæ•´å‘¢ï¼Ÿåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ`info` ä¾¿æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤šæ¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­ç»“æœçš„ä¿¡æ¯çš„å­—å…¸ã€‚`PHImageResultIsInCloudKey` å¯ä»¥çŸ¥é“å›¾åƒæ˜¯å¦éœ€è¦ä» iCloud ä¸‹è½½ï¼›`PHImageResultIsDegradedKey` æ„å‘³ç€å½“å‰çš„å›¾åƒæ˜¯å¦æ˜¯ä½è´¨é‡ç‰ˆæœ¬ï¼›ä»¥åŠ `PHImageErrorKey`ï¼Œé¡¾åæ€ä¹‰æ˜¯è¡¨ç¤ºäº†é”™è¯¯ä¿¡æ¯ï¼Œç­‰ç­‰ã€‚

#### ç¼“å­˜ 

æœ€åå€¼å¾—ä¸€æçš„æ˜¯å›¾ç‰‡å–å¾—çš„ç¼“å­˜æœºåˆ¶ã€‚

é€šå¸¸ï¼Œåœ¨è·å–ä¸€å¼ å…·ä½“çš„å›¾ç‰‡ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šå…ˆè·å–æ•´ä¸ªç›¸å†Œçš„æ‰€æœ‰å›¾ç‰‡åšæˆä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯”å¦‚ä¸€ä¸ªå¦‚åŒç³»ç»Ÿå›¾ç‰‡åº“çš„ collectionViewï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œæœ‰æ—¶å€™ä¼šéœ€è¦æå‰å°†å›¾ç‰‡è½½å…¥å†…å­˜ï¼Œè€Œ `PHImageManager` æœ‰ä¸€ä¸ªå­ç±» `PHImageCachingManager` æ­£å¥½å¯ä»¥ç”¨æ¥åšè¿™ä»¶äº‹ã€‚

`PHImageCachingManager` æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯å¼€å§‹ç¼“å­˜ï¼š`startCachingImages(for:targetSize:contentMode:options:)`ï¼Œå¦ä¸€ä¸ªæ˜¯åœæ­¢ç¼“å­˜ï¼Œ`stopCachingImages(for:targetSize:contentMode:options:)`ï¼Œå½»åº•åœæ­¢ç¼“å­˜æ—¶å€™å¯ä»¥ä½¿ç”¨ `stopCachingImagesForAllAssets()`ã€‚æ¥å—çš„å‚æ•°å’Œä¸Šé¢æåˆ°äº†è¯·æ±‚å›¾åƒå‡ ä¹ä¸€æ ·ä¸€æ ·ï¼Œè€Œäº‹å®ä¸Šåœ¨å–å¾—ç¼“å­˜ä¹‹åï¼Œå†æ¬¡ä½¿ç”¨ `requestImage` å–å¾—ç‹¬ç«‹å›¾åƒçš„æ—¶å€™ï¼Œå¦‚æœå‚æ•°ç›¸åŒï¼Œåˆ™ä¼šä»ç¼“å­˜ä¸­è·å–ã€‚

é‚£ç©¶ç«Ÿæ˜¯å°†æ‰€æœ‰å›¾åƒèµ„æºéƒ½æ”¾å…¥ç¼“å­˜ä»¥ä¾›ä¸æ—¶ä¹‹éœ€å‘¢ï¼Œè¿˜æ˜¯ä»…ä»…æ˜¯ç¼“å­˜ä¸€éƒ¨åˆ†å‘¢ï¼Ÿæ˜¯ä¸€å¼€å§‹å°±ç¼“å­˜æ‰€æœ‰èµ„æºå‘¢ï¼Œè¿˜æ˜¯ä¸€è¾¹æ»‘åŠ¨ä¸€è¾¹ç¼“å­˜å‘¢ï¼Ÿæ—¶æœºï¼ŒèŒƒå›´ç­‰ç­‰éƒ½æ˜¯éå¸¸é‡è¦è€Œå¿…é¡»è¦è€ƒè™‘çš„é—®é¢˜ã€‚æ¨èå‚è€ƒä¸€ä¸‹ Apple çš„ç¤ºä¾‹ä»£ç  --- [Using Photos Framework](https://developer.apple.com/library/content/samplecode/UsingPhotosFramework/Introduction/Intro.html)ï¼Œè™½ç„¶è¿™ä¸ªç¤ºä¾‹ bug æœ‰ç‚¹ç‚¹å¤šï¼Œä½†æ˜¯ç¼“å­˜éƒ¨åˆ†çš„è®¾è®¡è¿˜æ˜¯å¾ˆå¦™çš„ï½ä¹Ÿå› æ­¤å€Ÿé‰´äº†è¿™ä¸ªéƒ¨åˆ†çš„å®ç°ã€‚å®ƒçš„è®¾è®¡ç­–ç•¥åœ¨äºï¼Œè½½å…¥ç”»é¢åŠç”»é¢æ»šåŠ¨ä¸¤ä¸ªæ—¶æœºæ›´æ–°ç¼“å­˜ï¼Œè€ŒåŒºåŸŸåªåŒ…æ‹¬ä»¥å¯è§éƒ¨åˆ†ä¸ºä¸­å¿ƒï¼Œé«˜åº¦ä¸ºä¸¤å€çš„éƒ¨åˆ† (ä¾‹å¦‚ï¼šå¯è§èŒƒå›´ [0, 0, 768, 1024] å¯¹åº”ç¼“å­˜åŒºåŸŸï¼š[-512, 0, 768, 2048])ï¼Œéšç€ç”»é¢çš„æ»‘åŠ¨ï¼Œä¸åœè°ƒç”¨ `startCachingImages` ä¸ `stopCachingImages`ï¼Œè¯¥åŒºåŸŸä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼Œå°±åƒä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸€æ ·ã€‚

### ä¿®æ”¹å›¾åƒ

æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºï¼Œæœ‰å…³å›¾åƒçš„æ¡†æ¶ä¾æ¬¡æ˜¯ï¼š

 - UIKit
 - CoreImage
 - CoreGraphics
 - ImageIO

ä¸‹é¢æ‰“ç®—è®¨è®ºä¸¤ä¸ªç»´åº¦çš„å›¾ç‰‡ä¿®æ”¹ï¼Œæ»¤é•œå’Œ Metadataã€‚æ¥ç€ä¸Šä¸€éƒ¨åˆ†çš„æµç¨‹ç»§ç»­å¾€ä¸‹æ¥è¯´ï¼Œè™½ç„¶å®ç°æ»¤é•œå…¶å®åˆå¾ˆå¤šæ–¹æ³•ï¼Œä½†æ˜¯è‹¥é€‰æ‹© **Core Image**ï¼Œé‚£ä¹ˆä¸è®ºå“ªä¸€ç§ï¼Œéƒ½è¦å…ˆé€šè¿‡ PHAsset çš„å®ä¾‹æ–¹æ³• `requestContentEditingInput(with:completionHandler:)` æ¥è·å–å®Œæ•´å°ºå¯¸çš„ `CIImage` å›¾åƒï¼š

```swift
asset.requestContentEditingInput(with: options, completionHandler: { contentEditingInput, _ in
    guard let imageURL = contentEditingInput?.fullSizeImageURL else {
        // error
        return
    }
    
    let ciImageOfURL = CIImage(contentsOf: imageURL)
    guard let ciImage = ciImageOfURL else {
        ...
        return
    }
}
```

#### æ»¤é•œ

åœ¨é¡ºåˆ©å–å¾— `CIImage` ä¹‹åï¼Œæ·»åŠ æ»¤é•œçš„æµç¨‹å¤§è‡´å¦‚ä¸‹ã€‚**Core Image** æä¾›äº†ä¸€äº›æ»¤é•œï¼Œå¦‚æœéœ€è¦è‡ªå®šçš„è¯ï¼Œçœ‹ä¸€çœ‹ WWDC2014 Session 515 ä¼šéå¸¸æœ‰å¸®åŠ©ã€‚

```swift
// å¯¹è¿‡å»ç‰ˆæœ¬çš„ç®¡ç†
let adjustmentData = PHAdjustmentData...
                                                  
let contentEditingOutput = PHContentEditingOutput(contentEditingInput: contentEditingInput)
contentEditingOutput.adjustmentData = adjustmentData

let outputImage = ciImage
    .applyingOrientation(input.fullSizeImageOrientation)
    .applyingFilter(filter, withInputParameters: nil)
    
CIContext().writeJPEGRepresentation(of: outputImage,
                                    to: contentEditingOutput.renderedContentURL, 
                                    colorSpace: ciImage.colorSpace!,
                                    options: [:])

// ç¡®è®¤ä¿®æ”¹
PHPhotoLibrary.shared().performChanges({
    let request = PHAssetChangeRequest(for: self.asset)
    request.contentEditingOutput = contentEditingOutput
}, completionHandler: { success, error in
    ...
})
```

#### Metadata

æœ‰äº† `CIImage`ï¼Œè¯»å– Metadata åªéœ€è¦è·å– `CIImage` çš„ `properties` å±æ€§å³å¯ã€‚ä½†æ˜¯å¦‚æœè¦å†™å…¥ï¼Œå°±éœ€è¦åŸºäºç›¸å¯¹åº•å±‚çš„ `ImageIO` æ¡†æ¶æ¥å®Œæˆã€‚

é¦–å…ˆï¼Œæˆ‘åˆ›å»ºäº†ä¸´æ—¶å­˜å‚¨ï¼Œï¼Œè™½ç„¶æœ€åˆçš„æƒ³æ³•æ˜¯ç›´æ¥è¦†ç›–å½“å‰ç¼–è¾‘ä¸­çš„å›¾åƒï¼Œè¿™ä¸ªæ–¹æ¡ˆåœ¨æ¨¡æ‹Ÿå™¨ç«Ÿç„¶æˆåŠŸäº†ï¼Œä½†æ˜¯çœŸå®è®¾å¤‡è¡Œä¸é€šã€‚åæ¥è¿«ä¸å¾—å·²é€‰æ‹©äº†è¿‚å›çš„æ–¹æ³•ï¼Œè¦†ç›– => è¿½åŠ æ–°å›¾åƒ + (å¯é€‰)åˆ é™¤æ—§å›¾åƒã€‚

```swift
let context = CIContext(options:nil)

// åˆ›å»ºä¸€ä¸ªä¸´æ—¶å­˜å‚¨
var tmpUrl = NSURL.fileURL(withPath: NSTemporaryDirectory() + imageURL.lastPathComponent)
```

ä¸ºäº†è®©æ–°åˆ›å»ºçš„å›¾åƒä¿æŒä¸åŸå§‹å›¾åƒç›¸åŒçš„ç±»å‹ï¼Œé€šè¿‡ `CGImageSource` æ¥è·å–ã€‚å¦‚æœè·å–æˆåŠŸï¼Œå°±å¯ä»¥æŒ‡å®šä¸Šé¢çš„ä¸´æ—¶ URL ä½œä¸ºä½ç½®ï¼Œå°è¯•åˆ›å»º `CGImageDestination`ï¼Œä¹‹æ‰€ä»¥è¯´æ˜¯å°è¯•ï¼Œæ˜¯å› ä¸ºä¸å¾—ä¸è€ƒè™‘å¦‚æœå½“å‰è®¾å¤‡å¹¶ä¸æ”¯æŒæœŸå¾…åˆ›å»ºçš„ç±»å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šå¾—åˆ° `nil`ã€‚è¿™ä¸ªæ—¶å€™åˆ«æ— é€‰æ‹©ï¼Œåªèƒ½å¤Ÿå†è¯•ä¸€æ¬¡ï¼Œåœ¨å½“å‰ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªåšæ³•ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ **HEIF** æ ¼å¼åœ¨ä¸€äº›è¾ƒæœ‰å†å²çš„è®¾å¤‡ä¸Šå¹¶ä¸è¢«æ”¯æŒè€Œå¸¦æ¥çš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤å°†ç›®æ ‡ç±»å‹è®¾å®šä¸º **JPEG**ï¼š

```swift
// ä» CIImage åˆ›å»º CGImage
let cgImage = context.createCGImage(ciImage, from: ciImage.extent)
// æ ¹æ® CGImageSource æ¥è·å–å›¾ç‰‡ç±»å‹æ ‡è¯† (UTI)
let cgImageSource = CGImageSourceCreateWithURL(imageURL as CFURL, nil)
guard let sourceType = CGImageSourceGetType(cgImageSource!) else {
    ...
    return
}
// å°è¯•åˆ›å»º CGImageDestination
var createdDestination: CGImageDestination? = CGImageDestinationCreateWithURL(tmpUrl as CFURL, sourceType
    , 1, nil)

// è¯¥ç‰ˆæœ¬æš‚å®šæ–¹æ¡ˆï¼šæ— æ³•åˆ›å»ºçš„å›¾åƒæ ¼å¼å°±å­˜å‚¨ä¸º JPEG
if createdDestination == nil {
    // media type is unsupported: delete temp file, create new one with extension [.JPG].
    let _ = try? FileManager.default.removeItem(at: tmpUrl)
    tmpUrl = NSURL.fileURL(withPath: NSTemporaryDirectory() + imageURL.deletingPathExtension().lastPathComponent + ".JPG")
    createdDestination = CGImageDestinationCreateWithURL(tmpUrl as CFURL, "public.jpeg" as CFString
        , 1, nil)
}

guard let destination = createdDestination else {
    ...
    return
}
```

è‹¥å®Œæˆäº† `CGImageDestination` åˆ›å»ºï¼Œå°±å¯ä»¥å¼€å§‹å‘è¿™ä¸ªç›®æ ‡æ·»åŠ å›¾åƒäº†ã€‚åœ¨ä¸Šä¸€æ®µä»£ç ä¸­ï¼Œåˆ›å»ºæ—¶ä¼ å…¥çš„ç¬¬ 3 ä¸ªå‚æ•°æ­£æ˜¯ä»£è¡¨ç€å›¾åƒçš„æ•°é‡ï¼Œå› ä¸ºåªæ˜¯å•å¼ å›¾åƒï¼Œæ‰€ä»¥æ˜¯è‡ªç„¶æ˜¯ 1ï¼›è¯¥æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥åˆ›å»º GIFã€‚

```swift
// å‘ CGImageDestination æ·»åŠ å›¾åƒï¼Œä»¥åŠè¯¥å›¾åƒçš„ metadataã€‚
CGImageDestinationAddImage(destination, cgImage!, newProps as CFDictionary)
if !CGImageDestinationFinalize(destination) {
    ...
} else {
    ...
}
```

æœ€åï¼Œé€šè¿‡ä»åœ¨ä¸´æ—¶å­˜å‚¨ä½ç½®çš„å›¾åƒæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ asset è¿½åŠ è¯·æ±‚ï¼Œå¹¶å°†ä¸´æ—¶å­˜å‚¨çš„å›¾åƒç§»é™¤å³å¯ï¼š

```swift
PHPhotoLibrary.shared().performChanges({
    let request = PHAssetChangeRequest.creationRequestForAssetFromImage(atFileURL: tempURL)
    let _ = try? FileManager.default.removeItem(at: tempURL)
    ...
})
```

#### HEIF

**HEIF** æ˜¯å…¨æ–°çš„å›¾ç‰‡æ ¼å¼ï¼Œç›¸åº”çš„è¿˜æœ‰è§†é¢‘çš„ **HEVC**ã€‚è‹¹æœè¡¨ç¤ºåœ¨ç›¸åŒç”»è´¨ä¸‹å¤§å°èƒ½èŠ‚çº¦ 50% çš„å­˜å‚¨ç©ºé—´ã€‚å¦‚æœæƒ³è¦äº†è§£æ›´å¤šï¼Œæ¨èçœ‹ä¸€çœ‹ WWDC 2017 Session 511ã€‚

åœ¨å®é™…è¿ç”¨ä¸­é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘åœ¨ç›¸å¯¹è¾ƒæ—§çš„è®¾å¤‡ä¸ŠæŸ¥çœ‹ **.HEIC (HEIF)** çš„å›¾ç‰‡ï¼Œå¹¶å°è¯•å»ä¿®æ”¹å®ƒï¼Œä¸Šé¢æåˆ°çš„ `CGImageDestination` ä¼šå¾—åˆ°ä¸€ä¸ª `nil` å¯¹è±¡ã€‚ç»“æœå¹¶ä¸æ„å¤–ï¼Œæ¯•ç«Ÿè¿™éœ€è¦è½¯ä»¶ä¸ç¡¬ä»¶åŒæ–¹é¢çš„æ”¯æŒã€‚ä½†æ˜¯å…·ä½“æ¥è¯´ç©¶ç«Ÿåˆ†ç•Œçº¿åœ¨å“ªé‡Œå‘¢ï¼Ÿå¯ä»¥åœ¨ 511 æ‰¾åˆ°ç­”æ¡ˆï¼Œè€Œ[è¿™ä¸ªæ”¯æŒé¡µ](https://support.apple.com/en-us/HT207022)ä¹Ÿè®²çš„å¾ˆè¯¦ç»†ã€‚åŸºæœ¬æ¡ä»¶å°±æ˜¯è¿è¡Œ iOS 11 çš„ iPhone 7 ç­‰è®¾å¤‡ä»¥åŠä¹‹åçš„æ–°è®¾å¤‡ã€‚

### ç›‘å¬å˜åŒ–

ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä¸œé£ã€‚ä½†ï¼Œå¦‚æœæ­¤æ—¶ç³»ç»Ÿçš„å›¾ç‰‡åº“å‘ç”Ÿäº†æ”¹å˜ï¼Œåˆè¯¥æ€ä¹ˆåŠï¼Ÿ

åªéœ€è¦è®°ä½å››æ­¥ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ï¼š

1. è®©å½“å‰çš„ç±»éµå¾ª `PHPhotoLibraryChangeObserver` åè®®ã€‚

```swift
extension DetailInfoViewController: PHPhotoLibraryChangeObserver {

}
```

2. åœ¨è§†å›¾å³å°†å‡ºç°æ—¶å°†å½“å‰çš„ç±»ä½œä¸ºè§‚å¯Ÿè€…æ³¨å†Œåˆ° `PHPhotoLibrary` å…±äº«å¯¹è±¡ä¸Šã€‚

```swift
PHPhotoLibrary.shared().register(self)
```

3. å®ç° `PHPhotoLibraryChangeObserver` åè®®çš„ `photoLibraryDidChange(_:)`
 æ–¹æ³•ã€‚
 
```swift
func photoLibraryDidChange(_ changeInstance: PHChange) {
    // changeDetails æ–¹æ³•æœ‰æ¥å—ä¸åŒå‚æ•°çš„å¤šä¸ªç‰ˆæœ¬ï¼Œå¯å‚ç…§æ–‡æ¡£ã€‚
    guard let curAsset = asset, let details = changeInstance.changeDetails(for: curAsset) else {
        return
    }
    asset = details.objectAfterChanges
    ...
}    
```

4. æœ€ååœ¨ `deinit` ä¸­è§£é™¤ç›‘å¬ã€‚

```swift
deinit {
    PHPhotoLibrary.shared().unregisterChangeObserver(self)
}
``` 

## ä¸€äº›ç¬”è®°

### PromiseKit 6 

PromiseKit 6 å¯¹å‡ ä¸ªæ¯”è¾ƒæ ¸å¿ƒçš„ç‚¹åšå‡ºäº†ä¿®æ”¹ã€‚è¯´å®è¯ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæ¡†æ¶çš„æ–‡æ¡£å¯è¯»æ€§å…¶å®è¿˜æœ‰å¾…æå‡ã€‚ç›´æ¥çœ‹æºç åŠå…¶ä¸­çš„æ³¨é‡Šåè€Œæ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚

å…¶ä¸­ä¸€ç‚¹æ˜¯æ”¹å˜äº†æ ¸å¿ƒåˆå§‹åŒ–æ–¹æ³•ï¼š

```swift
// ä¹‹å‰
Promise { fulfill, reject in
    // ...
}

// ç°åœ¨
Promise { seal in
    // seal.fulfill(foo)
    // seal.reject(error)
    // seal.resolve(foo, error)
}
```

è¿˜æœ‰ä¸€ç‚¹æ˜¯ï¼Œå°†ä¸‡èƒ½çš„ `then` æ‹†åˆ†ä¸ºäº† `then`,Â `done`Â å’ŒÂ `map`ã€‚ä½œè€…çš„è§£é‡Šæ˜¯ï¼Œä»¥å‰ `then` åšå¾ˆå¤šäº‹ï¼Œä½†æ˜¯ç”±äºä¾èµ– Swift æ ¹æ®ä¸Šä¸‹æ–‡åšæ¨æ–­ï¼Œåœ¨ç”¨äº†å¤šä¸ª `then` ä¹‹åæ¨æ–­å°±ä¼šå‘ç”Ÿå¤±è´¥ã€‚è€Œä¸”å¾ˆéš¾åˆ¤æ–­é”™è¯¯å‘ç”Ÿåœ¨å“ªã€‚æ‰€ä»¥å°±åªèƒ½é€‰æ‹©ä»æ¯”è¾ƒé«˜çš„å±‚çº§å°±ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯æœ‰äº†ç°åœ¨çš„æ–¹æ¡ˆï¼š

- `then`ï¼šè¿”å›ä¸€ä¸ª promiseã€‚
- `done`ï¼šè¿”å›ä¸€ä¸ª Void promise (80% çš„æƒ…å†µç”¨åœ¨ promise é“¾ä¸­)ã€‚
- `map`ï¼šè¿”å›é promise å€¼ï¼Œæ¯”å¦‚ä¸€ä¸ªå•çº¯çš„å€¼ã€‚

### åœ°ç†ä½ç½®æ£€ç´¢

æˆ‘éœ€è¦çš„æ˜¯ä¸€ä¸ªæ ¹æ®å…³é”®å­—è·å–ç›¸å…³åœ°ç‚¹çš„ä¸€ä¸ªæ£€ç´¢ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ POI æ£€ç´¢ã€‚å› ä¸ºéœ€è¦æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å…ˆè€ƒè™‘äº† **MapKit** çš„ `MKLocalSearch` æˆ–è€… `MKLocalSearchCompleter`ã€‚

å‰è€…å¸¸å¸¸ä¼šç”¨åœ¨åœ°å›¾çš„æ£€ç´¢ï¼Œé€šè¿‡ `start(completionHandler:)` å¯ä»¥å–å¾— 10 ä¸ªç»“æœï¼Œå¹¶ä¸”è¿™ä¸ª limit æ— æ³•è‡ªå®šä¹‰ï¼Œå®ƒåœ¨ä¸»çº¿ç¨‹å·¥ä½œï¼Œè€Œä¸”å½“å‘èµ·æ–°çš„è¯·æ±‚æ—¶å½“å‰å³ä½¿æœ‰æ­£åœ¨è¿›è¡Œçš„æ£€ç´¢ä¹Ÿä¸ä¼šè¢«ç»ˆæ­¢ï¼Œå¦‚æœä¸æ³¨æ„å¾ˆå¯èƒ½ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœï¼š

```swift
let localSearchRequest = MKLocalSearchRequest()
let newestLocation = locations.last! as CLLocation
localSearchRequest.region = MKCoordinateRegion(center: newestLocation.coordinate, span: MKCoordinateSpanMake(5.0, 5.0))

MKLocalSearch(request: localSearchRequest).start(completionHandler: { (localSearchResponse, error) -> Void in
    guard searchText == searchBar.text else {
        return
    }
    ...
})
```

æ‰€ä»¥è¿™ä¼¼ä¹å¹¶ä¸æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©ã€‚è¾…ä»¥åè€…çš„ `MKLocalSearchCompleter` ä¼šæ›´å¥½ä¸€äº›ï¼š

```swift
let completer = MKLocalSearchCompleter()
completer.queryFragment = searchText

// MARK: MKLocalSearchCompleter Delegate
extension LocationSearchViewController: MKLocalSearchCompleterDelegate {

    // å¤„ç†æ£€ç´¢ç»“æœ
    func completerDidUpdateResults(_ completer: MKLocalSearchCompleter) {
        self.resultDataSource = completer.results
        ...
    }
    // å¤„ç†é”™è¯¯
    func completer(_ completer: MKLocalSearchCompleter, didFailWithError error: Error) {
        ...
    }
}
```

è¿™æ ·ä¸€æ¥ï¼Œæ£€ç´¢ç»“æœåˆ—è¡¨å°±å¯ä»¥å¾ˆç®€å•çš„è¡¨ç¤ºå‡ºæ¥äº†ã€‚å½“éœ€è¦å–å¾—å„ä¸ªä½ç½®çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¿˜æ˜¯æ— æ³•ç¦»å¼€ `MKLocalSearch`ï¼Œæ ¹æ®æ£€ç´¢ç»“æœåˆ›å»ºè¯·æ±‚å³å¯ã€‚

ä¸è¿‡å³ä½¿è¿™æ ·ä¹Ÿè¿˜æ˜¯æœ‰å¾ˆå¤šåˆ¶é™ï¼Œæ¯”å¦‚è¿‘é‚»æ£€ç´¢ï¼Œå°è¯•ä½¿ç”¨äº† Foursquareï¼Œè™½ç„¶è¿™ä¸ªé—®é¢˜å¾—ä»¥è§£å†³ï¼Œä½†æ˜¯è¯·æ±‚æ•°é‡çš„é™åˆ¶åˆæ˜¯æ–°çš„éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œè¦èµ°çš„è·¯è¿˜å¾ˆé•¿ã€‚å¦å¤–ï¼Œç”±äºåœ¨ä¸­å›½æ— æ³•æ£€ç´¢æµ·å¤–åœ°ç‚¹ï¼Œä¹Ÿæ— æ³•é€†å‘è½¬æ¢æµ·å¤–ç»çº¬åº¦ï¼Œè¦èµ°çš„è·¯ä¸æ˜¯å¾ˆé•¿ï¼Œè€Œæ˜¯å¾ˆé•¿å¾ˆé•¿ã€‚
]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%9B%9E%E9%A1%BEtryswift-2018</guid><title>å›é¡¾ Try!Swift Tokyo 2018</title><description>æ‹–å»¶ç—‡å¾ˆå¯æ€•ï¼Œè¿‡äº†å¿«ä¸¤å‘¨ç»ˆäºå¼€å§‹ç€æ‰‹å†™ Try!Swift Tokyo 2018 çš„æ„Ÿæƒ³ã€‚å—åˆ°äº†å‰åŒäº‹çš„å½±å“ï¼Œä»Šå¹´çš„å¤§ä¼šæˆ‘æ˜¯åšä¸ºå¿—æ„¿è€…å‚åŠ çš„ï¼Œç©å¾—å¾ˆå¼€å¿ƒï¼Œç„¶è€Œåªå¬åˆ°äº†ä¸€åŠçš„æ¼”è®²T.Tã€‚æ‰€ä»¥ä¹‹åä¼šä»å¬ä¼—å’Œå¿—æ„¿è€…ä¸¤ä¸ªè§’åº¦æ¥ç®€çŸ­çš„å†™ä¸€å†™è®©æˆ‘å°è±¡æ·±åˆ»çš„ä¸€äº›äº‹å„¿ã€‚</description><link>ckitakishi.com/posts/%E5%9B%9E%E9%A1%BEtryswift-2018</link><pubDate>Wed, 14 Mar 2018 19:37:00 +0900</pubDate><content:encoded><![CDATA[<h1>å›é¡¾ Try!Swift Tokyo 2018</h1><p>æ‹–å»¶ç—‡å¾ˆå¯æ€•ï¼Œè¿‡äº†å¿«ä¸¤å‘¨ç»ˆäºå¼€å§‹ç€æ‰‹å†™ Try!Swift Tokyo 2018 çš„æ„Ÿæƒ³ã€‚å—åˆ°äº†å‰åŒäº‹çš„å½±å“ï¼Œä»Šå¹´çš„å¤§ä¼šæˆ‘æ˜¯åšä¸ºå¿—æ„¿è€…å‚åŠ çš„ï¼Œç©å¾—å¾ˆå¼€å¿ƒï¼Œç„¶è€Œåªå¬åˆ°äº†ä¸€åŠçš„æ¼”è®²T.Tã€‚æ‰€ä»¥ä¹‹åä¼šä»å¬ä¼—å’Œå¿—æ„¿è€…ä¸¤ä¸ªè§’åº¦æ¥ç®€çŸ­çš„å†™ä¸€å†™è®©æˆ‘å°è±¡æ·±åˆ»çš„ä¸€äº›äº‹å„¿ã€‚</p><img src="ckitakishi.com/images/tryswift1.jpg" alt="é›†åˆå†™çœŸ"/><blockquote><p><a href="https://www.tryswift.co/events/2018/tokyo/jp">Try!Swift å®˜ç½‘</a></p></blockquote><p>ä¹…é—»ä¸å¦‚ä¸€è§ï¼Œå„ç§æœºç¼˜å·§åˆç»ˆäºå’Œ<a href="https://onevcat.com">å–µç¥</a>ç¢°é¢äº†ï¼Œä¸€è·¯å­¦ä¹  iOS å¯èƒ½è¯»çš„æœ€å¤šçš„å°±æ˜¯å–µç¥å†™çš„æ–‡ç« äº†ï¼ŒçœŸçš„æ˜¯å—ç›ŠåŒªæµ…ã€‚è™½ç„¶å› ä¸ºæ¯”è¾ƒå¿™åªèŠäº†ä¸€ä¼šå„¿è¿˜éƒ½æ˜¯æ‚è°ˆwwwï¼Œä½†æ˜¯æœ‰ç§æˆå°±è¾¾æˆçš„æ¿€åŠ¨æ„Ÿ(`ï½¥âˆ€ï½¥)</p><p>ç¬¬ä¸€å¤©æ—©æ™¨è¿˜é‡åˆ°äº† <a href="http://smoozapp.com/">Smooz</a> çš„åˆ›å§‹äºº Kato æ¡‘ï¼Œäººå¾ˆå’Œå–„ä¸”å¥è°ˆï¼Œå›å¿†èµ·ç¬¬ä¸€æ¬¡çŸ¥é“ Smooz æ˜¯ 16 å¹´çš„å¹´åˆï¼Œé‚£æ—¶å€™è¿˜åœ¨æµ‹è¯•é˜¶æ®µï¼Œåªæœ‰ iOS ç‰ˆæœ¬ï¼Œä¹Ÿè¿˜æ²¡æœ‰æˆç«‹å…¬å¸è¿è¥ï¼Œç±»ä¼¼äºç‹¬ç«‹å¼€å‘è€…é¡¹ç›®ã€‚Smooz æ‹¥æœ‰ç±»ä¼¼ web æµè§ˆå™¨çš„å¤š tab ç½®é¡¶è®©äººçœ¼å‰ä¸€äº®ï¼Œå„ç§æ‰‹åŠ¿çš„ä¾¿åˆ©æ€§ä¹Ÿå¢è‰²ä¸å°‘ï¼Œå¦å¤–é¢œè‰²è¿˜ç›¸å½“å¯çˆ±ã€‚å½“æ—¶ (å¾ˆå¤±ç¤¼åœ°) æš—è‡ªæƒ³ä¼šä¸ä¼šæ¸æ¸åˆæˆä¸ºä¸€ä¸ªæ¢è‚¤æµè§ˆå™¨ï¼Ÿäº‹å®èƒœäºä¸€åˆ‡ï¼Œåæ¥ Smooz è·å¾—äº† App Store Best of 2016ï¼Œç°åœ¨å¸¸å¸¸å¯ä»¥åœ¨ç”µè½¦ä¸Šçœ‹åˆ°ç”¨æˆ·ï¼Œæ€»ä¹‹æ˜¯ä¸€æ¬¾å¾ˆä¸ä¸€æ ·çš„ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œå€¼å¾—ä¸€è¯•ã€‚</p><!--more-->

## å¬ä¼—è§†è§’

ç¼ºå¸­äº†å‡ åœºæƒ³å¬çš„æ¼”è®²ï¼Œåƒæ˜¯ Charlse for iOS..æ³ªç›®ã€‚ä¸‹é¢æ‰€å†™çš„å¤§å¤šæ˜¯ä¸´åœºæ„Ÿå—ã€‚

> è¿™æ˜¯ä¸€ä»½æ—¥è¯­çš„[èµ„æ–™æ€»ç»“](https://qiita.com/ozwio/items/71fb765b48905d6a2193)ã€‚

### ä»£ç ä¼˜åŒ–ï¼šOptimizing Swift code for separation of concerns and simplicity

ä»£ç çš„ä¼˜åŒ–æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ï¼Œä¸è¿‡æœ‰äº›ä¸œè¥¿è¶Šè€è¶Šèƒ½å‡¸æ˜¾å®ƒçš„ä»·å€¼æ‰€åœ¨ã€‚æˆ‘ä¸ªäººå¯¹è¿™ä¸ªè¯é¢˜æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œä¸€æ–¹é¢æ˜¯å¦‚è®²è€…æ‰€è¯´ï¼šä»£ç é€šå¸¸è¯»æ¯”å†™æ›´å¤šï¼›è¿˜æœ‰ä¸€ä¸ªåŸå› å°±æ˜¯å›¢é˜Ÿåˆä½œï¼Œç®€æ´æ˜ç¡®å†é‡è¦ä¸è¿‡äº†ã€‚å¬å®Œè¿™ä¸ªâ€œæœ€ä½³ç¼–ç¨‹å®è·µâ€ä¹‹åï¼Œæˆ‘è§‰å¾—å¯¹äºæˆ‘è¿™æ ·æ®µä½ä¸é«˜çš„å¼€å‘è€…æ¥è¯´è¿˜æ˜¯é¢‡æœ‰æ”¶è·çš„ï¼Œä¹Ÿè®¸ä»Šåèƒ½æŠŠä»£ç å†™çš„æ›´ Swifty ä¸€äº›ï¼Ÿã€‚å¦å¤–ï¼Œæ‰©å±•ç»™ Swift å¸¦æ¥çš„ä¾¿åˆ©åœ¨è¿™äº›ä¾‹å­ä¸­ä¹Ÿæ˜¯ä½“ç°çš„æ·‹æ¼“å°½è‡´ã€‚

å¾ˆå¤šä¾‹å­éƒ½æ·±æœ‰åŒæ„Ÿï¼Œæ¯”å¦‚è¯´ä¸‹é¢è¿™ç§æ¨¡å‹ï¼š

```swift
// before
api.requestReplies(postID: 4815162342) { [weak self] result in
   switch result {
   case .success(let replies):
     var filteredReplies: [Reply] = []
     for reply in replies {
       if !user.isBlocking(reply.author) {
         filteredReplies.append(reply)
       }
     }

     self?.replies = filteredReplies
   case .failure:
       // ...
   }
}
```

ä½œä¸ºä¸€ä¸ªå†™ Objective-C å¤šäº Swift çš„äººï¼Œç§ä»¥ä¸ºè¿™æ ·çš„å†™æ³•åœ¨å¤§å®¶çš„ Objc ä»£ç ä¸­å¯æ˜¯è¯´æ˜¯ååˆ†å¸¸è§äº†ï½å³ä½¿èƒ½ä¼˜åŒ–ï¼Œæ„Ÿè§‰ä¹Ÿåªèƒ½åŠ å…¥ä¸€ä¸ª filter å†™æˆä¸‹é¢è¿™æ ·ï¼Ÿ

```objc
NSArray *filteredArray = [replies filteredArrayUsingPredicate:[NSPredicate predicateWithBlock:^BOOL(Reply *reply, NSDictionary *bindings) {
    return [user isBlocking:reply.author];
}]];
```

è®²è€…æåˆ°çš„ Swift ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ï¼š1. å°†æ ¸å¿ƒé€»è¾‘æŠ½è±¡å‡ºæ¥ä½œä¸ºä¸€ä¸ª Collection çš„æ‰©å±•ï¼›2. æ´»ç”¨ `var` å’Œ `filter`ã€‚è¿™æ ·ä¸€æ¥ï¼Œä»£ç çš„â€œä¿¡å™ªæ¯”â€ä¼šå¾—åˆ°ä¸å°‘æå‡ï¼Œå†™æ³•ä¹Ÿæ¯”è¾ƒä¼˜é›…ï¼š

```swift
// After
extension Collection where Element == Reply {
  var filteringBlockedContent: [Reply] {
    return filter { !user.isBlocking($0.author) }
  }
}

api.requestReplies(postID: 4815162342) { [weak self] result in
   switch result {
   case .success(let replies):
     self?.replies = replies.filteringBlockedContent
   case .failure:
       // ...
   }
}
```

çœŸå¿ƒå¸Œæœ›ä»¥åå†™çš„ä»£ç éƒ½æ˜¯ "After"ã€‚

> æ›´å¤šä¾‹å­åœ¨[è¿™é‡Œ](https://github.com/JaviSoto/Talks/tree/master/TrySwiftTokyo2018)

### SwiftNIO

è¿˜åœ¨æ¼”è®²å‰å¤§å®¶ä¸€èµ·èŠå¤©æ—¶å°±æ¨æµ‹è¿™å¯èƒ½æ˜¯å½“æ—¥æœ€ç«ï¼Ÿæ¯•ç«Ÿèƒ½åœ¨ WWDC ä»¥å¤–å’Œ Apple å·¥ç¨‹å¸ˆäº¤æµçš„æœºä¼šå°‘ä¹‹åˆå°‘ï¼Œå› æ­¤è¿˜ä¸º Q&A ç¯èŠ‚å¢æ´¾äº†å¿—æ„¿è€…ï½è€Œå‘è¡¨çš„å†…å®¹ä¹Ÿæ²¡æœ‰è®©äººå¤±æœ›ï¼Œï¼Œåœ¨ä»‹ç»äº†ä¸€äº›æœ‰å…³å¼‚æ­¥ï¼Œä»¥åŠ IO äº‹ä»¶çš„å‘ç”Ÿå…¶å®å¯èƒ½å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³çš„é‚£ä¹ˆé¢‘ç¹ä¹‹åï¼Œè¡¨ç¤ºä¸å¦‚æ‰“é€ ä¸€ä¸ª Swift ç‰ˆçš„ Netty æ¥è®©æ€§èƒ½å¾—åˆ°ä¸€ä¸ªé£è·ƒå§ï¼Œäºæ˜¯ SwiftNIO å°±è¯ç”Ÿäº†ã€‚åæ¥çš„å†…å®¹é™·å…¥äº†ä¸€ç§äº‘é‡Œé›¾é‡Œï¼Œè¿˜æ˜¯æš‚ä¸”å…ˆè·³è¿‡å§ğŸ˜‚ã€‚åœ¨æ„æ–™ä¹‹å¤–çš„æ˜¯æœ€åç›´æ¥å®£å¸ƒäº† SwiftNIO çš„å¼€æºã€‚éšç€å®ƒçš„å¼€æºï¼ŒæœåŠ¡å™¨ç«¯ Swift ç®—æ˜¯åˆè¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ã€‚

æœ€è¿‘æœ‰äººæ‹…å¿ƒ Norman ä¼šä¸ä¼šå› ä¸º SwiftNIO çš„å¼€æºè€Œå¯¼è‡´ç»´æŠ¤ Netty çš„æ—¶é—´å˜å°‘ï¼Œä»–è¡¨ç¤ºä¸ç”¨æ‹…å¿ƒå™¢å¤§å®¶ï¼Œæˆ‘å·²ç»åŒæ—¶ç»´æŠ¤å®ƒä»¬è¶…è¿‡ä¸€å¹´äº†ï½

> å‰ä¸¤å¤©è§†é¢‘å·²ç»å…¬å¼€äº†ï¼š[Youtube Link](https://www.youtube.com/watch?v=QJ3WG9kRLMo&feature=youtu.be)

### ç”¨ Swift è¿›è¡Œæ¸¸æˆå¼€å‘ğŸ‘¾

æ¼”è®²è€… [giginet](https://twitter.com/giginet) å»å¹´æ˜¯ Lightning Talkï¼Œå‘è¡¨äº†ç”¨ SprireKit åœ¨ AppleWatch ä¸Šå¼€å‘è¶…çº§ç›ä¸½çš„ç§ç§ï¼Œå¹¶åœ¨æ­¤åçš„ Hackthon ä¸­å¼€å‘äº†ä¸€ä¸ª Touch Bar å°æ¸¸æˆï¼ŒèŠ±æ ·æŒ–æ˜è‹¹æœå®¶è®¾å¤‡çš„æ½œèƒ½ï¼Œå¾ˆä¼šç©ã€‚

ä»Šå¹´å†æ¬¡å·åœŸé‡æ¥ï¼Œä¸Šæ¥å°±è¡¨ç¤ºå…¶å® Xcode æ˜¯ä¸€ä¸ªæ¸¸æˆå¼€å‘å·¥å…·ï¼Œå¹¶å±•ç¤ºäº†åœ¨ Xcode é‡Œç»˜åˆ¶çš„ä¸–ç•Œåœ°å›¾â€¦è¨€å½’æ­£ä¼ ï¼Œå¼€å§‹ç€é‡ä»‹ç»äº†ä¸€ä¸‹ SprireKit å’Œ GameplayKit çš„åŸºæœ¬ç”¨æ³•å’Œç¤ºä¾‹ã€‚æœ€åå†æŠŠ SprireKit ä¸ Unity è¿›è¡Œäº†ä¸€æ³¢æ¯”è¾ƒï¼Œå‡ ä¹åœ¨æ‰€æœ‰å¹³å°å…¨å†›è¦†æ²¡çš„ SprireKit åœ¨ WatchOS ç‹¬å äº†ä¸€å—é˜µåœ°ã€‚ã€‚æ‰€ä»¥ Swift å¼€å‘è€…ä»¬éƒ½è¡ŒåŠ¨èµ·æ¥å§ï¼

è™½ç„¶å¼€äº†å¾ˆå¤šç©ç¬‘ï¼Œä¸è¿‡å¦‚æœæƒ³ç€æ‰‹æ¸¸æˆå¼€å‘ï¼Œä¹Ÿè®¸è¿˜çœŸå¯ä»¥ç”¨ Swift ä¸€è¯•å‘¢ï¼Ÿ

> [èµ„æ–™](https://speakerdeck.com/giginet/-11)

### ç®—æ³•å¯è§†åŒ–ï¼šUsing Swift to Visualize Algorithms

æ²¡æœ‰å¬åˆ°æ¼”è®²å‰ä»¥ä¸ºä¼šæ˜¯ä¸€ä¸ªå€Ÿç®—æ³•å¯è§†åŒ–æ¥ä»‹ç» Swift åœ¨å›¾å½¢ç»˜åˆ¶ä¸Šçš„ä¼˜åŠ¿ä¹‹ç±»çš„ã€‚æ¯”è¾ƒæ„å¤–çœŸæ­£çš„æ ¸å¿ƒä¸»é¢˜æ˜¯è´å¡å°”æ›²çº¿ã€‚è¿™ä¸ªæ¼”è®²åœ¨ç°åœºå¾—åˆ°äº†ç›¸å½“å¥½çš„åå“ï¼Œå¤§æ¦‚å‡­å€Ÿçš„æ˜¯è®²è§£æ¯”è¾ƒæ¸…æ™°æ˜“æ‡‚ï¼Œåƒæ˜¯ç»™å®šä»»æ„ç‚¹å¦‚ä½•ç»˜åˆ¶ï¼Œå¤šé˜¶è´å¡å°”æ›²çº¿å¦‚ä½•ç»˜åˆ¶éƒ½èƒ½ä»ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚å¦‚æœå¯¹åŠ¨ç”»æœ‰å…´è¶£ä½†ä¸äº†è§£è´å¡å°”æ›²çº¿çš„ç»˜åˆ¶æ–¹æ³•ä¸å¦¨çœ‹ä¸€çœ‹ï½

> [èµ„æ–™](https://speakerdeck.com/subdigital/bezier-curves)

### Open Source Swift Workshop

æœ€åä¸€å¤©æœ‰å‡ åœº workshopï¼Œæˆ‘åªå»äº† Open Source Swift Workshop ( BY [Nicholas Maccharoli](https://twitter.com/din0sr) & [ikesyo](https://twitter.com/ikesyo)  )ã€‚å¤§æ¦‚å¯ä»¥æ¦‚æ‹¬ä¸º â€œå¦‚ä½•é€šè¿‡æ”¹ bug æˆ–ä¼˜åŒ–ä¸º Swift è´¡çŒ®åŠ›é‡â€ã€‚åº”è¯¥æœ‰å¾ˆå¤šäººéƒ½æƒ³è¿‡ï¼Œé™¤äº†ç”¨ Swift å†™ä»£ç ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯èƒ½åšçš„æ›´å¤šå‘¢ã€‚ç°å®çš„æ®‹é…·åœ¨äºï¼Œå®é™…ä¸Šæ‰‹æœ‰æ—¶å€™å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ï¼Œä¹Ÿè®¸æ˜¯éœ€è¦ä¸€ä¸ªå¥‘æœºï¼Œä¹Ÿè®¸æ˜¯éœ€è¦ä¸€ä¸ªäººå¼•å¯¼ã€‚è€Œè¿™ä¸ª workshop ä¾¿æˆä¸ºäº†ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šï¼Œç»“æŸåæœ‰ä¸æ­¢ä¸€ä¸ªäººæäº† pr...

é‰´äºè‡ªèº«å­¦è¯†æµ…è–„ï¼Œå½“å¤©å‘ ikesyo æ¡‘è¯·æ•™äº†æœ€åˆè¯¥å¦‚ä½•ç€æ‰‹ï¼Œä½œä¸ºå…¥é—¨æˆ‘è§‰å¾—å¾ˆç»†è‡´å¾ˆæ¸…æ™°ï¼š

0. build æœ€æ–°çš„ Swift æºç ã€‚
1. https://bugs.swift.org ï¼šåœ¨è¿™é‡Œä¼šæœ‰å¾ˆå¤šå¾…è§£å†³çš„ issue, å±äº Compiler,  LLDB for Swift, Package Manager, Standard  Library ç­‰æ¨¡å—ï¼Œç¬¬ä¸€æ¬¡ä¸Šæ‰‹é€‰æ‹©è‡ªå·±ç›¸å¯¹äº†è§£çš„ä¼šæ¯”è¾ƒå¥½ï¼Œä¾‹å¦‚ï¼šStandard Library å’Œ Foundationã€‚æ­£ç¡®ä½¿ç”¨ Filter  ä¹Ÿæœ‰åŠ©äºæ‰¾åˆ°é€‚åˆè‡ªå·±çš„ issueï¼Œæ¯”å¦‚è¯´æ£€ç´¢å¸¦æœ‰å…¥é—¨çº§æ ‡ç­¾çš„ Standard Library æˆ– Foundation issue: `labels = StarterBug AND status = Open AND component in ("Standard Library", Foundation)`ã€‚
2. https://forums.swift.org/ ï¼šåœ¨è¿™é‡Œå’Œå¤§å®¶æ„‰å¿«çš„è®¨è®ºé—®é¢˜ã€‚
3. ä¹Ÿå¯ä»¥é€šè¿‡ä»æºç ä¸­æŸ¥æ‰¾ `FIXME`, `TODO` è¿™äº›å…³é”®å­—æ¥æŸ¥æ‰¾å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œè¿™å…¶ä¸­ç”šè‡³æœ‰ä¸€äº›æ˜¯æ–‡æœ¬å±‚é¢çš„ä¿®æ­£ï½

**æ‰©å±•é˜…è¯»ï¼š**

- https://swift.org/compiler-stdlib/#compiler-architecture
- https://swift.org/community/
- https://academy.realm.io/posts/tryswift-jesse-squires-contributing-open-source-swift/
- https://www.uraimo.com/2016/02/09/a-short-swift-gyb-tutorial/
- https://www.youtube.com/watch?v=e18uipMmEoo

## å¿—æ„¿è€…è§†è§’

ä»Šå¹´çš„å‚ä¼šäººæ•°åŒ…æ‹¬ Sponsor å’Œ Speaker è¾¾åˆ°äº† 800 äººï¼Œæ¥è‡ªæ—¥æœ¬ä»¥å¤–çš„å‚åŠ è€…ä¹Ÿè¶…è¿‡äº† 200 äººï¼Œå¿—æ„¿è€…çš„æ•°é‡çº¦ä¸º 30 äººã€‚é˜´å·®é˜³é”™ï¼Œæˆ‘ä¸»è¦æ‹…å½“çš„æ˜¯ global supportï¼Œå¼•å¯¼æ¼”è®²è€…ä¸åŒä¼ äº‹å‰ä¼šé¢ï¼ŒæŒ‰æ—¶ä¸Šå°ï¼Œä¹‹å Q&Aã€‚å¾ˆæœ‰æ„æ€çš„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œè‹±è¯­åŒå£°è¯‘æ—¥è¯­å…¶å®å¾ˆç—›è‹¦ï¼Œå› ä¸ºæ—¥è¯­çœŸçš„å¾ˆå•°å—¦ï¼Œå°¤å…¶æ˜¯è¿™ç§åœºåˆåŸºæœ¬éƒ½æ˜¯æ•¬è¯­ï¼Œè‹±è¯­ 10 ä¸ªéŸ³èŠ‚æ—¥è¯­å¯èƒ½éœ€è¦ 20 ä¸ªï¼Œæ¯æ¬¡åŒä¼ ä»¬éƒ½ä¼šåƒå®å’›ä¸‡å˜±å’æ¼”è®²è€…æ…¢ä¸€ç‚¹å†æ…¢ä¸€ç‚¹ğŸ˜‚ï¼Œäº‹åå†åæ§½â€œä½ æ€ä¹ˆè¶Šè®²è¶Šå¿«å‘¢ï½ï½â€ã€‚å¾ˆå¤§çš„æ”¶è·æ˜¯æ„è¯†åˆ°äº†è‡ªå·±çš„è¯­è¨€æ˜¯æœ‰å¤šä¹ˆå·®ã€‚ã€‚ã€‚

è¿™æ¬¡æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„å¿—æ„¿è€…ï¼Œ80 å¤šå²äº†ä»ç„¶åœ¨å­¦ä¹ å†™ä»£ç ï¼Œæœ‰è‡ªå·±çš„ä¸»é¡µåŠä¸Šæ¶åº”ç”¨ï¼Œå¬è¯´ä¹‹åè§‰å¾—å”¯æœ‰æ•¬ä½©ï¼Œæ²¡èƒ½ç›´æ¥äº¤æµçœŸæ˜¯å¤ªé—æ†¾äº†ã€‚æœ‰æ—¶å€™ä¼‘ä¼šæ—¶é—´ä¼šçœ‹åˆ°ä¸€äº›äººç›’é¥­æ”¾ä¸€è¾¹ï¼Œååœ¨èµ°å»Šå’Œå¢™è¾¹å°±å™¼é‡Œå•ªå•¦å†™ä»£ç ï¼Œç”±è¡·çš„è§‰å¾—ï¼šèƒ½å¦‚æ­¤çƒ­çˆ±ä¸€ä»¶äº‹çœŸæ˜¯å¤ªå¥½äº†ï¼

æ—¥æœ¬å¾ˆå¤š iOS æ´»è·ƒçš„ä¼ä¸šéƒ½ä½œä¸º Sponsor æœ‰è‡ªå·±çš„å±•åŒºï¼Œï¼ˆä¸»è¦è¿˜æ˜¯ä¸ºäº†æ‹›è˜ï¼Œåˆ°å¤„çœ‹è¢«å¡äº†å¥½å‡ ä»½ä»‹ç»ï¼‰ã€‚åƒæ˜¯ Yahoo Japan çš„ live coding å¾—åˆ°äº†å¾ˆå¥½çš„åå“ã€‚äºä¼ä¸šäºä¸ªäººè¿™éƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„æœºä¼šã€‚

P.S. Party çš„è›‹ç³•çœŸçš„æ˜¯å¤ªå¯çˆ±äº†...

![Cake](/images/tryswift2.jpg)

## å†™åœ¨æœ€å

äºæˆ‘è€Œè¨€ï¼Œå¤§æ¦‚å°±æ˜¯æ„è¯†åˆ°äº†è‡ªå·±åœ¨å¾ˆå¤šæ–¹é¢éƒ½è¿˜å·®å¾ˆè¿œçš„äº‹å®ï¼Œä¸ç®¡æ˜¯æŠ€æœ¯è¿˜æ˜¯æ—¥è¯­è‹±è¯­ã€‚å‰è·¯æ¼«æ¼«ï¼Œç»§ç»­åŠ æ²¹ã€‚æ˜å¹´å†è§ã€‚
]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E6%83%B3%E8%A6%81%E5%9D%9A%E6%8C%81%E4%B8%8B%E5%8E%BB%E7%9A%842018</guid><title>æƒ³è¦åšæŒä¸‹å»çš„2018</title><description>2018 å›é¡¾ &amp; 2019 æœŸè®¸</description><link>ckitakishi.com/posts/%E6%83%B3%E8%A6%81%E5%9D%9A%E6%8C%81%E4%B8%8B%E5%8E%BB%E7%9A%842018</link><pubDate>Mon, 8 Jan 2018 21:30:00 +0900</pubDate><content:encoded><![CDATA[<h1>æƒ³è¦åšæŒä¸‹å»çš„2018</h1><p>å‰ä¸¤å¤©ç»ˆäºçœ‹äº†ç”µè§†å‰§ç‰ˆã€Šç«èŠ±ã€‹ï¼Œä¹…ä¹…æ— æ³•é‡Šæ€€ã€‚å¾ˆå–œæ¬¢çš„ä¸€å¹•æ˜¯ sparks çš„è°¢å¹•æ¼”å‡ºï¼Œä¸å†ä¸ºäº†è¿åˆæ½®æµè€Œè®²æ®µå­ï¼Œæ³ªæµæ»¡é¢è¯´åè¯ï¼Œå“­ç€ç¬‘ï¼Œç¬‘ç€å“­ï¼Œæœ€åçš„ç»½æ”¾å•Šã€‚åšæŒä¸åŠªåŠ›æ˜¯å› ä¸ºè¿˜æœ‰æ¢¦æƒ³ï¼Œå¯å¦¥åä¸æ”¾å¼ƒå¹¶ä¸æ˜¯ç»“æŸï¼Œè¿˜èƒ½å¹³å‡¡çš„æ´»ç€ï¼Œå°±æ€»è¿˜ä¼šæœ‰å¹³å‡¡çš„å¥‡è¿¹ã€‚</p><h2>==== é¢˜å¤–è¯çš„åˆ†å‰²çº¿ ====</h2><p>è¿‡å»è¿™ä¸€å¹´ï¼Œå¸¸å¸¸æ„Ÿè§‰å¥½æ— å¥ˆã€‚åšæŒè¿åŠ¨ï¼Œå¾ˆå¤§ç¨‹åº¦ä¿æŒå¥åº·é¥®é£Ÿï¼Œå¯èº«ä½“çŠ¶å†µå´æ„å¤–çš„å·®ã€‚å¯æ˜¯é™¤äº†åšæŒä¸‹å»è¿˜èƒ½æœ‰ä»€ä¹ˆåŠæ³•å‘¢ï¼Ÿå·¥ä½œå†…å®¹æ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œä¾ç„¶æ‹…å½“ç€å‡ ä¸ªåº”ç”¨çš„å¼€å‘ï¼Œåªä¸è¿‡å¤šäº†å’Œå®¢æˆ·çš„æ¥æ´½ï¼Œç„¶é¹…æˆ‘è¿™æ ·çš„æ¸£æ—¥è¯­ä»€ä¹ˆæ—¶å€™æ‰èƒ½å’Œå®¢æˆ·è°ˆç¬‘é£ç”Ÿå•Šã€‚æ²¡æœ‰ä»€ä¹ˆæƒŠå–œï¼Œä¸è¿‡æ„Ÿæ€§çš„ç”¨å¿ƒæƒ…æ¥è¯„ä»·çš„è¯ï¼Œå…¶å®çœŸçš„ä¹Ÿä¸å¤ªåï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“æ„ŸåŠ¨å¾ˆå®¹æ˜“å¼€å¿ƒã€‚</p><p>2018 å¹´æœ€æƒ³è¦çš„åœ¨ä¸€äº›äº‹æƒ…ä¸ŠåšæŒä¸‹å»ï¼Œçºµç„¶ä¹Ÿè®¸ä»€ä¹ˆä¹Ÿæ”¹å˜ä¸äº†ï¼Œå“ˆå“ˆã€‚é¢¤æŠ–ç€ç«‹ä¸ª flag å§ï¼š</p><ul><li>æ—¥è¯­å’Œè‹±è¯­è¿›é˜¶</li><li>å’Œæ›´å¤šäººäº¤æµå’Œæ²Ÿé€š</li><li>åœ¨ test å’Œ project manage æ–¹é¢æœ‰è¿›æ­¥ï¼Œåˆ†äº«çŸ¥è¯†ï¼Œæ‹¥æŠ±å¼€æº</li><li>æ‹ä¸é”™çš„ç…§ç‰‡ï¼Œåšå¥½åƒçš„é¥­ï¼ŒåšæŒè¿åŠ¨ï¼Œå»æ—…è¡Œ</li><li>è¯» 24 æœ¬ä¹¦</li><li>ä¸Šæ¶ 2ï½3 ä¸ªå°åº”ç”¨</li><li>æ¢å·¥ä½œ</li></ul>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%AE%9E%E8%B7%B5%EF%BC%9AObjective-C%E7%9A%84%E5%AE%8F%E5%AE%9A%E4%B9%89</guid><title>å®è·µï¼šObjective-Cçš„å®å®šä¹‰</title><description>å®å®šä¹‰åœ¨ Objective-C ä¸­å¯ä»¥è¯´æ˜¯è¢«å¹¿æ³›ä½¿ç”¨ã€‚å°±å®é™…æ¥è¯´ï¼Œç›®å‰ç»„å†…å¯¹ Enum, Singeleton, Log ç­‰éƒ½ä½¿ç”¨äº†å®æ¥è¿›è¡Œå®šä¹‰ã€‚ç©¶å…¶åŸå› ï¼Œä¸€éƒ¨åˆ†æ˜¯ä¸ºäº†ä¸ºäº†å‡å°‘é‡å¤ä»£ç ï¼Œæå‡å¼€å‘ä½“éªŒï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ¥æºäºå¯¹æ¡ä»¶ç¼–è¯‘çš„éœ€æ±‚ã€‚</description><link>ckitakishi.com/posts/%E5%AE%9E%E8%B7%B5%EF%BC%9AObjective-C%E7%9A%84%E5%AE%8F%E5%AE%9A%E4%B9%89</link><pubDate>Thu, 30 Nov 2017 22:17:00 +0900</pubDate><content:encoded><![CDATA[<blockquote><p>ä¹‹å‰æŸä¸€å‘¨çš„ LT è¯é¢˜ã€‚</p></blockquote><h1>å®è·µï¼šObjective-Cçš„å®å®šä¹‰</h1><p>å®å®šä¹‰åœ¨ Objective-C ä¸­å¯ä»¥è¯´æ˜¯è¢«å¹¿æ³›ä½¿ç”¨ã€‚å°±å®é™…æ¥è¯´ï¼Œç›®å‰ç»„å†…å¯¹ Enum, Singeleton, Log ç­‰éƒ½ä½¿ç”¨äº†å®æ¥è¿›è¡Œå®šä¹‰ã€‚ç©¶å…¶åŸå› ï¼Œä¸€éƒ¨åˆ†æ˜¯ä¸ºäº†ä¸ºäº†å‡å°‘é‡å¤ä»£ç ï¼Œæå‡å¼€å‘ä½“éªŒï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ¥æºäºå¯¹æ¡ä»¶ç¼–è¯‘çš„éœ€æ±‚ã€‚</p><p>æœ€æ—©çŸ¥é“å®å®šä¹‰æ˜¯åœ¨ C è¯­è¨€è¯¾æœ¬ä¸Šï¼Œç„¶åå°±æ˜¯ç¬”è¯•æ—¶å€™çš„å„ç§å®å±•å¼€ã€‚ä½†æ˜¯ç›´åˆ°æŠ•å…¥é¡¹ç›®å¼€å‘ä¹‹åæ‰ç®—æ˜¯ç¨å¾®ç†è§£äº†ä¸€äº›å®çš„å¼ºå¤§ä¸è„†å¼±ã€‚æ‰€ä»¥å¾ˆæƒ³ç®€å•è°ˆä¸€è°ˆ Objective-C çš„å®å®šä¹‰å®è·µã€‚</p><h2>å…³äºå®</h2><p>å®å±äº C é¢„å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼ŒC++ï¼ŒObjective-C ä¹Ÿä¸€æ ·é€šç”¨ã€‚å®åˆ†ä¸ºä¸¤ç§ï¼Œå¯¹è±¡å® (<strong>Object-like</strong>) å’Œå‡½æ•°å® (<strong>Function-like</strong>)ã€‚é¡¾åæ€ä¹‰ï¼Œå¯¹è±¡å®ç±»ä¼¼äºæ•°æ®å¯¹è±¡ï¼Œå‡½æ•°å®ç±»ä¼¼äºå‡½æ•°è°ƒç”¨ã€‚</p><!--more-->

```objc
// Object-like
#define HEIGHT 60

// Function-like
#define MIN(a, b) a < b ? a : b
```

å‡½æ•°å®çœ‹èµ·æ¥å¯ä»¥è¯´æ˜¯ç›¸å½“ä¾¿åˆ©ï¼Œè€Œä¸”æ‰§è¡Œæ•ˆç‡è¿˜éå¸¸é«˜ã€‚ä½†æ˜¯åœ¨å®é™…è¿ç”¨ä¸­å¾ˆå¤šæ—¶å€™å¹¶ä¸æ¨èä½¿ç”¨ï¼Œæ¯”å¦‚å½“å‡ºç°è‡ªå¢è‡ªå‡è¿ç®—æ—¶ï¼Œä¸Šé¢çš„æœ€å°å€¼å°±å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ï¼Œä½ ä¸èƒ½è¯´å®ƒæ˜¯é™·é˜±ï¼Œæ¯•ç«Ÿå®çš„å¼ºé¡¹å¹¶ä¸æ˜¯å¤æ‚çš„é€»è¾‘è¿ç®—ã€‚ä½†æ˜¯è‰ºé«˜äººèƒ†å¤§ï¼Œå¦‚æœèƒ½ç©å¾—è½¬ç”¨ä¸€ç”¨ä¹Ÿæ— å¦¨~

æ‰©å±•é˜…è¯»ï¼š[The C Preprocessor](https://gcc.gnu.org/onlinedocs/cpp/index.html#SEC_Contents)

## å®è·µ

### å•ä¾‹çš„å®å®šä¹‰ï¼š

ä½¿ç”¨äº†æ¡ä»¶ç¼–è¯‘ `#ifndef`ï¼Œæ¨èè¿™ç§å†™æ³•ï¼Œå°¤å…¶æ˜¯åœ¨å®šä¹‰ cell çš„é«˜åº¦æ—¶æœ€å¥½è¿™ä¹ˆåšï¼Œé˜²æ­¢å¤šé‡å®šä¹‰ã€‚
è¿™æ˜¯ä¸€ä¸ªå‡½æ•°å®ã€‚

```objc
#ifndef Singleton_h
#define Singleton_h

#define SINGLETON_IMPL( classname )\
+ (classname *)sharedInstance\
{\
static dispatch_once_t onceToken;\
static classname *_sharedInstance = nil;\
dispatch_once(&onceToken, ^{\
_sharedInstance = [[[self class] alloc] init];\
});\
return _sharedInstance;\
}

#define SINGLETON_DEFINE( classname )\
+ (classname *)sharedInstance;

#endif
```

åˆ©ç”¨ä¾‹ï¼š

```
ClassName.h
SINGLETON_DEFINE(ClassName)

ClassName.m
SINGLETON_IMPL(ClassName)

OtherClass:
[ClassName sharedInstance].property
```

### 2. enumçš„å®å®šä¹‰ï¼š

```objc
#ifndef APP_ENUM
#define APP_ENUM( name_ ) \
typedef enum name_ : NSInteger name_; \
enum name_ : NSInteger
#endif
```

åˆ©ç”¨ä¾‹ï¼š

```objc
APP_ENUM( EnumName ) {
    EnumNameA,
    EnumNameB
};
```

### 3. LOGçš„å®å®šä¹‰ï¼š

å½“ä¸”ä»…å½“ç‰ˆæœ¬ä¸ºå¼€å‘ç‰ˆæˆ–å†…éƒ¨æµ‹è¯•ç‰ˆæ—¶è¾“å‡º logã€‚è¿™é‡Œçš„ `__PRETTY_FUNCTION__`, `__LINE__` éƒ½æ˜¯ C ä¸­å·²å®šä¹‰çš„å‡½æ•°å®ï¼Œåˆ†åˆ«è¡¨ç¤ºå‡½æ•°å’Œè¡Œæ•°ã€‚

```objc
#ifdef DEBUG
#define LOG(A, ...) NSLog(@"DEBUG: %s:%d:%@", __PRETTY_FUNCTION__,__LINE__,[NSString stringWithFormat:A, ## __VA_ARGS__]);
#elif defined ALPHA
#define LOG(A, ...) NSLog(@"ALPHA: %s:%d:%@", __PRETTY_FUNCTION__,__LINE__,[NSString stringWithFormat:A, ## __VA_ARGS__]);
#else
#define LOG(...)
#endif
```

åˆ©ç”¨ä¾‹ï¼š

```objc
LOG(@"test");
```

å‡ºåŠ›ï¼š

[Time] [App Name] [Build Configuration] [File Name + Method] [Line Number] log 

```shell-session
2017-11-27 09:35:19.099 AppName[59272:2201737] DEBUG: -[ClassName method]:330: test
```

### 4. TODO&FIX çš„å®å®šä¹‰ï¼š

å‚è€ƒè‡ª [todo-macro](http://blog.sunnyxx.com/2015/03/01/todo-macro/)ï¼Œå¾ˆæœ‰æ„æ€çš„ä¸€ç¯‡æ–‡ç« ï¼Œé€šè¿‡å®å®šä¹‰å°† `#pragma message ("msg")` è¿›è¡Œæ‰©å±•è€Œä½œä¸º TODO ä½¿ç”¨ï¼š

```objc
#define STRINGIFY(S) #S
#define DEFER_STRINGIFY(S) STRINGIFY(S)
#define PRAGMA_MESSAGE(MSG) _Pragma(STRINGIFY(message(MSG)))
#define FORMATTED_MESSAGE(MSG) "[TODO-" DEFER_STRINGIFY(__COUNTER__) "]" MSG " Line:" DEFER_STRINGIFY(__LINE__)

#define TODO(MSG) PRAGMA_MESSAGE(FORMATTED_MESSAGE(MSG))
```

åˆ©ç”¨ä¾‹ï¼š

```objc
@TODO("test code 1")
@TODO("test code 2")
```

## æ‚è°ˆ

å½“è¦ä½¿ç”¨å®æ—¶ï¼ŒåŠ¡å¿…è¦è€ƒè™‘æœ‰æ²¡æœ‰å¿…è¦ï¼Œåˆä¸åˆç†ï¼Œä¼šä¸ä¼šæœ‰å‰¯ä½œç”¨ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼šå½“éœ€è¦å®šä¹‰ä¸€ä¸ªå¸¸é‡æ—¶ï¼Œå®å®Œå…¨å¯ä»¥ï¼Œä½†æ˜¯æ›´å¥½çš„é€‰æ‹©æ˜¯ä½¿ç”¨ `const` å…³é”®å­—ã€‚å€ŸåŠ©å®æ¥å®šä¹‰å¸¸é‡æœ€å¤§çš„ç—›ç‚¹å°±æ˜¯ä¸åŒ…å«ç±»å‹ä¿¡æ¯ï¼Œ`const` ä¸ä»…å¼¥è¡¥äº†ç±»å‹ä¿¡æ¯ç¼ºå¤±çš„é—®é¢˜ï¼Œè€Œä¸”åœ¨è®¿é—®æ§åˆ¶æƒé™è¿™å—ä¹Ÿè¡¨ç°åœ°æ›´å¥½ã€‚

æœ€åè¿˜æƒ³æä¸€å¥ `typedef`ï¼Œäººä»¬å¸¸å¸¸ä¼šæ‹¿å®ƒå’Œ `#define` ç›¸æ¯”è¾ƒï¼Œçœ‹èµ·æ¥ç”¨æ³•å¾ˆç›¸ä¼¼ï¼Œå…¶å®æœ¬è´¨ä¸Šæœ‰è›®å¤§åŒºåˆ«ï¼Œ`typedef` æ˜¯åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œå¤„ç†çš„å…³é”®å­—ã€‚ç”¨é€”ä¸Šæ¥è¯´ï¼Œ`typedef` æ›´å¤šæ˜¯ç”¨äºåˆ›å»ºç±»å‹åˆ«åï¼Œä¸Šè¿° Enum çš„å®å®šä¹‰ä¸­ä¸ºæšä¸¾æŒ‡å®šåˆ«åå°±ä¾èµ–äº `typedef`ã€‚























]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/Storyboard-%E4%B8%8E-Xib-%E7%9A%84%E2%80%9C%E6%8A%89%E6%8B%A9%E2%80%9D</guid><title>Storyboard å’Œ Xib çš„â€œæŠ‰æ‹©â€</title><description>æ¯”èµ·æ‰‹å†™ UIï¼Œâ€œæ‹–æ§ä»¶â€çš„ Storyboard å’Œ Xib ä¼¼ä¹ä¸€ç›´éƒ½æ›´æŠ•æˆ‘æ‰€å¥½ã€‚ä¸è¿‡å³ä½¿æ˜¯ Storyboard å’Œ Xib ä¹‹é—´ï¼Œä¼¼ä¹ä¹Ÿè¿˜æ˜¯å¤šå¤šå°‘å°‘æœ‰ä¸€äº›çº·äº‰ã€‚</description><link>ckitakishi.com/posts/Storyboard-%E4%B8%8E-Xib-%E7%9A%84%E2%80%9C%E6%8A%89%E6%8B%A9%E2%80%9D</link><pubDate>Sun, 24 Sep 2017 22:33:00 +0900</pubDate><content:encoded><![CDATA[<blockquote><p>è¿‘æœŸå¼€å§‹è¿›è¡Œä¸€ä¸ªæ–°é¡¹ç›®çš„åŸå‹åˆ¶ä½œåŠå…¶ç»“æ„è®¾è®¡ï¼Œæ‰“ç®—æŠŠä¸€äº›å¿ƒè·¯å†ç¨‹è®°å½•ä¸‹æ¥ï¼Œéšä¾¿å…ˆç»™å®ƒå–ä¸ªåå­—å«åšï¼š<strong>P-OOP</strong>ã€‚</p></blockquote><h1>Storyboard å’Œ Xib çš„â€œæŠ‰æ‹©â€</h1><p>æ¯”èµ·æ‰‹å†™ UIï¼Œâ€œæ‹–æ§ä»¶â€çš„ Storyboard å’Œ Xib ä¼¼ä¹ä¸€ç›´éƒ½æ›´æŠ•æˆ‘æ‰€å¥½ã€‚ä¸è¿‡å³ä½¿æ˜¯ Storyboard å’Œ Xib ä¹‹é—´ï¼Œä¼¼ä¹ä¹Ÿè¿˜æ˜¯å¤šå¤šå°‘å°‘æœ‰ä¸€äº›çº·äº‰ã€‚</p><h2>Storyboard &amp; Xib</h2><p>å…¬å¸ (å¹´ä¹…å¤±ä¿®) çš„ iOS Guidelines ä¸­å†™ç€ä¸€å¥è¯ï¼š</p><blockquote><p>è¿›è¡Œæºç ç®¡ç†æ—¶ Storyboard ææ˜“å¯¼è‡´å†²çªï¼Œå›¢é˜Ÿå¼€å‘æ—¶ï¼Œå„ç”»é¢ä¸å„ç»„ä»¶å°½å¯èƒ½ä½¿ç”¨ Xib è¿›è¡Œå®ç°ã€‚</p></blockquote><p>å¯¹æ­¤æˆ‘ä¸€ç›´æŠ±ç€èµå¦ä¸¤è®ºçš„è§‚ç‚¹ã€‚åœ¨å®é™…å·¥ä½œæ—¶ï¼ŒåŒä¸€ Storyboard ä¸­å­˜åœ¨å¤§é‡ ViewController ååˆ†å®¹æ˜“å†²çªæ˜¯ä¸€ä¸ªä¸äº‰çš„äº‹å®ï¼Œæ‰è¿›è¿™ä¸ªå‘çš„äººæœ‰å¯èƒ½è¿˜è¿›è¡Œè¿‡ xml ä¿®æ­£ã€‚ä½†æ˜¯è¿™ä¸ªé”… Storyboard ä¸èƒŒã€‚ä¸€éƒ¨åˆ†äººå¯èƒ½å› æ­¤é€‰æ‹©äº†å¼ƒ Storyboard ä» Xib ä¹‹è·¯ï¼Œæˆ‘ä¹Ÿä¸€åº¦å¾˜å¾Šæ˜¯å¦è¿™æ‰æ˜¯æ­£é“ã€‚ä½†æ˜¯å¾ˆæ˜¾ç„¶çš„æ˜¯ï¼ŒStoryboard ä»ä¸€å¼€å§‹å°±ä¸æ˜¯ä¸ºäº†ä»£æ›¿ Xib è€Œæ¥ã€‚</p><p>é™¤äº† UI è®¾ç½®çš„ç›¸ä¼¼éƒ¨åˆ†ä»¥å¤–ï¼ŒStoryboard æ›´é‡è§†ç”»é¢ä¹‹é—´çš„å…³è”å’Œè¿ç§»ï¼Œè€Œ Xib ä½œä¸ºé€šç”¨ç»„ä»¶çš„æ¨¡ç‰ˆåº”è¯¥æ˜¯ä¸äºŒçš„é€‰æ‹©ã€‚</p><!--more-->

åœ¨ P-OOP ä¸­ï¼Œå°†ä¼šå­˜åœ¨å¤§é‡çš„ dialogï¼Œå°½ç®¡å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨ Present Modally æ¥å®ç°ï¼Œä¸è¿‡ä¸ºäº†ä¿æŒç³»åˆ—äº§å“çš„é£æ ¼ä¸€è‡´æ€§ï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•ä»¥æ¯”è¾ƒå¥½çš„æ–¹å¼æ¥å®ç°å…±é€šçš„ header å’Œ footer æ ·å¼ã€‚è€ƒè™‘è¿‡å¾ˆå¤šæ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼š

1. å°† footer å’Œ header é›†æˆåœ¨åŒä¸€ä¸ª view ä¸­ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª content viewï¼Œæœ€ç»ˆåœ¨æŸ controlelr view ä¸­å°†ä¸Šè¿° view ä¸å®é™…ä»å¦ä¸€ä¸ª xib ä¸­è½½å…¥çš„ content view ç»„åˆï¼Œå®Œæˆç»„è£…ã€‚ä½†æ˜¯å­˜åœ¨ä¸€ä¸ªæ¯”è¾ƒæ˜¾è‘—çš„ç¼ºç‚¹ï¼Œå®é™…å¯è§çš„ controller view æ‰€å‘ˆç°çš„å†…å®¹å¹¶ä¸æ˜¯å¾ˆç›´è§‚ï¼Œæœç„¶è¿˜æ˜¯å¿…é¡»çœ‹ä»£ç æ‰èƒ½æ¢³ç†æ¸…æ¥šã€‚ 
2. å°† footer å’Œ header ä»¥åŠä¸€ä¸ª content view é›†æˆåœ¨åŒä¸€ä¸ª controller view ä¸­ã€‚åœ¨ä»£ç ä¸­æŒ‰ç…§è¦æ±‚è½½å…¥ contentï¼Œä»£ç†æ–¹æ³•ä¹‹ç±»å˜å¾—å®¹æ˜“ç®¡ç†äº†ä¸€äº›ï¼Œä½†æ˜¯æ›´ç³Ÿç³•çš„æ˜¯è¿™ä¸ª controller çš„ä»£ç ç»ˆå°†æˆä¸ºåƒåœ¾åœºçš„ã€‚ã€‚ã€‚é‚£åŠ å…¥ç»§æ‰¿å‘¢ï¼Ÿæœ‰äº›å°é¢˜å¤§åšï¼Ÿ

æœç„¶ç®€æ´æ‰æ˜¯æœ€é«˜çš„ï¼Œå°† footer å’Œ header å®Œå…¨ç‹¬ç«‹ä¸ºä¸¤ä¸ª viewï¼ŒæŒ‰éœ€è½½å…¥ã€‚ç»“åˆ @IBInspectable å’Œ @IBDesignable å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå®Œç¾äº†ï¼Œä»ç”»é¢è®¾è®¡åˆ°è¿ç§»ç­‰éƒ½å¾ˆæ¸…æ™°ã€‚ä¸è¶³ä¸€æçš„å°ç¼ºç‚¹æ˜¯ä½¿ç”¨æ—¶å€™çš„ auto layout çš„è®¾ç½®å¯èƒ½å­˜åœ¨ä¸€äº›é‡å¤æ“ä½œ (æ¯”å¦‚ Auto Layout ä¹‹ç±»çš„)ï¼Œè‹¥è€ƒè™‘ Model é™¤äº† form sheet ä»¥å¤–å¯ä»¥æ˜¯ full screenï¼Œåè€…éœ€è¦åœ¨é¡¶éƒ¨é¢å¤–é¢„ç•™ 20pxï¼Œè¿™æ ·ä¸€æ¥åè€Œå˜å¾—å·§å¦™äº†ã€‚

ä¹Ÿè®¸è¿‡å‡ å¤©è‡ªå·±çš„æƒ³æ³•åˆå‘ç”Ÿäº†ç»†å¾®å˜åŒ–ï¼Œä½†ç®€æ´æ¸…æ™°æ— è®ºä½•æ—¶éƒ½ä¸ä¼šå¤ªåã€‚

## å¿ƒå¾—

### Storyboard Reference

Storyboard å®¹æ˜“å¼•å‘å†²çªï¼Œè¿™å¥è¯åœ¨ Storyboard Reference é¢å‰æ˜¯ä¸æˆç«‹çš„ã€‚

**Storyboard Reference** ç¬¬ä¸€æ¬¡å‡ºç°åœ¨ Xcode 7ï¼Œå¯ä»¥ä»ç»„ä»¶åº“ä¸­æ‰¾åˆ°å®ƒï¼Œå¹¶è‡ªè¡Œè¿›è¡Œé…ç½®å’Œå…³è”ï¼Œååˆ†ç®€å•ï¼Œæ— éœ€èµ˜è¿°ã€‚å³ä½¿æ˜¯ä¸€ä¸ªå·²ç»å®Œæˆä¸”ååˆ†ç¹æ‚çš„ Storyboardï¼Œä¹Ÿå¯ä»¥é€‰ä¸­æƒ³è¦åˆ†ç¦»çš„ Storyboardï¼Œé€šè¿‡ **Editor -> Refactor to Storyboard** æ¥å®ç°ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨äº†ä¸¤ä¸ª Container Viewï¼Œé»˜è®¤æƒ…å†µä¸‹æ­¤æ—¶ç”»é¢ä¸­å­˜åœ¨ä¸‰ä¸ª controllerï¼Œå¯¹å…¶è¿›è¡Œåˆ†ç¦»ä¹‹åï¼Œå˜æˆäº†è¿™æ ·ï¼š

![Storyboard Reference](/images/Storyboard_reference.png)

### Loadable Nib

å°† Xib ç»„ä»¶çš„è½½å…¥åè®®åŒ–ï¼Œå…¶ä¸­ä¸€ä¸ªç›®çš„æ˜¯ä¸ºäº†ç±»å‹å®‰å…¨ï¼Œå¦ä¸€ä¸ªç›®çš„æ˜¯ä¸ºäº†å‡å°‘é‡å¤ä»£ç ã€‚

```swift
protocol Loadable: class {
    static var nibName: String { get }
}

extension Loadable {
    static var nibName: String { return String(describing: Self.self) }
}
```

å¯¹ `UIView` è¿›è¡Œæ‰©å±•ï¼Œè¦æ±‚è¢«è½½å…¥çš„ view éµå¾ª `Loadable` åè®®ï¼š

```swift
extension UIView {
    func instantiateFromNib<T: UIView>(_:T.Type) -> T where T: Loadable {
        if let nib = UINib(nibName: T.nibName, bundle: nil).instantiate(withOwner: nil, options: nil).first as? T {
            return nib
        } else {
            fatalError("Nib \(T.nibName) is not exist ?!")
        }
    }
    
    func instantiateFromNibOwner<T: UIView>(_:T.Type) where T: Loadable {
        let bundle = Bundle(for: type(of: self))
        if let nib = UINib(nibName: T.nibName, bundle: bundle).instantiate(withOwner: self, options: nil).first as? UIView {
            nib.frame = self.bounds
            nib.autoresizingMask = [.flexibleWidth, .flexibleHeight]
            self.addSubview(nib)
        } else {
            fatalError("Nib \(T.nibName) is not exist ?!")
        }
    }
}
```

ç®€æ´çš„åˆå§‹åŒ–ï¼š

```swift
let view:ClassName = self.instantiateFromNib(ClassName.self)
self.instantiateFromNibOwner(ClassName.self)
```

åæ¥å‘ç°ä¸€ä¸ªåä¸º [Reusable](https://github.com/AliSoftware/Reusable) çš„åº“ï¼Œå…¶ä¸­é™¤äº†è¿™ä¸€éƒ¨åˆ†çš„å®ç°ä¹‹å¤–ï¼Œè¿˜æœ‰å¯¹ Cell ç”šè‡³æ˜¯ Storyboard å’Œ ViewController çš„é‡ç”¨ï¼Œååˆ†å¼ºå¤§ã€‚

å›åˆ°è¿™ä¸€éƒ¨åˆ†çš„å®ç°ï¼Œç•¥æœ‰åŒºåˆ«çš„åœ°æ–¹åœ¨äºï¼š

1. *Reusable* åœ¨åˆå§‹åŒ– nib çš„æ—¶å€™é€‰æ‹©äº†æ‰©å±•åè®®ã€‚
2. åœ¨ *File's Owner* çš„æƒ…å†µä¸‹ï¼Œ*Reusable* ä½¿ç”¨äº† Auto Layoutã€‚ç”±äºæˆ‘ä»¬çš„ **P-OOP** é¡¹ç›®å¯¹åº”çš„è®¾å¤‡å°ºå¯¸ä¸å¤šï¼Œæ‰€ä»¥åƒæ˜¯éƒ¨åˆ†å¼¹å‡ºæ¡†å°±æ²¡æœ‰å¯¹åº” Auto Layoutï¼Œæ‰€ä»¥å°±ç›´æ¥ä» frame çš„å°ºå¯¸ä¸‹æ‰‹äº†ã€‚ã€‚

> è¿½è®°ï¼šæŠŠè¿™éƒ¨åˆ†å®ç°å’Œä¾‹å­æäº†å‡ºæ¥æ”¾åœ¨äº† [Github](https://github.com/Ckitakishi/LoadableNib) ä¸Šï½

### @IBDesignable å’Œ @IBInspectable

**@IBDesignable** å¯ä»¥ç”¨äºè§†å›¾çš„å®æ—¶æ¸²æŸ“ï¼Œ**@IBInspectable** å¯ä»¥ç”¨äºå®šä¹‰è¿è¡Œæ—¶å±æ€§ã€‚

ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼šé¦–å…ˆåœ¨å®šä¹‰ä¸€ä¸ª `DialogHeaderView`ï¼Œæ ‡è®°ä¸º `@IBDesignable`ï¼Œå°†å®ƒçš„ `headerTitle` å±æ€§è®¾ç½®ä¸º `@IBInspectable`ï¼š

```swift
@IBDesignable class DialogHeaderView: UIView {

    @IBInspectable var headerTitle: String = "" {
        didSet {
            navigationBar.topItem?.title = self.headerTitle
        }
    }
    ...   
}
```

ç„¶åå‘ç›®æ ‡è§†å›¾æ·»åŠ ä¸€ä¸ª UIViewï¼Œå¹¶å°†ç±»å®šä¹‰ä¸º `DialogHeaderView`ï¼Œæ­¤æ—¶åœ¨ *Attribuite Inspector* ä¸­å¯ä»¥ç›´æ¥è®¾ç½®å±æ€§ï¼š

![IB1](/images/IB1.png)

ä¹‹åå³ä¼šåæ˜ åœ¨è¿è¡Œæ—¶å±æ€§æ ä¸­ï¼š

![IB2](/images/IB2.png)

ä¸è¿‡æ„å»ºå¤±è´¥çš„æ—¶å€™è¿˜æ˜¯æŒºå¤šçš„ï¼Œä¸å¦¨é€šè¿‡ **Editor -> Debug Selected Views** æ¥è°ƒè¯•ä¸€ä¸‹é€‰ä¸­çš„è§†å›¾ã€‚

### ç±»å‹å®‰å…¨

é™¤äº†å®šä¹‰ä¸Šé¢çš„ `Loadable` åè®®ï¼Œåœ¨ç±»å‹å®‰å…¨è¿™ä¸ªé—®é¢˜ä¸Šè¿˜å¯ä»¥è¿›ä¸€æ­¥å†åšä¸€äº›å·¥ä½œã€‚

å­˜åœ¨ Storyboardï¼ŒSegue çš„å®šä¹‰ä¹Ÿå°±ä¼šæœ‰å­˜åœ¨ï¼Œç”±äº identifier çš„å®šä¹‰æ˜¯å­—ç¬¦ä¸²ï¼Œé˜²ä¸èƒœé˜²ï¼Œä¸åŒ¹é…çš„æƒ…å†µè¿˜æ˜¯ä¼šæ—¶è€Œå‘ç”Ÿã€‚è¿™æ—¶å€™ä½¿ç”¨ [R.swift](https://github.com/mac-cain13/R.swift) å°±èƒ½å¤Ÿå®Œå…¨è§£æ¶ˆè¿™ä¸ªæ‹…å¿§äº†ã€‚

*R.swift* è¢«å¹¿æ³›ä½¿ç”¨äºè§£å†³ç±»å‹å®‰å…¨çš„é—®é¢˜ï¼Œå›¾ç‰‡ã€å­—ä½“ã€æœ¬åœ°åŒ–ç­‰ç­‰éƒ½å—ç›Šäºæ­¤ã€‚



]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/viewWillAppear-%E6%9D%82%E8%B0%88</guid><title>viewWillAppear æ‚è°ˆ</title><description>ç»†è¯´å¯¹ `viewWillAppear` çš„å¸¸è§è¯¯è§£ä¹‹ä¸€</description><link>ckitakishi.com/posts/viewWillAppear-%E6%9D%82%E8%B0%88</link><pubDate>Wed, 26 Jul 2017 23:48:00 +0900</pubDate><content:encoded><![CDATA[<h1>viewWillAppear æ‚è°ˆ</h1><p>ä½œä¸º view çš„çŠ¶æ€ä¹‹ä¸€ï¼Œ<code>viewWillAppear</code> çš„å…³æ³¨ç‡æé«˜ï¼Œæ‰€ä»¥å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„...æˆ‘ä»¬éƒ½çŸ¥é“å®ƒä¼šåœ¨ view æ¯ä¸€æ¬¡å°†è¦å‡†å¤‡å‡ºç°ä¹‹å‰è¢«è°ƒç”¨ï¼Œæ‰€ä»¥å¸¸å¸¸å¯ä»¥ç”¨æ¥åˆå§‹åŒ–ä¸€äº›åŸºæœ¬æ•°æ®ã€‚</p><p>å‰ä¸¤å‘¨èŠ±äº†ä¸€ç‚¹ç‚¹æ—¶é—´é‡æ„äº†ç»„é‡Œçš„æŸä¸ªå°åº”ç”¨ï¼Œå‰å¼€å‘è€…æ–°æ‰‹ä¸Šè·¯ï¼Œæ„Ÿè§‰ä¸å°‘ä»£ç å€¼å¾—æ¨æ•²ã€‚åœ¨ debug çš„æ—¶å€™å‘ç°åº”ç”¨ä¸€åˆ°åå°å°±è‡ªåŠ¨é€€å‡ºäº†ï¼Œæ ¹æœ¬æ— æ³•çœ‹å®ƒåœ¨åå°çš„æ´»åŠ¨ï¼Œéœ‡æƒŠä¹‹ä½™å‘ç° info.plist çš„ <code>Application does not run in background</code> è¢«è®¾ç½®ä¸ºäº† <code>YES</code>...åå¤æ£æ‘©æ•´ä¸ªåº”ç”¨çš„åŠŸèƒ½ä¹Ÿä¸çŸ¥é“è¿™ä¹ˆåšç›®çš„ä½•åœ¨ï¼Œäºæ˜¯æœæ–­å°†å…¶æ”¹ä¸ºäº† <code>NO</code>ã€‚</p><p>ä¸è¿‡äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€æ®µå…³äº viewWillAppear çš„æ‚è°ˆã€‚</p><!--more-->

åæ¥éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ€»ç®—å‘ç°ç¦æ­¢åå°è¿è¡Œçš„â€œç”¨å¤„â€äº†ã€‚æŸä¸ª view æœ‰ä¸€ä¸ªç›¸å¯¹ç‰¹æ®Šçš„éœ€æ±‚ï¼Œåº”ç”¨ä»åå°å›åˆ°å‰å°æ—¶éœ€è¦é‡æ–°åˆå§‹åŒ–å®ƒçš„æ•°æ®ï¼Œå°½ç®¡åœ¨ `viewWillAppear` ä¸­å‡†å¤‡äº†å®Œå¤‡çš„åˆå§‹åŒ–ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªçŠ¶æ€çš„è¿ç§»å¹¶ä¸èƒ½è®¤ä¸ºæ˜¯ view å³å°†å‡ºç°ï¼Œæ¯•ç«Ÿ view å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œä¸€ç›´éƒ½æ˜¯æ˜¾ç¤ºçŠ¶æ€ã€‚æ‰€ä»¥è‡ªç„¶ `viewWillAppear` å°±ä¸ä¼šè¢«è°ƒç”¨ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯è¿™ä½åŒå­¦æƒ³äº†è¿™ä¸ªåŠæ³•ã€‚

ä¸å¾—ä¸æ‰¿è®¤è¿™ä¸ªæ€è·¯è¿˜æ˜¯å¾ˆæ¸…å¥‡çš„ï¼Œä½†æ˜¯ä¸ºäº†é¿å…ä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ï¼Œæˆ‘è¿˜æ˜¯å†³å®šæ”¹ç”¨å¸¸è§„è§£å†³æ–¹æ¡ˆã€‚åœ¨åº”ç”¨é‡å›å‰å°çš„æ—¶å€™å‘ä¸€ä¸ªé€šçŸ¥ï¼Œå‘Šè¯‰ view å¯ä»¥é‡æ–°åˆå§‹åŒ–æ•°æ®äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ `viewWillAppear` ä¸­æ·»åŠ ä¸€ä¸ªå¯¹ `.UIApplicationWillEnterForeground` é€šçŸ¥çš„è§‚å¯Ÿåº”è¯¥æ˜¯ä¸€ä¸ªä¸äºŒçš„é€‰æ‹©ï¼Œå®ƒä¹Ÿå¸¸å¸¸è¢«ç”¨äºå¤„ç†åƒæ˜¯ç”µè¯å¼ºåˆ¶ä¸­æ–­ä¹‹ç±»çš„éœ€æ±‚ï¼š

``` swift
NotificationCenter.default.addObserver(self, selector: #selector(willEnterForeground), name: .UIApplicationWillEnterForeground, object: nil)
```

è¿™ä¸ªæ–¹æ¡ˆå¯æ˜¯è¯´æ˜¯æ¯”è¾ƒä¼˜é›…çš„ï¼Œä¸è¿‡ä¸å¯ä»¥å¿˜è®°ç§»é™¤é€šçŸ¥ã€‚å…³äºå£°æ˜å‘¨æœŸè¿™äº›äº‹å„¿ï¼Œæœ‰æ—¶å€™çœŸæ˜¯æ“ç¢äº†å¿ƒ~





]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/Thread-Sanitizer</guid><title>Thread Sanitizer</title><description>ä½¿ç”¨ Thread Sanitizer æ¥è§£å†³å®é™…é‡åˆ°çš„æ•°æ®ç«äº‰é—®é¢˜ã€‚</description><link>ckitakishi.com/posts/Thread-Sanitizer</link><pubDate>Sat, 13 May 2017 14:39:00 +0900</pubDate><content:encoded><![CDATA[<h1>Thread Sanitizer</h1><p><em>ä½œä¸ºä¸€é¡¹æƒ¯ä¾‹ï¼Œå‘¨äº”æ—©æ™¨ï¼Œç»„å†…æ¯ä¸ªäººéƒ½è¦è¿›è¡Œä¸‰åˆ†é’Ÿçš„ LTï¼Œå°†è‡ªå·±æ„Ÿå…´è¶£çš„è¯é¢˜åˆ†äº«ç»™å¤§å®¶ã€‚</em></p><p>ä¹‹å‰åœ¨ä¿®æ­£å¹¶ä¼˜åŒ–åº”ç”¨å†…çº¿ç¨‹ç®¡ç†çš„æ—¶å€™ç”¨äº† <strong>Thread Sanitizer</strong> åŠŸèƒ½ï¼Œäºæ˜¯ä»¥æ­¤ä¸ºæœºç»™å¤§å®¶ç®€å•ä»‹ç»äº†ä¸€ä¸‹ã€‚æ›´å¤šè¯¦ç»†çš„å†…å®¹ï¼Œå¯ä»¥çœ‹ä¸€çœ‹ 2016 WWDC çš„ <a href="https://developer.apple.com/videos/play/wwdc2016/412/">Session 412</a>ã€‚çº¿ç¨‹é—®é¢˜å‘ç”Ÿçš„æ—¶å€™ä¸€èˆ¬è¿˜æ˜¯æŒºç„¦è™‘çš„ï¼Œå› ä¸ºæ—¶é—´æ•æ„Ÿï¼Œæœ‰æ—¶å€™å†ç°å¾ˆå›°éš¾ï¼Œè‡ªç„¶å°±ä¸æ˜“è°ƒé€‚ã€‚<strong>TSan</strong> èƒ½å¤Ÿå‘ç°ä¸€äº›é—®é¢˜ï¼Œè¯¸å¦‚ Keynote é‡Œæåˆ°çš„ï¼š</p><blockquote><p>Use of uninitialized mutexesThread leaks (missing pthred_join)Unsafe calls in signal handlers (ex:malloc)Unlock from wrong threadData races</p></blockquote><p>å› ä¸ºåœ¨å®é™…ä¸­é‡åˆ°è¿‡ï¼Œè€Œä¸”æ„Ÿè§‰å‘ç”Ÿæ¦‚ç‡ç›¸å¯¹è¾ƒé«˜ï¼Œæ‰€ä»¥åªå±•å¼€è¯´ä¸€ä¸‹æœ€åä¸€é¡¹ï¼šæ•°æ®ç«äº‰ã€‚æ•°æ®ç«äº‰å‘ç”Ÿçš„åŸºæœ¬æ¡ä»¶æ˜¯å¤šä¸ªçº¿ç¨‹åœ¨åŒæ—¶è®¿é—®åŒä¸€å—å†…å­˜ï¼Œå¹¶ä¸”å…¶ä¸­è‡³å°‘åˆä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¿›è¡Œçš„æ˜¯å†™æ“ä½œã€‚å®é™…ä¸­å¸¸å¸¸è¡¨ç°ä¸ºæ•°æ®ä¸æ•´åˆï¼Œäº¦æˆ–æ˜¯åº”ç”¨å´©æºƒã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><!--more-->

```Objective-C
[context performBlock:^{
    if (result && context) {
        result = [self persistentSaveContext:context]; // 1
    }
}];
return result; // 2
```

`result` åœ¨ 1 å’Œ 2 ä¸¤ä¸ªåœ°æ–¹å‘ç”Ÿäº†ç«äº‰ã€‚åœ¨ 1 è¿›è¡Œå†™æ“ä½œä¹‹å‰ï¼Œæœ‰å¯èƒ½å¤„äºä¸åŒçº¿ç¨‹çš„ 2 æ—©å·²ç»è¿”å›äº†ï¼Œè¿™æ ·æ•°æ®å°±å‘ç”Ÿäº†ä¸æ•´åˆã€‚

æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼šç”±å¼‚æ­¥æ“ä½œå˜ä¸ºåŒæ­¥æ“ä½œï¼Œæˆ–æ˜¯æ”¹å˜å†™æ“ä½œçš„æ—¶é—´ç‚¹ã€‚è¿™é‡Œé‡‡å–äº†ç¬¬ä¸€ä¸ªæ–¹æ¡ˆï¼Œä½¿ç”¨åŒæ ·ç”¨é€”çš„åŒæ­¥æ–¹æ³• `performBlockAndWait` æ¥å–ä»£ `performBlock`ï¼Œè¿™æ ·ä»¥æ¥ï¼Œæ•°æ®ç«äº‰çš„é—®é¢˜ä¹Ÿå°±è‡ªç„¶è€Œç„¶è§£å†³äº†ã€‚ 

```Objective-C
[context performBlockAndWait:^{
    if (result && context) {
        result = [self persistentSaveContext:context]; // 1
    }
}];
return result; // 2
```

ç”±äº **TSan** æ˜¯ç»Ÿåˆåœ¨ç¼–è¯‘å™¨ (Clang) å±‚é¢çš„ï¼Œæ‰€ä»¥å½“ä½¿ç”¨ Swift æ¥ç¼–å†™æœåŠ¡å™¨ä»£ç çš„æ—¶å€™ï¼Œå®Œå…¨å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨å®ƒï¼š

![Tsan command](/images/datarace.png)

P.S.ç›®å‰ **TSan** åªæ”¯æŒ 64bit çš„æ¨¡æ‹Ÿå™¨åŠ macOS è‡ªèº«ã€‚


]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/Swift-App-%E4%B8%80%E4%B8%AA%E6%84%8F%E6%96%99%E4%B9%8B%E5%A4%96%E7%9A%84%E5%B4%A9%E6%BA%83%E7%90%86%E7%94%B1</guid><title>Swift App: ä¸€ä¸ªæ„æ–™ä¹‹å¤–çš„å´©æºƒç†ç”±</title><description>åº”ç”¨åŠŸèƒ½æœ¬èº«ååˆ†ç®€å•ï¼Œå¼€å‘æµ‹è¯•é˜¶æ®µä¹Ÿæ¯”è¾ƒé¡ºåˆ©ï¼Œå‡ ä¹æ²¡æœ‰å‘ç”Ÿå´©æºƒã€‚ç„¶è€Œåœ¨æ›´æ›¿è¯ä¹¦ä¹‹åï¼ŒçœŸæœºæµ‹è¯•åº”ç”¨æ—¶å´é™·å…¥äº†æ— é™å´©æºƒçš„å¢ƒåœ°ã€‚</description><link>ckitakishi.com/posts/Swift-App-%E4%B8%80%E4%B8%AA%E6%84%8F%E6%96%99%E4%B9%8B%E5%A4%96%E7%9A%84%E5%B4%A9%E6%BA%83%E7%90%8 ... E7%94%B1</link><pubDate>Mon, 13 Feb 2017 23:10:00 +0900</pubDate><content:encoded><![CDATA[<h1>Swift App: ä¸€ä¸ªæ„æ–™ä¹‹å¤–çš„å´©æºƒç†ç”±</h1><p>è¿™æ˜¯ä¸€ä¸ªå‘ç”Ÿåœ¨å»å¹´å¹´åº•çš„æ•…äº‹ã€‚èƒŒæ™¯æ˜¯ä¸€ä¸ªæ–°è§„ Swift åº”ç”¨å¤„äºå‡†å¤‡å‘å¸ƒé˜¶æ®µï¼Œè¯ä¹¦ç”±å¼€å‘æµ‹è¯•ç”¨æ›´æ›¿ä¸ºå‘å¸ƒç”¨ï¼Œ è¿™æ˜¯ä¸¤ä»½ Team ä¸åŒçš„ä¼ä¸šç‰ˆè¯ä¹¦ã€‚</p><p>åº”ç”¨åŠŸèƒ½æœ¬èº«ååˆ†ç®€å•ï¼Œå¼€å‘æµ‹è¯•é˜¶æ®µä¹Ÿæ¯”è¾ƒé¡ºåˆ©ï¼Œå‡ ä¹æ²¡æœ‰å‘ç”Ÿå´©æºƒã€‚ç„¶è€Œåœ¨æ›´æ›¿è¯ä¹¦ä¹‹åï¼ŒçœŸæœºæµ‹è¯•åº”ç”¨æ—¶å´é™·å…¥äº†æ— é™å´©æºƒçš„å¢ƒåœ°ã€‚</p><!--more-->

Log ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š

```
dyld: Library not loaded: @rpath/libswiftCore.dylib
  Referenced from: ...
  Reason: no suitable image found.  Did find:
  ...
```

æœ‰å¾ˆå¤šåŸå› ä¼šå¯¼è‡´æç¤ºè¿™ä¸ªé”™è¯¯ï¼Œä½œä¸º Trouble Shooting è®°å½•ä¸‹æ¥ï¼š

- å¯èƒ½å­˜åœ¨ç¼“å­˜ï¼Œ**Clean** å·¥ç¨‹
- å¾ˆå¤šæ—¶å€™è¯¥é—®é¢˜å‘ç”Ÿåœ¨ Swift ä¸ Objective-C æ··ç¼–çš„æ—¶å€™ï¼Œæ‰€ä»¥éœ€è¦æ£€æŸ¥ *Building Setting* ä¸­ *Embeedded Content Contains Swift Code* çš„è®¾ç½®æ˜¯å¦å·²ç»ä¸º **YES**ã€‚
- ä¾ç„¶æ˜¯é…ç½®ï¼Œæ£€æŸ¥ *Building Setting* ä¸­çš„ *Runpath Search Paths* æ˜¯å¦åˆé€‚ï¼Œé€šå¸¸æ˜¯ï¼š**@executable_path/Frameworks**ã€‚
- é‡ç½®è¯ä¹¦ (æ³¨é”€å†æ–°å»º) ã€‚

å®é™…çš„ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆ check äº†å‰ä¸‰é¡¹ï¼Œæœ€ç»ˆå¼ºçƒˆæ€€ç–‘æ˜¯è¯ä¹¦é—®é¢˜ã€‚å…³äº â€œlibswiftCore.dylib å´©æºƒâ€œè¿™ä¸ªè¯é¢˜ï¼Œå¾ˆå®¹æ˜“èƒ½çœ‹åˆ°è¿™ç¯‡ [Q&A](https://developer.apple.com/library/content/qa/qa1886/_index.html)ï¼Œå…¶ä¸­æåˆ°è¦è¿è¡Œ Swift åº”ç”¨å¿…é¡»ä½¿ç”¨ iOS 8 Released ä¹‹ååˆ›å»ºçš„è¯ä¹¦ã€‚å¯¹æ¯”æ‰‹ä¸­çš„ä¸¤ä»½è¯ä¹¦ï¼Œé™¤äº† Team ä¸åŒä¹‹å¤–ï¼Œæœ€å¤§çš„å·®åˆ«åœ¨äºåˆ›å»ºæ—¶é—´ï¼Œåˆ†åˆ«ä¸º 2016 å¹´å¤å¤©ï¼Œå’Œ 2014 å¹´å¤å¤©ã€‚æ‰€ä»¥æ›´æ–°è¯ä¹¦ä¹‹åï¼Œé—®é¢˜ä¹Ÿå¹¸è¿åœ°è§£å†³äº†ã€‚

å…³äº libswiftCore.dylib æ–‡ä»¶è¿˜æƒ³å†å¤šè¯´å‡ å¥ï¼Œçœ‹åå­—å°±èƒ½å¤ŸçŒœåˆ°æ˜¯ Swift åŠ¨æ€åº“ï¼Œå…·ä½“è¯´æ¥å®ƒå…¶å®æ˜¯ Swift çš„è¿è¡Œæ—¶åº“ï¼Œä½†æ˜¯è¯¥æ–‡ä»¶å’Œè¯ä¹¦æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼ŸåŸå› åœ¨äºç›®å‰ Swift çš„ç‰ˆæœ¬å‡çº§è¿˜ä¸ç¨³å®šï¼Œå¦‚æœå°†è¿™äº›è¿è¡Œæ—¶åº“ç›´æ¥æ”¾åˆ°ç³»ç»Ÿä¸­ï¼Œå¾ˆå¯èƒ½ä¼šå¯¼è‡´æ¯æ¬¡ Swift å‡çº§éƒ½å¯¼è‡´åº”ç”¨ä¸å†èƒ½å¤Ÿä½¿ç”¨ï¼Œè€Œä½œä¸ºè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼ŒApple é€‰æ‹©å°†è¿è¡Œæ—¶åº“æ‰“åŒ…è¿›åº”ç”¨ä¸­ï¼Œè¿™æ ·å°±ä¿è¯äº†å¼€å‘ä¸åº”ç”¨çš„ Swift ç‰ˆæœ¬ä¸€è‡´ã€‚ç”±äº libswiftCore.dylib å±äºåº”ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯éœ€è¦ç­¾åçš„ï¼Œè€Œåƒä¸Šä¸€æ®µæ‰€è¯´ï¼Œèƒ½å¤Ÿä¸º Swift çš„è¿è¡Œæ—¶åº“ç­¾åçš„è¯ä¹¦å¿…é¡»åˆ›å»ºäº iOS 8 Released ä¹‹åã€‚è¿™ä¸€åˆ‡ï¼Œéƒ½æ˜¯ä¸ºäº†æé«˜ Swift çš„å…¼å®¹æ€§ï¼Œå…³äºå…¼å®¹æ€§ï¼Œå¼ºçƒˆæ¨èè¿™æ¡ [Tip](http://swifter.tips/compatibility/)ã€‚

]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E9%87%8D%E6%96%B0%E5%90%AF%E7%A8%8B%E7%9A%84-2016</guid><title>é‡æ–°å¯ç¨‹çš„ 2016</title><description>è½¬çœ¼ä¸€æœˆéƒ½å·²è¿‡åŠ...å¦‚æœè¯´ 2015 äºæˆ‘è€Œè¨€æ˜¯æ‰¿å‰å¯åçš„ä¸€å¹´ï¼Œé‚£ 2016 å¤§æ¦‚ç®—æ˜¯é‡æ–°å¯ç¨‹çš„ä¸€å¹´</description><link>ckitakishi.com/posts/%E9%87%8D%E6%96%B0%E5%90%AF%E7%A8%8B%E7%9A%84-2016</link><pubDate>Sat, 14 Jan 2017 19:23:00 +0900</pubDate><content:encoded><![CDATA[<h1>é‡æ–°å¯ç¨‹çš„ 2016</h1><p>è½¬çœ¼ä¸€æœˆéƒ½å·²è¿‡åŠ...å¦‚æœè¯´ 2015 äºæˆ‘è€Œè¨€æ˜¯æ‰¿å‰å¯åçš„ä¸€å¹´ï¼Œé‚£ 2016 å¤§æ¦‚ç®—æ˜¯é‡æ–°å¯ç¨‹çš„ä¸€å¹´ã€‚</p><h2>ç¬¬ä¸€ä¸ªå®Œæ•´çš„å·¥ä½œå¹´</h2><p>2016 æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå®Œæ•´å·¥ä½œå¹´ï¼Œæœ‰åä¸å®Œçš„æ§½ï¼Œä¹Ÿæœ‰è¯´ä¸å°½çš„æ„Ÿè°¢ã€‚</p><!--more-->

è¿œç¦»å®¶ä¹¡ï¼Œè–ªæ°´ä¸å¯è§‚ï¼Œäº‹å¤šï¼Œè´£ä»»é‡ï¼Œæ²¡æœ‰é è°±çš„å·¥ä½œæ­æ¡£ï¼Œæ— æ•°æ¬¡è´¨ç–‘è‡ªå·±ä¸ºä»€ä¹ˆä¸æ—©ç‚¹åšä¸ªäº†æ–­ï¼Œä½†æ˜¯æ— æ³•å¦è®¤è‡ªå·±åœ¨æˆé•¿ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€å®šç¨‹åº¦ä¸Šçš„å›æŠ¥ã€‚æ›¾ä¸€å¤œæ— çœ çš„æƒ³è¿‡ï¼Œå¥½å¤šäº‹ï¼Œæ—¶å€™æœªåˆ°ã€‚

å¹´åˆï¼Œå·¥ä½œé‡å¿ƒæ­£å¼ä»å‰ç«¯è½¬å› iOSï¼Œå……æ»¡äº†æœŸå¾…ã€‚ç„¶è€Œå¦‚æœçŸ¥é“æ³¨å®šæˆ‘ä¼šä¸€ä¸ªäººå­¤ç‹¬å¥‹æ–—ä¸€æ•´å¹´ï¼Œæˆ‘è¿˜ä¼šè¿™ä¹ˆæƒ³ä¹ˆï½æ²¡æœ‰ç­”æ¡ˆã€‚ä»æ¯” 0 å¤šä¸€ç‚¹çš„åŸºç¡€å¼€å§‹ï¼Œæäº†å¥½å¤šäº‹å„¿ï¼Œè¢«å˜²ç¬‘è¿‡æ—¥è¯­è¯´çš„çƒ‚ï¼Œè¢«ä»¥ç»éªŒä¸è¶³ä¸ºç”±ç”©è¿‡é”…...å¾ˆå–œæ¬¢ä¸€ä¸ªè¯ï¼Œã€Œè³›å¦ä¸¡è«–ã€ï¼Œæœ¬æ„æ˜¯èµæˆä¸åå¯¹å¹¶å­˜ï¼Œä¸åˆ†ä¼˜åŠ£ã€‚æˆ‘å¹¶ä¸å®³æ€•è¢«åå¯¹ï¼Œè¢«å˜²ç¬‘ï¼ˆåæ­£æ²¡äººèƒ½åœ¨æˆ‘çš„ bgm é‡Œæ‰“è´¥æˆ‘å“ˆå“ˆå“ˆï¼Œåªæ€• 10 å¹´åè¿˜åƒæŸäº›äººä¸€æ ·æ´»åœ¨è‡ªå·±çš„å˜´é‡Œï¼Œæ´»åœ¨è‡ªå·±çš„ yy ä¸­ï¼ˆæ‘Šæ‰‹ã€‚

ä¸€å¹´çš„å‹¤å‹‰å·¥ä½œæ¢æ¥äº†ã€Œå¥¨åŠ±è³ã€ï¼Œå¼€å¿ƒï¼Œä½†æ˜¯æ›´æœŸå¾…ä¼˜ç§€çš„å›¢é˜Ÿï¼Œä¼˜ç§€çš„è‡ªå·±ã€‚

## è®¤çœŸçš„ç”Ÿæ´»

è¿™ä¸€å¹´æ¥å¯¹æ—¶é—´ç®¡ç†è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆæ¸…æ™°çš„æ¦‚å¿µï¼Œå¾ˆé—æ†¾ï¼Œå¾ˆé—æ†¾ã€‚

åšäº†ä¸€äº›æ—¶é—´æŠ•å…¥ä¸é‡‘é’±å›æŠ¥å¹¶ä¸æ˜¯é‚£ä¹ˆæˆæ­£æ¯”äº‹ï¼Œä½†æ˜¯äºæˆ‘è€Œè¨€ç»å¯¹æ˜¯è¿™ä¸€å¹´æœ€æ£’çš„äº‹æƒ…ä¹‹ä¸€ã€‚èƒ½å¤Ÿæœ‰å¹¸å‚ä¸ã€Šå‡½æ•°å¼ Swiftã€‹çš„ç¿»è¯‘ï¼Œäºæˆ‘è€Œè¨€ç»ä¸æ˜¯èƒ½å¤Ÿè¡¡é‡çš„è´¢å¯Œï¼Œå’Œä¼˜ç§€çš„äººä¸€èµ·ï¼Œæ€»ä¼šæƒ³æŠŠäº‹æƒ…åšçš„æ›´å¥½ä¸€ç‚¹ã€‚

è®¤è¯†äº†ä¸€ç¾¤çˆ±è¯»ä¹¦çš„äººï¼Œæ–‡å­¦ç´ å…»æµ…è–„çš„æˆ‘ï¼Œä¹Ÿç®—æ˜¯è¯»äº†ä¸€äº›ä¹¦ã€‚



ç”Ÿæ´»è¿‡å¾—æŒºä¸é”™ï¼Œï¼ˆè§‰å¾—ï¼‰åšé¥­è¿›é˜¶å•¦ï¼Œæ¸¸æ³³è¿›é˜¶å•¦ï¼Œæ‹ç…§ä¹Ÿè¿›é˜¶å•¦ï½

## æ–°å¹´æ„¿æœ›

ä¸ºå¼€æºç¤¾åŒºè´¡çŒ®åŠ›é‡
åˆé€‚çš„æ—¶æœºæ¢å·¥ä½œ















]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/Swift%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%89%8D%E5%90%8E%E7%BC%80%E5%8C%B9%E9%85%8D</guid><title>Swift çš„å­—ç¬¦ä¸²å‰åç¼€åŒ¹é…</title><description>ä¹‹å‰ä¿®æ”¹äº†é¡¹ç›®ä¸­ä¸€ä¸ª increment search çš„ç»„ä»¶ï¼Œæœ€è¿‘åˆšå¥½åˆçœ‹åˆ°ä¸‹é¢˜ï¼Œäºæ˜¯æƒ³è¯´ä¸€è¯´å‰åç¼€åŒ¹é…çš„äº‹</description><link>ckitakishi.com/posts/Swift%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%89%8D%E5%90%8E%E7%BC%80%E5%8C%B9%E9%85%8D</link><pubDate>Wed, 9 Nov 2016 00:18:00 +0900</pubDate><content:encoded><![CDATA[<h1>Swift çš„å­—ç¬¦ä¸²å‰åç¼€åŒ¹é…</h1><p>ä¹‹å‰ä¿®æ”¹äº†é¡¹ç›®ä¸­ä¸€ä¸ª increment search çš„ç»„ä»¶ï¼Œæœ€è¿‘åˆšå¥½åˆçœ‹åˆ°ä¸‹é¢˜ï¼Œäºæ˜¯æƒ³è¯´ä¸€è¯´å‰åç¼€åŒ¹é…çš„äº‹ã€‚</p><p><a href="https://leetcode.com/problems/longest-common-prefix/">14. Longest Common Prefix</a></p><p>è¿™æ˜¯ä¸€ä¸ªç»™å®šå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ±‚æ‰€æœ‰å­—ç¬¦ä¸²æœ€é•¿å…¬æœ‰å‰ç¼€çš„é—®é¢˜ã€‚</p><p>ç›´æ¥ç”¨ <code>O(1)</code> çš„é¢å¤–ç©ºé—´æ¥å­˜å‚¨ä¸€ä¸ªæœ€é•¿å…¬æœ‰å‰ç¼€ï¼Œä¸€æ¬¡éå†åè¿”å›å‰ç¼€å­—ç¬¦ä¸²ã€‚è¿™ä¸ªæƒ³æ³•è‡ªç„¶åˆ°ä¸éœ€è¦å¤šåŠ è§£é‡Šï¼Œç„¶è€Œè¿™ä¹ˆä¸€å†™ç«Ÿç„¶å‡»è´¥äº† 100% çš„ Swift æäº¤ç»“æœ...</p><p>æ‰€ä»¥ä¸å¾—ä¸æä¸€ä¸‹ååˆ†é«˜æ•ˆçš„ <code>hasPrefix(_:)</code> æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>String</code> ç±»å‹çš„å‚æ•°å¹¶è¿”å› <code>Bool</code> å€¼ï¼Œè¿™é‡Œå­—ç¬¦ä¸²å¤§å°å†™æ•æ„Ÿï¼Œä¸”åŸºäº Unicode æ ‡å‡†ç­‰ä»·ã€‚æ­¤å¤–ï¼Œä¸ä¹‹å¯¹åº”ç”¨äºæ¯”è¾ƒåç¼€å­—ç¬¦ä¸²çš„æ–¹æ³•æ˜¯ <code>hasSuffix(_:)</code>ã€‚</p><pre><code><span class="comment">// Unicode æ ‡å‡†ç­‰ä»·</span>
<span class="keyword">let</span> composedCafe = <span class="string">"CafÃ©"</span>
<span class="keyword">let</span> decomposedCafe = <span class="string">"Cafe\u{0301}"</span>
<span class="call">print</span>(cafe.<span class="call">hasPrefix</span>(composedCafe))
<span class="comment">// Prints "true"</span>
<span class="call">print</span>(cafe.<span class="call">hasPrefix</span>(decomposedCafe))
<span class="comment">// Prints "true"</span>
</code></pre><p><a href="https://github.com/Ckitakishi/Daily/blob/master/LeetCode14_LongestCommonPrefix.swift"></a><br><br><br><br><br><br></p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/WatchDog-%E6%9C%BA%E5%88%B6</guid><title>iOS çš„çœ‹é—¨ç‹—æœºåˆ¶</title><description>é”™è¯¯ä»£ç  â€œ8badf00dâ€</description><link>ckitakishi.com/posts/WatchDog-%E6%9C%BA%E5%88%B6</link><pubDate>Wed, 17 Aug 2016 23:34:00 +0900</pubDate><content:encoded><![CDATA[<h1>iOS çš„çœ‹é—¨ç‹—æœºåˆ¶</h1><h2>èƒŒæ™¯</h2><p>å½“åº”ç”¨çš„ç½‘ç»œçŠ¶å†µæå·® (100% Loss) æ—¶å®Œå…¨æ— æ³•å¯åŠ¨ï¼Œä¸€ç›´å´©æºƒã€‚å½»åº•åˆ‡æ–­ç½‘ç»œè¿æ¥æ­£å¸¸å¯åŠ¨ï¼Œè°ƒè¯•æ¨¡å¼çŠ¶æ€ä¸‹ç­‰å¾…æ—¶é—´éå¸¸ä¹…ï¼Œä½†å¯ä»¥å¯åŠ¨ï¼Œå¹¶ä¼´éš UI å¾®å¡ã€‚å¼ºçƒˆçš„é¢„æ„Ÿè¿™æ˜¯çº¿ç¨‹é˜»å¡ã€‚å‰ä¸€æ®µæ—¶é—´è¢« Core Data Concurrency æŠ˜è…¾çš„å¤Ÿå‘›ï¼Œçœ‹è§çº¿ç¨‹é—®é¢˜å°±ç•¥æœ‰äº›å¿ƒæ…Œã€‚</p><!--more-->

## åŸå› 

é¦–å…ˆçœ‹äº† crash logï¼Œä¸€å¦‚çŒœæµ‹ï¼Œçš„ç¡®æ˜¯å¡åœ¨äº†ä¸»çº¿ç¨‹ï¼›æ„æ–™ä¹‹å¤–çš„æ˜¯ï¼Œæ— æ•°æ¬¡é—ªé€€åªç•™ä¸‹äº†ä¸€ä»½å´©æºƒæ—¥å¿—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![WatchDog](/images/watchdog.png)

ç¬¬ä¸€æ¬¡è§ï¼Œè¯»äº†ä¸€äº›èµ„æ–™å¤§æ¦‚æ‰ç®—æ˜¯æ˜ç™½äº†è¿™æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚ä¸ºäº†é¿å…åº”ç”¨é™·å…¥é”™è¯¯çŠ¶æ€å¯¼è‡´ç•Œé¢æ— å“åº”ï¼ŒApple è®¾è®¡äº†çœ‹é—¨ç‹— (WatchDog) æœºåˆ¶ã€‚ä¸€æ—¦è¶…æ—¶ï¼Œå¼ºåˆ¶æ€æ­»è¿›ç¨‹ã€‚åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œè§¦å‘çœ‹é—¨ç‹—æœºåˆ¶çš„è¶…æ—¶æ—¶é—´æœ‰æ‰€ä¸åŒï¼š

| ç”Ÿå‘½å‘¨æœŸ         |è¶…æ—¶æ—¶é—´ |
|----------------|--------|
| å¯åŠ¨ Launch     | 20 s   |
| æ¢å¤ Resume     | 10 s   |
| æ‚¬æŒ‚ Suspend    | 10 s   |
| é€€å‡º Quit       | 6 s    |
| åå° Background | 10 min |

é¦–å…ˆè¯´ä¸€è¯´å¼‚å¸¸ç¼–ç ï¼Œä¹Ÿæ˜¯å¯“æ„é¢‡æ·±ã€‚8badf00d = ate bad foodï¼Œå¤§æ¦‚æ˜¯åœ¨è¯´çœ‹é—¨ç‹—åƒäº†åçš„é£Ÿç‰©æ‰€ä»¥æš´èµ°äº†ï¼Ÿï¼å¼‚å¸¸è®°å½•åˆ™è¡¨ç¤ºè¿™å¹¶ä¸æ˜¯ä¸€æ¬¡å´©æºƒï¼ˆé‚ªé­…ä¸€ç¬‘ï¼šå¼ºåˆ¶é€€å‡ºè€Œå·²ï¼‰ã€‚ä¿¡æ¯ä¸€æ æŒ‡å‡ºæ—¶é—´é™åˆ¶ä¸º 20 sã€‚ç»“åˆåº”ç”¨ä¸šåŠ¡æ¥çœ‹ï¼Œè¡¨å±‚åŸå› åœ¨äºï¼šæ¯æ¬¡å¯åŠ¨åº”ç”¨ï¼Œé¦–å…ˆè¿›è¡Œä¸€æ¬¡æ¨¡ç‰ˆåŒæ­¥ï¼Œåœ¨æ­¤ä¹‹å‰éœ€è¦æ£€æµ‹ç™»å½•çŠ¶å†µï¼Œé€šè¿‡ RunLoop åå¤å°è¯•ç›´åˆ°æ”¶åˆ°å“åº”ä¸ºæ­¢ã€‚ç„¶è€Œä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸€äº›éƒ½å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ã€‚

åŒæ­¥ç½‘ç»œè¯·æ±‚ï¼Œä¸»çº¿ç¨‹ï¼Œè¶…é•¿è¶…æ—¶æ—¶é—´ï¼Œæ»¡è¶³è¿™ä¸‰ç‚¹ï¼Œä¸€å®šåœºæ™¯ä¸‹å‡ ä¹å¿…ç„¶ä¼šè§¦å‘çœ‹é—¨ç‹—æœºåˆ¶ã€‚

## å¯¹ç­–

åˆç†è§£å†³æ–¹æ¡ˆï¼š

1. å¼‚æ­¥ç½‘ç»œè¯·æ±‚ï¼šä¼˜ç‚¹å¾ˆå¤šï¼Œæœ€é‡è¦çš„æ˜¯å¯ä»¥è®©ä½ æ— å¿§æ— è™‘å®‰å…¨åœ°è®¿é—®ç½‘ç»œï¼Œè€Œæ— éœ€æ‹…å¿ƒçº¿ç¨‹ã€‚
2. åœ¨éä¸»çº¿ç¨‹ä¸­ä½¿ç”¨åŒæ­¥ç½‘ç»œè¯·æ±‚ï¼šå¦‚æœå¼‚æ­¥è¿è¡Œä½ çš„ç½‘ç»œä»£ç æ¯”ç™»å¤©è¿˜éš¾çš„è¯(ä¹Ÿè®¸ä½ çš„åº”ç”¨æ˜¯ä¸€ä¸ªåŸºäºåŒæ­¥ç½‘ç»œè¯·æ±‚çš„å¤§å‹ç§»æ¤é¡¹ç›®)ï¼Œé€€è€Œæ±‚æ¬¡ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æ¬¡çº§çº¿ç¨‹ä¸­è¿è¡ŒåŒæ­¥ä»£ç ï¼Œä¹Ÿå¯ä»¥é¿å…è§¦å‘çœ‹é—¨ç‹—æœºåˆ¶ã€‚

æ­¤å¤–ï¼Œä¸€éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¾‹å¦‚è¿™æ¬¡é‡åˆ°ç™»å½•å’Œæ¨¡ç‰ˆåŒæ­¥æ—¶è§¦å‘çœ‹é—¨ç‹—ï¼Œäº‹å®ä¸Šï¼Œå³ä½¿åœ¨è¿ç”¨åˆ°æ¨¡ç‰ˆæ—¶å†æ¬¡è¯·æ±‚ä¹Ÿæ˜¯å‹‰å¼ºå¯è¡Œçš„ï¼Œå› æ­¤å§‘ä¸”å…ˆè·³è¿‡ç½‘ç»œè¯·æ±‚ä¹Ÿå¯ä»¥ã€‚æ­¤æ—¶ï¼Œè¿˜ä»¥ä½¿ç”¨ä¸€ç§æˆ‘è®¤ä¸ºæ˜¯ç›¸å¯¹æ¯”è¾ƒå·®çš„æ–¹æ¡ˆï¼š

3. é€šè¿‡ RunLoop æ¥æ“æ§ä¸€åˆ‡ï¼Œä¸€æ—¦è¶…è¿‡æ—¢å®šçš„è¶…æ—¶æ—¶é—´ï¼Œå°±æç¤ºç”¨æˆ·é‡è¯•æˆ–è€…æš‚æ—¶å…ˆè·³è¿‡ç½‘ç»œè¯·æ±‚ã€‚

åº”ç”¨çš„ç½‘ç»œéƒ¨åˆ†åŸºäºå…¬å¸çš„é€šç”¨æ¡†æ¶ï¼Œå› æ­¤ä¼˜å…ˆè€ƒè™‘åœ¨éä¸»çº¿ç¨‹ä¸­è¿›è¡Œç½‘ç»œè¯·æ±‚æ¥é¿å…è§¦å‘çœ‹é—¨ç‹—ã€‚

è‡³äºè°ƒè¯•æ¨¡å¼ä¸‹ä¸ºä»€ä¹ˆå¯ä»¥æ­£å¸¸å¯åŠ¨åº”ç”¨ï¼Œå®Œå…¨æ˜¯å› ä¸ºè¯¥æ¨¡å¼ä¸‹çœ‹é—¨ç‹—æœºåˆ¶å¤„äºç¦ç”¨çŠ¶æ€ã€‚

æ­¤å¤–ï¼Œé™¤äº†ç½‘ç»œæ“ä½œï¼ŒI/O è¯»å†™æ–‡ä»¶å’Œå¤§è§„æ¨¡è¿ç®—ç­‰è€—æ—¶ä»»åŠ¡ä¹Ÿææœ‰å¯èƒ½è§¦å‘çœ‹é—¨ç‹—æœºåˆ¶ã€‚åˆç†å¤„ç†çº¿ç¨‹ï¼Œä¼˜åŒ–è€—æ—¶ä»»åŠ¡ï¼Œå¾ˆå¤§ç¨‹åº¦èƒ½é¿å…ä¸ä½³ç”¨æˆ·ä½“éªŒã€‚

## å‚è€ƒï¼š

1. [ä¸»çº¿ç¨‹ä¸Šçš„åŒæ­¥ç½‘ç»œè¯·æ±‚](https://developer.apple.com/library/ios/qa/qa1693/_index.html)
2. [è°ƒè¯•æ¨¡å¼ä¸å‘ç”Ÿå´©æºƒ](https://developer.apple.com/library/ios/qa/qa1592/_index.html)

]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E6%B2%96%E7%B8%84%E4%B8%89%E6%97%A5</guid><title>æ²–ç¸„ä¸‰æ—¥</title><description>æœŸå¾…å·²ä¹…çš„å†²ç»³ä¹‹è¡Œå’Œä¸é‚£ä¹ˆæœŸå¾…çš„é©¬æ‹‰æ¾å¦‚æ­¤è€Œè‡³ã€‚</description><link>ckitakishi.com/posts/%E6%B2%96%E7%B8%84%E4%B8%89%E6%97%A5</link><pubDate>Tue, 8 Dec 2015 22:56:00 +0900</pubDate><content:encoded><![CDATA[<h1>æ²–ç¸„ä¸‰æ—¥</h1><p>æœŸå¾…å·²ä¹…çš„å†²ç»³ä¹‹è¡Œå’Œä¸é‚£ä¹ˆæœŸå¾…çš„é©¬æ‹‰æ¾å¦‚æ­¤è€Œè‡³ã€‚å‡ºå‘çš„æ—©æ™¨é˜³å…‰ç‰¹åˆ«æ¸©æš–ï¼Œãƒ¢ãƒãƒ¬ãƒ¼ãƒ«çª—å­ä¸Šæ˜ å‡ºèº«å½±ï¼Œå¥½æš–ï½</p><p>åˆ°è¾¾å½“æ™šå’Œæ™´å„¿ä¸€èµ·åƒäº†å†²ç»³ãã°ï¼Œç»ˆäºåƒåˆ°æœ¬åœŸçš„äº†ï¼ˆç¬‘...</p><img src="ckitakishi.com/images/soba.jpg" alt="æ²–ç¸„ãã°"/><p>ä¸ºäº†è¿™æ¬¡çš„é©¬æ‹‰æ¾çš„å¹³å®‰..ä» 7 æœˆæ¸æ¸å¼€å§‹äº†ä¸ç§‘å­¦çš„ç»ƒä¹ ï¼Œç¬¬ä¸€æ¬¡æ—©æ™¨å‡ºå»è·‘äº† 2km å°±ç´¯æˆç‹—ï¼Œæ¢å¤äº†å¥½å‡ å¤©ã€‚8 æœˆåº•å‚åŠ äº†æ˜†é©¬ 10kmï¼Œå¹¸è¿çš„è¾¾æˆï¼æ¥æ—¥åï¼Œè·‘è¿‡å°é“ï¼Œè·‘è¿‡è’å·æ²¿å²¸ï¼Œè·‘è¿‡çš‡å±…ï¼Œæ…¢æ…¢å–œæ¬¢ä¸Šäº†è·‘æ­¥çš„æ„Ÿè§‰ã€‚</p><p>æ¯ä¸€æ¬¡è·‘éƒ½æ˜¯åšæŒå†åšæŒï¼Œä¹Ÿè®¸è·Ÿè‡ªå·±è¯´è¿‡ä¸€ä¸‡éå†ï¼Œæ²¡æœ‰å®Œèµ›å¥½é—æ†¾...ä¹Ÿè®¸æ˜¯ç»ƒä¹ ä¸è¶³ï¼Œä¹Ÿè®¸æ˜¯ FREE 4.0 FLYKNIT å¹¶ä¸å¤ªé€‚åˆè¶…é•¿è·ç¦»...ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå¯¹å¾—èµ·è‡ªå·±äº†ã€‚</p><p>å½“æ—¥ï¼Œèµ·åˆå¤©é«˜æ°”çˆ½ï¼Œåæ¥é£é›¨å¤§ä½œã€‚ä¸€è·¯ä¸Šåƒï¼Œè·‘ï¼Œåƒï¼Œè·‘ï¼Œå†²ç»³é»‘ç³–æ˜¯çœŸçš„å¾ˆå¥½åƒã€‚èµ›ç¨‹æœ€åé˜¶æ®µï¼Œé‡åˆ°çƒ­å¿ƒçš„å¤§å”å¸¦æˆ‘è·‘äº†ä¸€æ®µï¼Œä¸€ç›´è·Ÿæˆ‘è¯´åšæŒè·‘è¿˜èƒ½èµ¶å¾—ä¸Šå“Ÿï½ç„¶è€Œå¼±çˆ†äº†çš„æˆ‘è¿˜æ˜¯åœ¨æœ€ç»ˆï¼»è¿˜å‰© 1kmï¼½çš„åœ°æ–¹å¬åˆ°äº†ç»“æŸçš„ä¿¡å·ã€‚è¿åŠ¨åœºå…¥å£çš„çš„å¿—æ„¿è€…ä»¬å¤¹é“ç»™äº†æˆ‘ä»¬ï¼»æœ€åçš„å‡»æŒï¼½ï¼Œ6:15ï¼Œä»Šå¤©è·‘äº†è¿™ä¹ˆä¹…ï½</p><img src="ckitakishi.com/images/marathon.jpg" alt="é‚£è¦‡ãƒãƒ©ã‚½ãƒ³"/><p>èµ›åç¬¬äºŒå¤©ï¼Œé€›æ°´æ—é¦†ï¼Œçœ‹æµ·ã€‚è¯ç©·çš„æˆ‘åªè¯´å¾—å‡ºä¸€ä¸ªå½¢å®¹è¯ï¼šç¾ã€‚</p><p>æ¥é¦†å¿…çœ‹çš„ã‚¸ãƒ³ãƒ™ã‚¨ã‚¶ãƒ¡ï¼Œåæ¥æ‰çŸ¥æ˜¯é²¸é²¨ã€‚ä¸€ç¬é—´æ„Ÿåˆ°è‡ªå·±çš„æ¸ºå°ã€‚</p><img src="ckitakishi.com/images/aquarium.jpg" alt="ç¾ã‚‰æµ·æ°´æ—é¤¨"/><p>ä¸‰é¢ç¯æµ·çš„å²›ä¸Šï¼Œè‡ªå·±æ‹å©šçº±ç…§çš„æƒ…ä¾£ã€‚</p><img src="ckitakishi.com/images/sea.jpg" alt="æµ·"/><p>æ›¾ç»çš„å‚å¤©å¤§æ ‘ï¼Œå¦‚ä»Šåˆæ˜¯å¦ä¸€ç§é£éŸµã€‚ä¸€èµ·ï¼Œä»»æµ·é£å¹ï½</p><img src="ckitakishi.com/images/sea2.jpg" alt="æµ·"/><p>äºæˆ‘è€Œè¨€ï¼Œè¿™ä¸‰å¤©åˆæ˜¯ä¸€åœºæ´—ç¤¼ï¼Œåªæƒ³ä¸€ç”ŸåŠªåŠ›ï¼Œä¸€ç”Ÿè¢«çˆ±ã€‚ç”¨ä¸€å¥å¹¿å‘Šè¯­ä½œç»“å§ï¼Œ<strong>ã€Œè‹¦ã—ã„ã‘ã©ã€å¹¸ã›ã€</strong>ã€‚</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E8%BD%BB%E5%9B%BE%E5%83%8F%E5%B7%A5%E5%85%B7%EF%BC%8DLightImage</guid><title>è½»å›¾åƒå·¥å…·ï¼LightImage</title><description>LightImage æ˜¯æˆ‘çš„æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä½†æ˜¯è‡³ä»Šæš‚æ—¶è¿˜æ˜¯ä¸€ä¸ªæ®‹æ¬¡æˆå“ï¼Œä»éœ€å¤§åŠ›çš„æ”¹å–„ã€‚åˆè¡·æ˜¯å¼€å‘ä¸€æ¬¾è½»é‡çº§çš„å›¾åƒå¤„ç†å·¥å…·ï¼Œåç»­åˆæ‰©å±•äº†ç®€æ˜“çš„å›¾åƒåˆ†æå’Œåƒç´ ç”»ç»˜åˆ¶ç­‰åŠŸèƒ½ã€‚</description><link>ckitakishi.com/posts/%E8%BD%BB%E5%9B%BE%E5%83%8F%E5%B7%A5%E5%85%B7%EF%BC%8DLightImage</link><pubDate>Sat, 1 Aug 2015 16:58:00 +0900</pubDate><content:encoded><![CDATA[<h1>è½»å›¾åƒå·¥å…·ï¼LightImage</h1><p>LightImage æ˜¯æˆ‘çš„æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä½†æ˜¯è‡³ä»Šæš‚æ—¶è¿˜æ˜¯ä¸€ä¸ªæ®‹æ¬¡æˆå“ï¼Œä»éœ€å¤§åŠ›çš„æ”¹å–„ã€‚åˆè¡·æ˜¯å¼€å‘ä¸€æ¬¾è½»é‡çº§çš„å›¾åƒå¤„ç†å·¥å…·ï¼Œåç»­åˆæ‰©å±•äº†ç®€æ˜“çš„å›¾åƒåˆ†æå’Œåƒç´ ç”»ç»˜åˆ¶ç­‰åŠŸèƒ½ã€‚</p><p>é¡¹ç›®ä¸»è¦åŸºäº HTML5 ä¸­çš„ Canvas å¼€å‘ï¼Œå½“æåŠ Canvas çš„æ—¶å€™ï¼Œå¸¸å¸¸è¿˜ä¼šæåˆ° SVGã€‚Canvas åªèƒ½é€šè¿‡è„šæœ¬é©±åŠ¨ï¼Œé€‚åˆåƒç´ çº§çš„å›¾å½¢é—®é¢˜å¤„ç†ï¼›ç›¸æ¯”è¾ƒè€Œè¨€ SVG çš„é©±åŠ¨æ–¹å¼æ›´åŠ çµæ´»ï¼ŒXMLã€CSSç­‰éƒ½å¯ï¼Œæ‰€ä»¥å¤„ç†å›¾å½¢æ˜¯é€šè¿‡å…ƒç´ ã€‚å¯¹äºæœ¬é¡¹ç›®è€Œè¨€ï¼ŒCanvas æ˜¯ä¸äºŒçš„é€‰æ‹©ã€‚</p><p>é¡¹ç›®ä½¿ç”¨äº†æ¡†æ¶ Vue.jsï¼Œç»“åˆæ›¾ç»å®Œæˆçš„ä¸€ä¸ªæ•°æ®é‡è¾ƒå¤§çš„åº”ç”¨æ¥çœ‹ï¼Œå¾ˆä¼˜é›…ï¼Œå¾ˆè½»é‡ï¼Œå¾ˆçµæ´»ï¼Œè°ƒè¯•ä¹Ÿå¾ˆæ£’ï¼Œä¸è¿‡ä¹Ÿé‡åˆ°ä¸€äº›éœ€è¦ä»”ç»†æ€è€ƒçš„é—®é¢˜ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œè·¯ç”±ï¼Œé¡µé¢é‡è½½ç­‰ç­‰ã€‚</p><p>ç­”è¾©å®Œåå°±ä¸€ç›´æƒ³æŠŠä¸€ä¸ªå¤šæœˆå¼€å‘è¿‡ç¨‹ä¸­çš„å¿ƒå¾—å’Œé‡åˆ°çš„æœ‰æ„æ€çš„é—®é¢˜æ€»ç»“ä¸€ä¸‹ï¼Œè¿˜å¥½ä¹‹å‰æœ‰åœ¨ trello ä¸Šè®°å½•ã€‚ä¸‹é¢æƒ³ä»ä¸‰ä¸ªéƒ¨åˆ†æ¥è¯´ä¸€è¯´ï½</p><h2>ç»˜ç”»</h2><p>å…³äºè¿™ä¸ªéƒ¨åˆ†ï¼Œç»†èŠ‚çš„éƒ¨åˆ†é›†ä¸­äºäº‹ä»¶å¤„ç†ï¼Œä¾‹å¦‚ç¬”è¿¹ç¦»å¼€å’Œè¿›å…¥ç”»å¸ƒéœ€è¦ç»‘å®š mouseleave å’Œ mouseenter äº‹ä»¶ã€‚æƒ³è¦è¯´ä¸€è¯´çš„æ˜¯ï¼Œè¿™é‡Œæ·»åŠ äº†æˆ‘å¾ˆå–œæ¬¢çš„åƒç´ ç”»ç»˜åˆ¶ï¼Œé€šè¿‡å€ç‡æ¥æ¨¡æ‹Ÿä¸åŒæ ¼å­æ•°çš„åƒç´ ç”»å¸ƒï¼Œå°è¯•è¿‡ä½¿ç”¨å•ä¸ªåƒç´ æ”¾å¤§ä½†å¹¶é€‚ç”¨ã€‚åœ¨è¿™é‡Œä¸å¾—ä¸æç»™æˆ‘å¸¦æ¥æ·±åˆ»å½±å“çš„åƒç´ åŠ¨ç”»ä½œå“ä»¬ <a href="http://1041uuu.tumblr.com/">1041uuu</a>ã€‚</p><p>æœªæ¥å±•æœ›ï¼šä½¿ç”¨æ ˆä¿å­˜ç¬”ç”»ï¼Œå®Œæˆæ’¤é”€å‰è¿›ï¼›æä¾›è‡ªå®šä¹‰åƒç´ æ•°é‡ï¼›ä»¥åŠå…è®¸æ·»åŠ å¤šå¼ ç”»å¸ƒç»„æˆåŠ¨ç”»ã€‚</p><h2>å›¾åƒåˆ†æ</h2><p>è¿™ä¸ªéƒ¨åˆ†ä¹Ÿè®¸åä¸å‰¯å®ï¼Ÿï¼ˆç¬‘ã€‚èµ·åˆåªæ˜¯æƒ³åšä¸€ä¸ªå›¾åƒçš„è‰²å½©åˆ†æï¼Œç»Ÿè®¡è‰²å½©çš„å‡ºç°é¢‘ç‡ã€‚ä¾æ® rgb è‰²å½©æ¨¡å‹ï¼Œåˆ™æœ‰256^3ç§è‰²å½©ï¼Œéå¸¸å¤§çš„æ•°å­—ï¼Œäºæ˜¯å°†ç›¸è¿‘çš„è‰²å½©å½’ä½ä¸€ç±»ï¼Œç”±å¤§åŠå°æœ€ç»ˆé€‰å®šäº† 6^3 ç§è‰²å½©ã€‚ä½¿ç”¨ä¸€ä¸ªé•¿åº¦ä¸º 256 çš„æ•°ç»„å­˜å‚¨å‡ºç°æ¬¡æ•°ï¼Œè‰²å½©ä¸€ä¸€å¯¹åº”ä¸‹æ ‡ 0-255ï¼Œå¹¶å¯åå‘ç”±ä¸‹æ ‡æ¨å¯¼é¢œè‰²ä»¥ä¾¿åœ¨é¡µé¢æ¸²æŸ“ã€‚</p><p>åæ¥å¢æ·»äº†ç°åº¦ç›´æ–¹å›¾åŠå‡è¡¡åŒ–çš„ç›´æ–¹å›¾æ¥è¡¨ç°å›¾åƒçš„å¤§ä½“ç‰¹å¾ã€‚è¿™ä¸ªéƒ¨åˆ†æ•ˆç‡å—å›¾åƒå¤§å°å½±å“å¹¶ä¸æ˜æ˜¾ã€‚</p><p>æœªæ¥å±•æœ›ï¼šå¯å¯¼å‡ºåˆ†æç»“æœï¼›ä¿æŒæ•ˆç‡å¾—åˆ°æ›´ç²¾ç¡®çš„ç»“æœã€‚</p><h2>å›¾åƒå¤„ç†</h2><p>åšæ¯•è®¾çš„ä¸¤ä¸ªæœˆä¸­ï¼Œç”¨äºå­¦ä¹ å›¾åƒå¤„ç†å’Œä½¿ç”¨ JavaScript å®ç°èŠ±äº†ä¸å°‘æ—¶é—´ã€‚èµ·åˆå¤§æ¦‚çœ‹äº†çœ‹ã€Šæ•°å­—å›¾åƒå¤„ç†ã€‹..çš„ç›®å½•ã€åŸºç¡€å’Œè‰²å½©ç›¸å…³ç« èŠ‚ï¼Œæœ‰äº†ä¸€ç‚¹ç‚¹å®è§‚çš„ç†è§£ï¼ŒåæœŸæ›´å…·ä½“çš„ç†è§£å¤§å¤šæ¥è‡ªäºä»–äººæ–‡ç« å’Œã€Šæ•°å­—å›¾åƒå¤„ç†åŸç†ä¸å®è·µï¼šåŸºäºVisual C++å¼€å‘ã€‹ã€‚å®ç°ä¸­ï¼Œæ¯”è¾ƒæ·±åˆ»çš„æ˜¯å›¾åƒå‰ªåˆ‡ï¼Œæœ‰å‡ ä¸ª jQuery å®ç°çš„æ’ä»¶ï¼Œç„¶è€Œè¿˜æ˜¯å¼ºè¿«è‡ªå·±å†™äº†ä¸€ä¸ªçº¯ JavaScript çš„ï¼Œä½†è‡³ä»Šä»ä¸å®Œå–„ï¼Œå°†æ¥å¦‚è‹¥æœ‰ä¸€æ—¥èƒ½å¤Ÿè§äººï¼Œæ‰“ç®—è®©å…¶ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶å­˜åœ¨ã€‚</p><p>å›¾åƒå¤„ç†çš„æ•ˆç‡éšç€å›¾åƒå¢å¤§è€Œå‰§é™ï¼Œå¾ˆ sadï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ”¹å–„çš„é‡ç‚¹ã€‚</p><p>æœªæ¥å±•æœ›ï¼šç»“åˆç›´æ–¹å›¾ï¼Œæ·»åŠ æ›²çº¿ï¼›å¯è°ƒèŠ‚äº®åº¦ï¼Œå¯¹æ¯”åº¦ç­‰ã€‚</p><h2>æœ‰è¯è¯´</h2><p>æºç å®Œå…¨åœ¨ <a href="https://github.com/Ckitakishi/LightImage">Github</a></p><p>å¯ä»¥åœ¨ heroku ä¸Š <a href="https://lightimage.herokuapp.com">Try it</a></p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E8%AF%B4%E8%AF%B4%E8%BF%87%E5%8E%BB%E8%BF%99%E5%8D%8A%E5%B9%B4</guid><title>è¯´è¯´è¿‡å»è¿™åŠå¹´</title><description>è¿‡å»è¿™åŠå¹´ï¼Œè¯´å®è¯è¿‡çš„è›®ä¸é”™ã€‚ç¡®å®šäº†å·¥ä½œï¼Œç»“æŸäº†å®ä¹ ï¼Œå¸¦ç€ä¸èˆé¡ºåˆ©æ¯•ä¸šï¼Œæ¯•ä¸šæ—…è¡Œã€‚æ¯ä¸€ä»¶äº‹éƒ½é‚£ä¹ˆéš¾å¿˜ã€‚</description><link>ckitakishi.com/posts/%E8%AF%B4%E8%AF%B4%E8%BF%87%E5%8E%BB%E8%BF%99%E5%8D%8A%E5%B9%B4</link><pubDate>Fri, 31 Jul 2015 23:58:00 +0900</pubDate><content:encoded><![CDATA[<h1>è¯´è¯´è¿‡å»è¿™åŠå¹´</h1><p>è¿‡å»è¿™åŠå¹´ï¼Œè¯´å®è¯è¿‡çš„è›®ä¸é”™ã€‚ç¡®å®šäº†å·¥ä½œï¼Œç»“æŸäº†å®ä¹ ï¼Œå¸¦ç€ä¸èˆé¡ºåˆ©æ¯•ä¸šï¼Œæ¯•ä¸šæ—…è¡Œã€‚æ¯ä¸€ä»¶äº‹éƒ½é‚£ä¹ˆéš¾å¿˜ã€‚</p><p>å¹´åˆï¼ŒçŠ¹è±«å’Œçº ç»“æœ€ç»ˆè¿˜æ˜¯æ²¡èƒ½é˜»æŒ¡ä¸€ä¸ªå°å°çš„æ¢¦æƒ³ï¼Œå†³å®šå»éœ“è™¹å·¥ä½œã€‚å¤§ä¸‰ä»¥å‰è¿˜ä¿¡èª“æ—¦æ—¦çš„è¯´è¿‡å°±ç®—å»æ—¥æœ¬ä¹Ÿåªå¯èƒ½æ˜¯æ—…è¡Œï¼Œäº²çˆ±çš„æ—¥è¯­è€å¸ˆä»¬ä¼°è®¡æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°å½“å¹´é‚£ä¸ªæ—¥è¯­ä¸‹æ‰‹çš„å­¦ç”Ÿå°½ç„¶è¦å»å·¥ä½œäº†ï½</p><p>å››æœˆåº•ï¼Œç»“æŸäº†å…«ä¸ªæœˆçš„å®ä¹ ï¼Œæœ€æƒ³è¯´çš„æ˜¯æ„Ÿè°¢ï¼Œèº«è¾¹çš„äººéƒ½å……æ»¡äº†æ­£èƒ½é‡ã€‚æœ€å¹¸ç¦çš„æ˜¯å¼€å‘ä¸»çº¿ç”± iOS é‡æ–°å›åˆ°äº† web å‰ç«¯å¼€å‘ï¼Œæ¡†æ¶å¼€å‘ï¼Œæ–°äº§å“ç ”å‘ï¼Œæ¡ˆä»¶å¯¹åº”...ã€‚</p><p>å…­æœˆåº•ï¼Œæ¯•ä¸šè®¾è®¡ [<a href="https://lightimage.herokuapp.com">lightimage</a>] å’Œå­¦ä½æˆäºˆä¸ºå¤§å­¦åˆ’ä¸Šäº†å¥å·ï¼Œå¸¦ç€æ»¡æ»¡çš„ç¥ç¦å’Œå¥½å‡ åGçš„æ¯•ä¸šç…§è·Ÿæœ€çˆ±çš„ DUT è¯´å†è§äº†ã€‚</p><p>ä¸ƒæœˆï¼Œä¼´éšç€æ±Ÿå—çƒŸé›¨çš„æ¯•ä¸šæ—…è¡Œï¼Œæ¯å¤©æ—©æ™¨é†’æ¥éƒ½ä¼šæƒ³åˆå°‘äº†ä¸€å¤©ç›¸ä¼´ï¼ŒçœŸçš„èˆä¸å¾—ã€‚åŒä¸€ä¸ªå±‹æªä¸‹ç”Ÿæ´»äº†å››å¹´ï¼Œä½ ä»¬ç»™æˆ‘å¸¦æ¥äº†å¤ªå¤šï¼Œä¸€èµ·åŠªåŠ›ä¸€èµ·ç©è€äº’ç›¸åæ§½äº’ç›¸æ‰“å‡»...</p><p>çª—å¤–å¤§é›¨æ»‚æ²±ï¼Œèµ¶åœ¨ä¸ƒæœˆçš„å°¾å·´ï¼Œæµæ°´è´¦ä¸€æ ·çš„æ¢³ç†äº†è¿™åŠå¹´æ¥çš„å‘ç”Ÿçš„äº‹æƒ…å’Œå¿ƒæƒ…ã€‚æˆ‘å°±è¦å¸¦ç€æ¢¦æƒ³é‡æ–°èµ·èˆªå•¦ï½</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E5%BF%B5%E5%BF%B5%E4%B8%8D%E5%BF%98</guid><title>å¿µå¿µä¸å¿˜</title><description>ç¢ç¢å¿µè€Œå·²...</description><link>ckitakishi.com/posts/%E5%BF%B5%E5%BF%B5%E4%B8%8D%E5%BF%98</link><pubDate>Tue, 28 Oct 2014 20:19:00 +0900</pubDate><content:encoded><![CDATA[<h1>å¿µå¿µä¸å¿˜</h1><p>å¤§è¿çš„å†¬å¤©å¦‚æœŸè€Œè‡³ï¼Œæ—¶å…‰åŒ†åŒ†...å®ä¹ ä¹Ÿé©¬ä¸Šå°±è¦è¿›å…¥ç¬¬ä¸‰ä¸ªæœˆï¼Œä¾ç„¶æƒ³è¦å»å—æ–¹... è¿‡å»çš„ä¸¤ä¸ªæœˆï¼Œé‡æ–°æŠ•å…¥åˆ° web å‰ç«¯å¼€å‘çš„æ€€æŠ±ï¼Œæœ‰ç§å¥½ä¹…ä¸è§ï¼Œä½ ä¾ç„¶ç¾ä¸½çš„æ„Ÿè§‰ã€‚ä½†æ˜¯é—®é¢˜ä¾æ—§æ˜¯æœ‰çš„ï¼Œå¹¸å¥½ä¹Ÿä¼šæ„Ÿè§‰åˆ°è‡ªå·±ç¡®ç¡®å®å®åœ¨è¿›æ­¥ã€‚å·¥ä½œä¹‹ä½™çš„ç”Ÿæ´»ç‰¹åˆ«è§„å¾‹ï¼Œæ¯å¤©å’Œ Q ä¸€èµ·æˆ–è¹­ç½‘ï¼Œæˆ–ä¹±é€›ï¼Œæˆ–è´­ç‰©ï¼Œå¶å°”ä¹Ÿçº¦ä¸Šè¿ªè¿ªä¸€èµ·åƒå–ç©ä¹ã€‚ ä»Šå¤©å¼€å§‹äº†å†™ jQuery æ’ä»¶çš„å¾é€”ï¼Œè¿™ä¸ªè¿˜æ˜¯ä¸‹ä¸€ç¯‡å†è¯´å§ã€‚ï¼»ï¼šï¼‰...ï¼½</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/dream-mark%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F</guid><title>Dream Markçš„å‰ä¸–ä»Šç”Ÿ</title><description>Dream Mark æ˜¯ä¸€æ¬¾å›¾ç‰‡åˆæˆ App ï¼ˆNote: ç»ƒæ‰‹é¡¹ç›®ï¼‰</description><link>ckitakishi.com/posts/dream-mark%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F</link><pubDate>Tue, 1 Jul 2014 23:28:00 +0900</pubDate><content:encoded><![CDATA[<h1>Dream Markçš„å‰ä¸–ä»Šç”Ÿ</h1><h2>DreamMark çš„å‰ä¸–</h2><p>DreamMarkçš„çš„ç®€ä»‹æ°¸è¿œéƒ½æ˜¯ <em>Mark our dream.</em></p><p>èµ·åˆï¼Œè¿™æºäºä¸€æ¬¡æ¿€çƒˆçš„è®¨è®ºã€‚â€œç”Ÿæ´»å¹¶ä¸å¹³æ·¡ï¼Œå¯å¾ˆå¤šä¸œè¥¿å°±æ˜¯è®°ä¸ä½â€ï¼Œâ€œæˆ‘ä»¬å¤§æ¦‚éœ€è¦å€ŸåŠ©çº¸å’Œç¬”â€ï¼Œâ€œå¯æ˜¯ï¼Œé“­å¿ƒçš„è‡ªç„¶å¿˜ä¸äº†ï¼Œå…¶å®ƒåˆè®°äº†å¹²å˜›â€ï¼Œå·®ä¸€ç‚¹ï¼Œå°±å†ä¹Ÿæ²¡æœ‰ç„¶åäº†ã€‚â€œä¸ä¸€æ ·çš„ï¼Œè®°ä½å¯ä»¥æ˜¯ä¸ºäº†è®°å¿†ï¼Œä¹Ÿå¯ä»¥æ˜¯æé†’â€ï¼Œâ€œåšæ¢¦ï¼å“ªæœ‰é‚£ä¹ˆç¥å¥‡ã€‚â€ï¼Œâ€œå—¯ï¼é‚£å°±åšæ¢¦å§ï¼â€ï¼Œâ€œ......â€ã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬å†³å®š <em>mark our dream</em> ã€‚è®©æ¢¦å¢ƒå’Œæ¢¦æƒ³ï¼Œä¸ºè®°å¿†æ·»ä¸Šé‚£ä¹ˆä¸€ç‚¹å„¿ä¸åŒçš„ä¸œè¥¿ã€‚</p><h2>DreamMark çš„ä»Šç”Ÿ</h2><p>åŠä¸ªæœˆï¼Œæ¯å¤©çº¦ 3 å°æ—¶ï¼Œæˆ‘ä»¬å®Œæˆäº† DreamMark æœ€åˆç‰ˆçš„å¼€å‘ã€‚</p><p>DreamMark æ”¯æŒä¸¤ç§æ¨¡å¼ï¼š &gt; æ¶‚é¸¦ --- ç»™ä½ ä¸€ä¸ªç”»æ¿ï¼Œä½ å¯ä»¥ç»˜å‡ºä½ çš„æ¢¦ &gt; æ‹¼å›¾ --- åœºæ™¯ + äººç‰© + æƒ…èŠ‚ + å…¶å®ƒ = ä½ çš„æ¢¦</p><p>DreamMark å­¦ä¼šäº†èµ°è·¯ï¼Œä½†è¿˜èµ°çš„ä¸æ¼‚äº®ã€‚æ— è®ºæ˜¯è®¾è®¡è¿˜æ˜¯ä»£ç ï¼Œæˆ‘ä»¬ä¼šåŠªåŠ›åšåˆ°æ›´å¥½ã€‚</p><h2>DreamMark ç›¸å…³</h2><p>æ‰€æœ‰å›¾ç‰‡å‡ç”± <a href="http://chiakiq.com/">æ™´</a> åŸåˆ›ã€‚ ä½¿ç”¨ <a href="https://www.parse.com/">Parse</a> æä¾›åå°æœåŠ¡ã€‚ æ›´æ–°åœ¨ <a href="https://github.com/Ckitakishi/DreamMark">è¿™é‡Œ</a>ã€‚</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/uikit-dynamics--ios7</guid><title>UIKit Dynamics--iOS7</title><description>Dynamic Items ä¸ºæˆ‘ä»¬å¸¦æ¥æ›´ä¸°å¯Œçš„åŠ¨ç”»ä½“éªŒã€‚</description><link>ckitakishi.com/posts/uikit-dynamics--ios7</link><pubDate>Sat, 22 Mar 2014 22:17:00 +0900</pubDate><content:encoded><![CDATA[<h1>UIKit Dynamics--iOS7</h1><h2>Dynamic Items ç®€ä»‹</h2><p><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIDynamicItem_Protocol/Reference/Reference.html">Apple Libraryç›¸å…³çš„</a> UIKit Dynamics çš„ç„¦ç‚¹éƒ½æ˜¯å…³äº items ä¹‹é—´ç›¸äº’çš„ä½œç”¨åŠå…¶åŠ¨ç”»ã€‚æœ‰ä¸€ä¸ªè¦æ±‚ï¼Œä¸ºäº†åœ¨ä¸€ä¸ª item ä¸Šä½¿ç”¨ dynamic behaviorï¼Œitemå¿…é¡»æ»¡è¶³ <code>UIDynamicItem</code> åè®®ã€‚è¯¥åè®®å®šä¹‰äº†ä¸‰ä¸ªé‡è¦çš„å±æ€§ï¼Œ<code>bounds</code>ï¼Œ<code>center</code>ï¼Œ<code>transform</code>ã€‚<code>bounds</code>å±æ€§æ˜¯readonlyçš„,<code>center</code>,<code>transform</code> å±æ€§æ˜¯read/writeçš„ï¼Œ<code>center</code> éœ€è¦æ›´æ–°åŠ¨ç”»çš„è¿›åº¦,<code>transform</code> å±æ€§è¿”å›ä¸€ä¸ª <code>CGAffineTransform</code> çš„å¯¹è±¡ã€‚</p><p>ä» iOS7 å¼€å§‹ï¼Œé»˜è®¤çš„åªæœ‰ <code>UIView</code> å’Œ <code>UICollectionViewLayoutAttributes</code> ç±»å¯å®ç°è¯¥åè®®ã€‚ä½†æ˜¯ï¼Œä»ç„¶å¯ä»¥è‡ªå·±åˆ›å»ºç±»å»å®ç°ä¹‹ã€‚</p><pre><code><span class="keyword">@property</span>(nonatomic, readonly) <span class="type">CGRect</span> bounds
<span class="keyword">@property</span>(nonatomic, readwrite) <span class="type">CGPoint</span> center
<span class="keyword">@property</span>(nonatomic, readwrite) <span class="type">CGAffineTransform</span> transform
</code></pre><h3>Dynamic Behaviors</h3><p>åœ¨ UIKit Dynamics ä¸­ï¼Œä¸€ä¸ª Dynamic Behavior æ¨¡æ‹Ÿçš„æ˜¯çœŸå®ä¸–ç•Œçš„ç‰©ç†è¡Œä¸ºã€‚åŒ…å«ä»¥ä¸‹å…­ä¸ªç±»ï¼š <em> UIAttachmentBehavior </em> UICollisionBehavior <em> UIGravityBehavior </em> UIPushBehavior <em> UISnapBehavior </em> UIDynamicItemBehavior</p><p>å‰äº”ä¸ªåˆ†åˆ«æ˜¯--é™„ç€ã€ç¢°æ’ã€é‡åŠ›ã€æ¨åŠ›ã€æ•æ‰ã€‚æœ€åä¸€ä¸ªä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„è¡Œä¸ºï¼Œä½†æ˜¯ä¹Ÿå¾ˆæœ‰ç”¨~æŒ‰æˆ‘çš„ç†è§£å°±æ˜¯å¯ä»¥è®¾ç½®ä¸€ä¸ªç‰©ä½“çš„æœ¬è´¨å±æ€§ï¼Œä¸ä¾èµ–äºå¤–ç•Œè€Œå­˜åœ¨çš„ã€‚</p><p>æœ€è¿‘å†™ä»£ç ç”¨åˆ° UIDynamicItemBehaviorï¼Œæ„Ÿè§‰å¤ªæ£’äº†ï¼ <em> allowsRotation æ˜¯å¦å¯ä»¥æ—‹è½¬ï¼›é»˜è®¤YESï¼› </em> density å¯†åº¦ï¼›é»˜è®¤1.0; <em> elasticity å¼¹æ€§ç³»æ•°ï¼›é»˜è®¤0.0ï¼› </em> friction æ‘©æ“¦ç³»æ•°ï¼›é»˜è®¤0.0ï¼› * resistance é˜»åŠ›ï¼›é»˜è®¤0.0ï¼›</p><p>å½“æ—¶æƒ³è¦è®©ä¸€ä¸ªçƒèƒ½å¤Ÿä¸€å¼€å§‹å°±æœ‰æ–¹å‘æœ‰é€Ÿåº¦çš„è¿åŠ¨ï¼Œä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°ä¸èƒ½å†èµï¼Œå¾ˆç®€ä¾¿ã€‚</p><pre><code>  â€“ <span class="call">addAngularVelocity</span>(<span class="type">CGFloat</span>):<span class="call">forItem</span>(id[<span class="type">UIDynamicItem</span>])<span class="comment">//è®¾ç½®è§’é€Ÿåº¦</span>
 â€“ <span class="call">addLinearVelocity</span>(<span class="type">CGPoint</span>):<span class="call">forItem</span>(id[<span class="type">UIDynamicItem</span>])<span class="comment">//è®¾ç½®çº¿é€Ÿåº¦
//angularResistanceè§’åº¦é˜»åŠ›ç³»æ•°</span>
</code></pre><h3>UIDynamicAnimator</h3><p>UIDynamicBehavior éœ€è¦æ·»åŠ åˆ° animator ä¸Šæ‰èƒ½å‘ç”Ÿä½œç”¨ï¼›</p><h3>ReferenceView</h3><p>ç­‰åŒäºåŠ›å­¦å‚è€ƒç³»ã€‚</p>]]></content:encoded></item><item><guid isPermaLink="true">ckitakishi.com/posts/%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95</guid><title>é‡åˆ°çš„ä¸€äº›é—®é¢˜ä¸è§£å†³åŠæ³•</title><description>åŸºäº Hexo æ­å»ºä¸ªäººåšå®¢è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</description><link>ckitakishi.com/posts/%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E5%8A%9E ... E6%B3%95</link><pubDate>Mon, 6 Jan 2014 22:30:00 +0900</pubDate><content:encoded><![CDATA[<h1>é‡åˆ°çš„ä¸€äº›é—®é¢˜ä¸è§£å†³åŠæ³•</h1><p>ä¸€ç›´æœ‰äº›åšå®¢å†™è®°å½•çš„ä¹ æƒ¯ï¼Œä½†æ˜¯è¶Šæ¥è¶Šè§‰å¾—å®šåˆ¶çš„åšå®¢ä»¬å¾ˆå¤šæ—¶å€™æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œäº†è§£äº†ä¸€äº›æ¡†æ¶åï¼Œæœ€ç»ˆé€‰æ‹©äº† <a href="http://zespia.tw/hexo/">hexo</a>ï¼Œç”šè‡³æ‰“å¼€ä¸»é¡µçš„ç¬é—´å°±è®¤å®šå®ƒäº†ã€‚hexo ç”± Node.js é©±åŠ¨ï¼Œè¿…é€Ÿï¼Œç®€æ´ã€‚</p><p>è¿™ä¸¤å¤©ä¹Ÿé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç®€å•åœ°è®°å½•ä¸‹æ¥ã€‚</p><h2>1.æ— æ³•æˆåŠŸ deploy</h2><p>æ­¤æ—¶å·²ç»å®Œæˆäº† <a href="http://nodejs.org/">node.js</a> çš„å®‰è£…ï¼Œå¹¶åœ¨ <a href="https://github.com/">github</a> åˆ›å»ºäº†åä¸º <code>username.github.io</code> çš„ repository ã€‚éƒ¨ç½²å®Œæˆä¹‹åï¼Œ</p><pre><code>hexo generate 
hexo server  
</code></pre><p>æ­¤æ—¶å·²ç»å¯ä»¥é€šè¿‡ <code>localhost:4000</code> æŸ¥çœ‹é¡µé¢ï¼Œlandscape çš„ä¸»é¢˜è§‰å¾—å¾ˆæ·±æ²‰ã€‚</p><pre><code>hexo deploy
</code></pre><p>ç«Ÿç„¶æ²¡æœ‰æˆåŠŸã€‚å‡ºç°äº†å¥½å‡ ä¸ª <code>fetal:......</code>ï¼Œæç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚èµ¶ç´§å…³æ‰ bashï¼Œç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€ï¼Œç»ˆäºæ²¡æœ‰ fetal äº†ã€‚windows æ€»æ˜¯è¿™æ ·.....å°±åœ¨æˆ‘å¾—æ„çš„ç¬‘æ—¶ï¼Œä»”ç»†ä¸€çœ‹ï¼Œç«Ÿç„¶æ²¡æœ‰æˆåŠŸ push åˆ° githubã€‚æœç´¢è‰¯ä¹…ï¼ŒçŒœæƒ³ä¹Ÿè®¸æ˜¯é‡è£…ç³»ç»Ÿå ssh key å‡ºé—®é¢˜ï¼Œé‡æ–°ç”Ÿæˆäº†ä¸€ä¸ªï¼Œä¾ç„¶æœªèƒ½è§£å†³ã€‚çœ‹åˆ°æœ‰ç½‘å‹è¯´ github åå­—æœ‰å¤§å†™å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä¸€æƒ³è‡ªå·±çš„åå„¿ï¼Œäºæ˜¯è”ç³»äº† github çš„å·¥ä½œäººå‘˜ï¼Œäººå®¶å¾ˆå¿«å›é‚®ä»¶ï¼Œå¼€å¤´å°±æ˜¯ NOï¼å¾€æ¥äº†ä¸¤å°é‚®ä»¶ï¼ŒæŸ¥çœ‹å¯†é’¥å¯ç”¨æ€§ï¼Œä»¥åŠæˆ‘çš„å‘½ä»¤å’Œé”™è¯¯ã€‚ç»“æœç¬¬äºŒå¤©ï¼Œå°±å¥½äº†......æ˜¯çš„ï¼Œå°±å¥½äº†ã€‚ä¸ªäººè®¤ä¸ºå¯èƒ½çœŸçš„å’Œ ssh key æœ‰å…³å§ã€‚</p><h2>2.icoå›¾æ ‡çš„æ·»åŠ </h2><p>å…³äºå°å›¾æ ‡çš„æ·»åŠ ï¼Œå‚è€ƒäº† <a href="http://zipperary.com/2013/05/30/hexo-guide-4/">zippera</a> æ‰€å†™ã€‚</p><pre><code>&lt;% <span class="keyword">if</span> (config.<span class="property">root</span>){ %&gt;
  &lt;link href=<span class="string">"/favicon.ico"</span> rel=<span class="string">"shortcut icon"</span> type=<span class="string">"image/x-icon"</span> /&gt; #è¿™æ®µæ˜¯faviconeræä¾›çš„é€šç”¨ä»£ç ã€‚
&lt;% } %&gt;
</code></pre><p>æˆ‘çš„åšæ³•æ˜¯ç›´æ¥å°†ä»¥ä¸Šä»£ç æ·»åŠ åˆ° <code>head.ejs</code>ã€‚</p><p>ç‰¹åˆ«æ„Ÿè°¢ <a href="http://chiakiq.com/">Qing</a> è®¾è®¡çš„ Aï¼ŒB å›¾æ ‡ï¼Œåœ¨è‡ªå·±åœ¨æ“ä½œè¿‡ç¨‹ä¸­ï¼Œåªèƒ½åœ¨ localhost æŸ¥çœ‹åˆ°å›¾æ ‡ã€‚æŸ¥çœ‹äº† github çš„ repoï¼Œå‘ç°åå¤ deploy B å›¾æ ‡ä½†æ˜¯ä¾ç„¶å­˜åœ¨çš„æ˜¯ A å›¾æ ‡ï¼Œçº å…¶åŸå› ï¼Œæ”¾å¼ƒ A å›¾æ ‡ä¹‹åç¼“å­˜è¿˜åœ¨ã€‚æŸ¥çœ‹äº†æ–‡æ¡£ï¼Œæ ¹ç›®å½•ä¸‹çš„ <strong>db.json</strong> å³ä¸ºç¼“å­˜ï¼Œåˆ é™¤ä¹‹ï¼Œé‡æ–° deployï¼Œå°±æˆåŠŸäº†ã€‚</p><p>æ­¤åï¼Œå¦‚æœç”±äºç¼“å­˜è€Œå¯¼è‡´çš„æ— æ³•æ›´æ–°å†…å®¹ï¼Œåˆ é™¤ <strong>db.json</strong> å³å¯ã€‚</p><h2>3.åŸŸåçš„è§£æ</h2><p>é€‰æ‹©äº† <a href="https://www.dnspod.cn/">DNSPod</a> è§£æåŸŸåï¼Œæ·»åŠ  A è®°å½•æ—¶ï¼Œè®°å½•å€¼å¡«äº†ä¸ªäºŒçº§åŸŸåçš„ ipï¼Œåç­‰~åƒè¿‡é¥­åä¾ç„¶ä¸è¡Œï¼Œå‚è€ƒäº†ä¸€äº›äººçš„ç»å†ï¼Œåˆæ·»åŠ äº†ä¸€æ¡ A è®°å½•ï¼Œip å†™äº† <code>pages.github.com</code> çš„ <code>204.232.175.78</code>ï¼›å¾ˆå¥‡æ€ªï¼Œè‡ªå·± ping çš„ ip åœ°å€æ˜¯ä¸€ä¸ªæ¾³å¤§åˆ©äºšçš„åœ°å€ <code>103.***.***.***</code>ã€‚ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼ŒéªŒè¯äº† <code>204.232.175.78</code> å’Œ ping çš„ ip åœ°å€éƒ½æ˜¯å¯ä»¥ç”¨çš„ã€‚è€Œä¸”åè€…æ›´å¿«ã€‚</p><h2>4.hexo generate æ— æ³•è§£æ</h2><p>åœ¨æœ¬æ–‡ä¿®æ”¹å†æäº¤æ—¶åˆé‡åˆ°é—®é¢˜ï¼Œ<code>hexo g</code> å‡ºç°äº†ä¸€ä¸‹ logï¼š</p><pre><code>rawMessage: '<span class="type">Unable</span> to parse.',
parsedLine: <span class="number">8</span>,
snippet: '  hexo generate ',
parsedFile: null,
message: '<span class="type">Unable</span> to parse.',
domain: 
{ domain: null,
 _events: { error: [<span class="type">Function</span>] },
 _maxListeners: <span class="number">10</span>,
 members: [],
 _disposed: <span class="keyword">true</span> },
domainThrown: <span class="keyword">true</span> }
</code></pre><p>å»æŸ¥çœ‹äº† hexo é¡¹ç›®çš„ <a href="https://github.com/tommy351/hexo/issues?page=1&state=open">Issues</a>ï¼Œæœ‰äººé‡åˆ°ç±»ä¼¼çš„ä¸€äº›é—®é¢˜ï¼ŒåŸå› æ˜¯markdownè¯­æ³•ä¸å¤ªå¯¹ï¼Œå‘ç°æ˜¯å› ä¸ºæ±‰å­—ä¹‹é—´ç”¨äº† <code>----</code>ã€‚</p><h2>å°¾å£°</h2><p>(*^^)vè·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚</p>]]></content:encoded></item></channel></rss>