<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Ckitakishi.playground"/><link rel="canonical" href="ckitakishi.com/posts/TIL-%E6%A2%85%E9%9B%A8%E6%8F%90%E6%97%A9%E5%88%B0%E6%9D%A5%E7%9A%84%E4%BA%94%E6%9C%88"/><meta name="twitter:url" content="ckitakishi.com/posts/TIL-%E6%A2%85%E9%9B%A8%E6%8F%90%E6%97%A9%E5%88%B0%E6%9D%A5%E7%9A%84%E4%BA%94%E6%9C%88"/><meta name="og:url" content="ckitakishi.com/posts/TIL-%E6%A2%85%E9%9B%A8%E6%8F%90%E6%97%A9%E5%88%B0%E6%9D%A5%E7%9A%84%E4%BA%94%E6%9C%88"/><title>[TIL] æ¢…é›¨ææ—©åˆ°ä¾†çš„äº”æœˆ | Ckitakishi.playground</title><meta name="twitter:title" content="[TIL] æ¢…é›¨ææ—©åˆ°ä¾†çš„äº”æœˆ | Ckitakishi.playground"/><meta name="og:title" content="[TIL] æ¢…é›¨ææ—©åˆ°ä¾†çš„äº”æœˆ | Ckitakishi.playground"/><meta name="description" content="äº”æœˆä¸»é¢˜ï¼šbyWordWrapping - å­¤ç‹¬çš„å•è¯ï¼ŒfileSystemRepresentation, stat - st_size æ˜¯ä»€ä¹ˆç±»å‹, lineHeight and lineSpacing..."/><meta name="twitter:description" content="äº”æœˆä¸»é¢˜ï¼šbyWordWrapping - å­¤ç‹¬çš„å•è¯ï¼ŒfileSystemRepresentation, stat - st_size æ˜¯ä»€ä¹ˆç±»å‹, lineHeight and lineSpacing..."/><meta name="og:description" content="äº”æœˆä¸»é¢˜ï¼šbyWordWrapping - å­¤ç‹¬çš„å•è¯ï¼ŒfileSystemRepresentation, stat - st_size æ˜¯ä»€ä¹ˆç±»å‹, lineHeight and lineSpacing..."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Ckitakishi.playground"/></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">Ckitakishi.playground</a><nav><ul><li><a href="/">Home</a></li><li><a href="/posts" class="selected">Writing</a></li><li><a href="https://github.com/Ckitakishi?tab=repositories">Project</a></li><li><a href="/tags/æ±‚ç´¢é›†/">æ±‚ç´¢é›†</a></li><li><a href="/tags/æµ®ç”Ÿè®°/">æµ®ç”Ÿè®°</a></li><li><a href="/feed.rss">RSS</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><p>è®°å½•æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„</p><ol><li>æ–°çŸ¥</li><li>å¯¹æ—§çŸ¥è¯†çš„æ–°è®¤çŸ¥</li><li>é‡æ–°å”¤èµ·çš„è®°å¿†</li><li>review ä¸­é‡åˆ°çš„ä¸€äº›æœ‰è¶£çš„é—®é¢˜</li></ol><h1>05/30</h1><h2>byWordWrapping - å­¤ç‹¬çš„å•è¯</h2><p>æœ‰ä¸€æ®µç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼Œå’Œä¸€ä¸ªå­—ç¬¦ä¸² â€œThis message could not be deliveredâ€ï¼Œå‡è®¾ label çš„å®½åº¦æ­£å¥½ä¼šå¯¼è‡´å­—ç¬¦ä¸²åœ¨ delivered å‰è¢«æˆªæ–­ã€‚</p><pre><code>label.<span class="property">numberOfLines</span> = <span class="number">0</span>
label.<span class="property">lineBreakMode</span> = .<span class="dotAccess">byWordWrapping</span>
</code></pre><p>è¿™æ—¶å€™ï¼Œä¸‹é¢è¿™æ ·çš„æ¢è¡Œæ–¹å¼æ˜¯ä¸ä¼šå‡ºç°çš„ï¼š</p><pre><code><span class="type">This</span> message could not be
delivered
</code></pre><p>å®é™…ä¸Šå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯ä»¥ä¸‹ï¼š</p><pre><code><span class="type">This</span> message could not 
be delivered
</code></pre><p>ä¹ä¸€çœ‹ï¼Œå¤šå°‘è®©äººæœ‰äº›æ‘¸ä¸ç€å¤´è„‘ï¼Œç„¶è€Œè¿™æ˜¯ä¸€ä¸ª Apple åˆ»æ„è€Œä¸ºä¹‹çš„è®¾è®¡ï¼Œç›®çš„åœ¨äºé¿å…å­¤è¯å¯¡è¡Œçš„å‡ºç°ã€‚å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="https://stackoverflow.com/questions/46200027/uilabel-wrong-word-wrap-in-ios-11">https://stackoverflow.com/questions/46200027/uilabel-wrong-word-wrap-in-ios-11</a></li></ul><p>ä¸ªäººè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„è®¾è®¡ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ä»»ä½•é€”å¾„å¯ä»¥ç¦æ­¢è¿™ç§æ¢è¡Œæ–¹å¼ï¼Œè¿™å¤šå°‘ä¼šå¸¦æ¥ä¸€äº›ä¸ä¾¿ï¼Œå¥½åœ¨ä» iOS 14 å¼€å§‹ï¼Œç»ˆäºå¯ä»¥é€šè¿‡è®¾ç½® <code>lineBreakStrategy</code> æ¥é¿å…è¿™æ ·çš„æ¢è¡Œã€‚</p><pre><code><span class="keyword">if #available</span>(iOS <span class="number">14.0</span>, *) {
    label.<span class="property">lineBreakStrategy</span> = []
}
</code></pre><hr><h1>05/27</h1><h2>fileSystemRepresentation</h2><p>æœ€è¿‘ä¾ç„¶åœ¨ä¸º ZIPFoundation åš zip64 çš„æ”¯æŒï¼Œå½“ä½¿ç”¨ <code>fopen</code> æ‰“å¼€æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ç±»ä¼¼ä¸‹è¿°çš„ä»£ç ã€‚åœ¨ POSIX ç³»ç»Ÿä¸­ç›´æ¥ä½¿ç”¨ <code>UTF8String</code> å¹¶ä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„åŠæ³•ï¼Œä½¿ç”¨ <code>fileSystemRepresentation</code> å…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ–‡ä»¶ç³»ç»Ÿçš„è§„èŒƒå½¢å¼ç„¶åç”¨ <code>UTF-8</code> ç¼–ç ä¼šæ¯”è¾ƒå®‰å…¨ã€‚</p><pre><code><span class="keyword">let</span> representation = <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">fileSystemRepresentation</span>(withPath: path)
<span class="keyword">let</span> file: <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">FILE</span>&gt; = <span class="call">fopen</span>(representation, <span class="string">"r+b"</span>)
</code></pre><p>å‚è€ƒé“¾æ¥ï¼š</p><ol><li><a href="https://objccn.io/issue-9-2/">https://objccn.io/issue-9-2/</a></li><li><a href="https://github.com/ZipArchive/ZipArchive/issues/326">https://github.com/ZipArchive/ZipArchive/issues/326</a><ul><li>è¿™å…¶ä¸­æåˆ°ä¸€ä¸ªçœŸå®å‘ç”Ÿçš„æ¡ˆä¾‹ï¼Œåœ¨ iOS 10.2 ä¸­ä½¿ç”¨ <code>UTF8String</code> æ¥åˆ›å»ºæ–‡ä»¶åï¼Œå¾ˆæœ‰å¯èƒ½åœ¨ iOS 10.3 ä¸Šæ— æ³•æ‰“å¼€ã€‚è¿™å…¶ä¸­çš„åŸå› ï¼Œå¤§æ¦‚ç‡åœ¨äº 10.2 çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ <code>HFS+</code>ï¼Œè€Œ 10.3 æ˜¯ <code>APFS</code>ã€‚</li></ul></li></ol><hr><h1>05/19</h1><h2>stat - st_size æ˜¯ä»€ä¹ˆç±»å‹</h2><p>è·å–æ–‡ä»¶å¤§å°çš„æ–¹å¼ï¼š</p><ol><li>FileAttributeKey</li></ol><pre><code><span class="keyword">let</span> attr = <span class="keyword">try</span> <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">attributesOfItem</span>(atPath: filePath)
<span class="keyword">let</span> fileSize = attr[<span class="type">FileAttributeKey</span>.<span class="property">size</span>] <span class="keyword">as</span>? <span class="type">UInt64</span>
</code></pre><ol start="2"><li>stat</li></ol><pre><code><span class="keyword">let</span> representation = <span class="type">FileManager</span>.<span class="property">default</span>.<span class="call">fileSystemRepresentation</span>(withPath: filePath)
<span class="keyword">var</span> fileStat = <span class="call">stat</span>()
<span class="call">lstat</span>(representation, &amp;fileStat)
<span class="keyword">let</span> fileSize = fileStat.<span class="property">st_size</span>
</code></pre><ul><li>å…³äº <code>st_size</code> çš„ç±»å‹ï¼Œæ ¹æ® link1ï¼Œå®ƒæ˜¯ <code>off_t</code>ï¼›æ ¹æ® link2ï¼Œ<code>off_t</code> æ˜¯ <code>__darwin_off_t</code> ï¼›æ ¹æ®æœ€åä¸€ä¸ª linkï¼Œå¯ä»¥çŸ¥é“å…¶å®æ˜¯ <code>int64</code> ã€‚å¿…é¡»è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡ç”¨äºè¡¨ç¤º sizeï¼Œå®ƒå¹¶éä¸€ä¸ªæ— ç¬¦å·çš„æ•°ã€‚<ol><li><a href="https://opensource.apple.com/source/xnu/xnu-4570.41.2/bsd/sys/stat.h.auto.html">https://opensource.apple.com/source/xnu/xnu-4570.41.2/bsd/sys/stat.h.auto.html</a></li><li><a href="https://opensource.apple.com/source/xnu/xnu-2422.1.72/bsd/sys/_types/_off_t.h.auto.html">https://opensource.apple.com/source/xnu/xnu-2422.1.72/bsd/sys/<em>types/</em>off_t.h.auto.html</a></li><li><a href="https://opensource.apple.com/source/xnu/xnu-2782.30.5/bsd/sys/_types.h.auto.html">https://opensource.apple.com/source/xnu/xnu-2782.30.5/bsd/sys/_types.h.auto.html</a></li></ol></li></ul><hr><h1>05/14</h1><h2>AVPlayer</h2><p>ä¸€ç¯‡éå¸¸ç®€æ˜çš„é˜è¿°å¦‚ä½•ä½¿ç”¨ <code>AVPlayer</code> çš„æ–‡ç« ï¼š</p><p><a href="https://medium.com/free-code-camp/how-to-set-up-video-streaming-in-your-app-with-avplayer-7dc21bb82f3">https://medium.com/free-code-camp/how-to-set-up-video-streaming-in-your-app-with-avplayer-7dc21bb82f3</a></p><h2>HLS - HTTP Live Streaming</h2><p>HLS æ˜¯ä¸€ä¸ª Apple å®šä¹‰çš„æµä¼ è¾“åè®®ï¼ŒåŸºäº HTTP å®ç°ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒçš„åç¼€æ˜¯ <code>.m3u8</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨ <code>UTF-8</code> ç¼–ç çš„ Unicode ç‰ˆæœ¬ <code>M3U</code> ã€‚å¯¹äºè§†é¢‘æŠ€æœ¯çŸ¥ä¹‹ç”šå°‘çš„æˆ‘è€Œè¨€åˆè¦é—®ï¼Œé‚£ M3U æ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç»´åŸºï¼ŒM3U æ–‡ä»¶æ˜¯ä¸€ç§çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªå¤šåª’ä½“æ–‡ä»¶çš„ä½ç½®ã€‚</p><p>å…³äº HLS æ˜¯ä»€ä¹ˆï¼Œ<code>m3u8</code> çš„ç»“æ„æ˜¯ä»€ä¹ˆæ ·ï¼Œæ–‡æ¡£ä¸­çš„å›¾ç‰‡éå¸¸æ¸…æ™°æ˜“æ‡‚ï¼š<a href="https://developer.apple.com/library/archive/referencelibrary/GettingStarted/AboutHTTPLiveStreaming/about/about.html">https://developer.apple.com/library/archive/referencelibrary/GettingStarted/AboutHTTPLiveStreaming/about/about.html</a></p><p>HLS æ‹¥æœ‰é«˜æ€§èƒ½ï¼Œé«˜å…¼å®¹æ€§ï¼Œä½œä¸ºä»£ä»·ï¼Œåˆ‡ç‰‡å’ŒæŸ¥è¯¢å¯¼è‡´äº†è¾ƒé«˜çš„å»¶è¿Ÿã€‚2019 å¹´ï¼ŒApple ä»‹ç»äº†</p><p><a href="[https://developer.apple.com/videos/play/wwdc2019/502/](https://developer.apple.com/videos/play/wwdc2019/502/">ILow-Latency HLS</a>)ã€‚</p><hr><h1>05/13</h1><h2>lineHeight and lineSpacing</h2><p>æ— æ³•é€šè¿‡ <code>UILabel</code> çš„å±æ€§æ¥ç›´æ¥è®¾ç½®è¡Œé«˜ï¼Œä½†æ˜¯å¯ä»¥ä¸º Attributed String æ¥è®¾ç½®è¿™äº›å€¼ã€‚</p><p>é™¤äº† lineSpacingï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ lineHeight ç›¸å…³çš„å‡ ä¸ªå±æ€§ï¼Œä¾‹å¦‚:</p><pre><code>minimumLineHeight
maximumLineHeight
lineHeightMultiple
</code></pre><p>ä½†äº‹å®ä¸Š iOS çš„è¡Œé«˜å’Œ CSS Flexbox ä¸­ä»¥åŠé€šå¸¸è®¤çŸ¥ä¸­çš„è¡Œé«˜å¹¶ä¸å®Œå…¨ç›¸åŒã€‚å‚è§ä¸‹å›¾ï¼š</p><p>æ‰€ä»¥å¦‚æœéœ€è¦é€šå¸¸æ„ä¹‰ä¸Šçš„è¡Œé«˜ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® baselineOffset æ¥å®ç°ã€‚</p><pre><code><span class="keyword">let</span> paragraphStyle = <span class="type">NSMutableParagraphStyle</span>()
paragraphStyle.<span class="property">lineHeightMultiple</span> = <span class="number">1.6</span>

label.<span class="property">attributedText</span> = <span class="type">NSAttributedString</span>(
    string: <span class="string">"......"</span>,
    attributes: [
        .<span class="dotAccess">baselineOffset</span>: ......,
        .<span class="dotAccess">paragraphStyle</span>: paragraphStyle
    ]
)
</code></pre><hr><h1>05/07</h1><h2>Apple's Compression Algorithms</h2><p>å½“è®¨è®ºä¸€ä¸ªå‹ç¼©ç®—æ³•çš„æ—¶å€™ï¼Œå‹ç¼©ç‡å’Œé€Ÿåº¦æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªç»´åº¦ã€‚</p><p>Apple è‡ªå·±çš„å‹ç¼©æ¡†æ¶ä¹Ÿæä¾›äº†å¤šç§ç®—æ³•:</p><blockquote><p>WWDC2015 Session 712</p></blockquote><p>Balanced: <code>zlib</code> and <code>lzfse</code> High compression, slow: <code>lzma</code> Low compression, fast: <code>lz4</code></p><hr><h1>05/06</h1><h2>setUp()/tearDown()</h2><ul><li>instance method: each test method</li><li>class method: all test methods</li></ul><h2>globallyUniqueString</h2><p>ä¸€èˆ¬æ¥è¯´æåˆ°å”¯ä¸€æ ‡å¿—ç¬¦æˆ‘ä»¬å¸¸å¸¸ä¼šå…ˆæƒ³åˆ° <code>UUID</code> ï¼Œä¾‹å¦‚ç”¨ä¸‹è¿°æ–¹æ³•æ¥ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„å­—ç¬¦ä¸²ï¼š</p><pre><code><span class="type">UUID</span>().<span class="property">uuidString</span>
</code></pre><p>ä½†å¦‚æœæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä½¿ç”¨è¿›ç¨‹çº§åˆ«çš„å”¯ä¸€å­—ç¬¦ä¸²ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªå¥½åŠæ³•ã€‚å…¶ä¸­åŒ…å«äº†ä¸»æœºåï¼Œè¿›ç¨‹ IDï¼Œæ—¶é—´æˆ³ï¼Œæ¥ä¿è¯å…¶å”¯ä¸€æ€§ã€‚</p><pre><code><span class="type">ProcessInfo</span>.<span class="property">processInfo</span>.<span class="property">globallyUniqueString</span>
</code></pre></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/æ±‚ç´¢é›†">æ±‚ç´¢é›†</a></li><li><a href="/tags/ios">iOS</a></li><li><a href="/tags/swift">Swift</a></li><li><a href="/tags/til">TIL</a></li></ul></article></div><footer><p>Copyright Â© 2014-2022 Ckitakishi ğŸ¥‘ Powered by <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>