<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Ckitakishi"/><link rel="canonical" href="ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-2"/><meta name="twitter:url" content="ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-2"/><meta name="og:url" content="ckitakishi.com/posts/%E5%AE%89%E5%85%A8%E4%B8%94%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8-NSAttributedString-Part-2"/><title>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2 | Ckitakishi</title><meta name="twitter:title" content="å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2 | Ckitakishi"/><meta name="og:title" content="å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2 | Ckitakishi"/><meta name="description" content="åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚åœ¨ Part.2 ä¸­å°†ä¼šé’ˆå¯¹æ›´ä¼˜é›…åœ°ä½¿ç”¨ `NSAttributedString` å†å‘å‰è¿ˆè¿›ä¸€æ­¥ã€‚"/><meta name="twitter:description" content="åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚åœ¨ Part.2 ä¸­å°†ä¼šé’ˆå¯¹æ›´ä¼˜é›…åœ°ä½¿ç”¨ `NSAttributedString` å†å‘å‰è¿ˆè¿›ä¸€æ­¥ã€‚"/><meta name="og:description" content="åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚åœ¨ Part.2 ä¸­å°†ä¼šé’ˆå¯¹æ›´ä¼˜é›…åœ°ä½¿ç”¨ `NSAttributedString` å†å‘å‰è¿ˆè¿›ä¸€æ­¥ã€‚"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Ckitakishi"/></head><body class="item-page"><div class="flex flex-col min-h-full text-zinc-900 dark:text-zinc-50"><div class="grid grid-cols-8 w-full h-[8px]"><div class="bg-[#ab4642]"></div><div class="bg-[#dc9656]"></div><div class="bg-[#f7ca88]"></div><div class="bg-[#a1b56c]"></div><div class="bg-[#86c1b9]"></div><div class="bg-[#7cafc2]"></div><div class="bg-[#ba8baf]"></div><div class="bg-[#a16946]"></div></div><header class="flex justify-center p-4 text-zinc-900 dark:text-zinc-50"><div class="flex flex-wrap justify-between my-4 gap-x-16 max-w-screen-lg w-full"><a href="/" class="header-title font-extrabold text-3xl">Ckitakishi</a><nav class="my-auto"><ul class="flex flex-wrap gap-4"><li><a href="/" class="hover:underline underline-offset-4">Home</a></li><li><a href="/posts" class="hover:underline underline-offset-4">Writing</a></li><li><a href="/tags/æ±‚ç´¢é›†/" class="hover:underline underline-offset-4">æ±‚ç´¢é›†</a></li><li><a href="/tags/æµ®ç”Ÿè®°/" class="hover:underline underline-offset-4">æµ®ç”Ÿè®°</a></li><li><a href="/feed.rss" class="hover:underline underline-offset-4">RSS</a></li></ul></nav></div></header><div class="flex justify-center mx-4"><div class="max-w-screen-md w-full m-4"><div class="flex text-zinc-600 dark:text-zinc-50 mb-1"><p class="flex shrink-0">Jun 27, 2020</p><p class="mx-3 text-lg -mt-0.5">|</p><ul class="flex flex-wrap gap-2"><li><a href="/tags/æ±‚ç´¢é›†" class="hashtag link-underline">æ±‚ç´¢é›†</a></li><li><a href="/tags/ios" class="hashtag link-underline">iOS</a></li><li><a href="/tags/swift" class="hashtag link-underline">Swift</a></li></ul></div><article class="prose prose-zinc min-w-full dark:prose-invert"><div class="content"><h1>å®‰å…¨ä¸”ä¼˜é›…åœ°ä½¿ç”¨ NSAttributedString - Part.2</h1><p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å®‰å…¨ä¸”ä¼˜é›…åœ°å®šä¹‰ä¸€ä¸ªå±æ€§å­—ç¬¦ä¸²ã€‚ä¸è¿‡åœ¨å®é™…çš„è¿ç”¨åœºæ™¯ä¸­ï¼Œæƒ…å†µå¾€å¾€ä¼šæ›´å¤æ‚ä¸€äº›ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”±å¾ˆå¤šå±æ€§ä¸åŒçš„éƒ¨åˆ†æ„æˆçš„å®Œæ•´å­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯æƒ³è¦å®ç°å›¾æ–‡æ··æ’ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä¸å¯é¿å…çš„éœ€è¦å°†æ‰€æœ‰éƒ¨åˆ†ç»„è£…åœ¨ä¸€èµ·ï¼Œæœ€åŸºç¡€çš„æ–¹æ³•æ˜¯åˆ›å»º <code>NSMutableAttributedString</code> ï¼Œç„¶åé€šè¿‡ <code>append(_:)</code> æ–¹æ³•æ¥å®Œæˆå­—ç¬¦ä¸²çš„æ„å»ºã€‚ç®€å•æ˜“æ‡‚æ˜¯å®ƒçš„æœ‰ç‚¹ï¼Œç„¶è€Œä¸çŸ¥ä¸è§‰ä¸­å¯èƒ½å°±ä¼šå†™å‡ºç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p><pre><code><span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: str1)
mutableAttributedString.<span class="call">append</span>(str2)
mutableAttributedString.<span class="call">append</span>(str3)
mutableAttributedString.<span class="call">append</span>(str4)
...
</code></pre><p>è¿™æ®µä»£ç å¤šå°‘æœ‰ä¸€äº›ç¹é‡æ„Ÿï¼Œä¹Ÿä¸å¤Ÿç›´è§‚ï¼Œæœ‰å¾ˆå¤§çš„ä¼˜åŒ–ä½™åœ°ã€‚æ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œä¹Ÿè®¸ä¸€åƒä¸ªå¼€å‘è€…å°±æœ‰ä¸€åƒç§æ”¹å–„çš„æ€è·¯ï¼Œæ¥ä¸‹æ¥æƒ³è¦è®¨è®ºä¸¤ç§æ›´ä¼˜é›…çš„æ–¹æ¡ˆï¼Œåˆ†åˆ«å€ŸåŠ›äºæšä¸¾ (Enum) å’Œ å­—ç¬¦ä¸²æ’å€¼ (StringInterpolation)ã€‚</p><h2>æšä¸¾</h2><p>å’Œå‰æ–‡ç±»ä¼¼ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å†æ¬¡å®šä¹‰ä¸€ä¸ªæšä¸¾æ¥ä¼˜åŒ–ä»£ç çš„å¯è¯»æ€§ã€‚æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œå®šä¹‰ä¸€äº›å¸¸ç”¨çš„ caseï¼Œåªå®šä¹‰å­—ç¬¦ä¸²å®åœ¨æ˜¯æœ‰ä¸€äº›å­¤ç‹¬ï¼Œæˆ‘ä»¬å¯ä»¥å†è¿½åŠ ä¸€ä¸ªç”¨äºæ’å›¾çš„ caseï¼š</p><pre><code><span class="keyword">enum</span> AttributedString {
    <span class="keyword">case</span> string(<span class="type">String</span>, [<span class="type">StringAttribute</span>]?)
    <span class="keyword">case</span> image(<span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span> = <span class="number">0.0</span>, offsetY: <span class="type">CGFloat</span> = <span class="number">0.0</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>)
    
    <span class="keyword">static func</span> assemble(<span class="keyword">_</span> attrStrings: [<span class="type">AttributedString</span>]) -&gt; <span class="type">NSAttributedString</span> {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(string: <span class="string">""</span>)
        attrStrings.<span class="call">forEach</span> { (attrString: <span class="type">AttributedString</span>) <span class="keyword">in
            switch</span> attrString {
            <span class="keyword">case</span> .<span class="dotAccess">string</span>(<span class="keyword">let</span> string, <span class="keyword">let</span> attributes):
                mutableAttributedString.<span class="call">append</span>(.<span class="keyword">init</span>(string: string, attributes: attributes?.<span class="property">attributesDictionary</span>))
            <span class="keyword">case</span> .<span class="dotAccess">image</span>(<span class="keyword">let</span> image, <span class="keyword">let</span> offsetX, <span class="keyword">let</span> offsetY, <span class="keyword">let</span> scale):
                mutableAttributedString.<span class="call">append</span>(.<span class="keyword">init</span>(image: image, offsetX: offsetX, offsetY: offsetY, scale: scale))
            }
        }
        <span class="keyword">return</span> mutableAttributedString
    }
}

<span class="keyword">extension</span> <span class="type">NSAttributedString</span> {
    <span class="keyword">convenience init</span>(image: <span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span>, offsetY: <span class="type">CGFloat</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>) {
        <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()
        
        <span class="keyword">let</span> size: <span class="type">CGSize</span> = {
            <span class="keyword">guard</span> scale != <span class="number">1.0</span> <span class="keyword">else</span> { <span class="keyword">return</span> image.<span class="property">size</span> }
            <span class="keyword">return</span> image.<span class="property">size</span>.<span class="call">applying</span>(<span class="type">CGAffineTransform</span>(scaleX: scale, y: scale))
        }()
        
        attachment.<span class="property">bounds</span> = .<span class="keyword">init</span>(origin: .<span class="keyword">init</span>(x: offsetX, y: offsetY), size: size)
        attachment.<span class="property">image</span> = image
        
        <span class="keyword">self</span>.<span class="keyword">init</span>(attachment: attachment)
    }
}
</code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œå³ç®€å•æ˜äº†ï¼Œè¿˜å¯ä»¥é¿å…å¾ˆå¤šæ™¦æ¶©ä¸”é‡å¤çš„ä»£ç ã€‚</p><pre><code>xxxxxx.<span class="property">attributedText</span> = <span class="type">AttributedString</span>.<span class="call">assemble</span>([
    .<span class="call">image</span>(<span class="type">UIImage</span>(named: <span class="string">"stop"</span>) ?? <span class="type">UIImage</span>(), offsetX: <span class="number">0.0</span>, offsetY: -<span class="number">8.0</span>, scale: <span class="number">0.5</span>),
    .<span class="call">string</span>(<span class="string">"è¸Ÿè¹°ä¸å¦‚"</span>, [ .<span class="call">foregroundColor</span>(.<span class="dotAccess">gray</span>) ]),
    .<span class="call">string</span>(<span class="string">"åœæ­¢æŠ±æ­‰"</span>, [ .<span class="call">foregroundColor</span>(.<span class="dotAccess">orange</span>) ])
])
</code></pre><h2>å­—ç¬¦ä¸²æ’å€¼ (StringInterpolation)</h2><p>ç›¸è¾ƒäºæšä¸¾ï¼Œå€ŸåŠ©å­—ç¬¦ä¸²æ’å€¼çš„æ–¹æ³•ä¸ä¼šé‚£ä¹ˆç›´è§‚ã€‚è¿™æ˜¯ä¸€ä¸ª Swift 5 çš„æ–°ç‰¹æ€§ï¼Œåˆè§ä¹‹æ—¶æˆ‘å…¶å®å¹¶æ²¡æœ‰å½»åº•æ„Ÿå—åˆ°å­—ç¬¦ä¸²æ’å€¼çš„å¼ºå¤§ï¼Œç§ä»¥ä¸ºåªæ˜¯èƒ½å¤Ÿå°†ä¸€äº›å­—ç¬¦ä¸²çš„å…±é€šå¤„ç†å†™çš„æ›´ä¼˜é›…ï¼Œå°½ç®¡è¿™ä¹Ÿè¶³ä»¥ä»¤äººæ¬£å–œã€‚ç›´åˆ°å¾ˆä¹…ä¹‹åè¯»äº† <a href="https://nshipster.com/expressiblebystringinterpolation/">ExpressibleByStringInterpolation</a>ï¼Œæ‰çœŸæ˜¯ç†è§£äº†ä¸€äº›å­—ç¬¦ä¸²æ’å€¼ä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä¾¿åˆ©ã€‚æ–‡ä¸­å…³äºå­—ç¬¦ä¸²æ’å€¼åˆçº§ä½¿ç”¨æ‰€ä¸¾çš„ä¾‹å­ååˆ†å·§å¦™ï¼Œå¾ˆä¼˜é›…çš„é¿å¼€äº† <code>DateFormatter</code> æ ¼å¼å®šä¹‰çš„å‘ã€‚ä½†å­—ç¬¦ä¸²æ’å€¼çš„èƒ½åŠ›æ›´å¤šä½“ç°åœ¨è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼ç±»å‹ä¸­ã€‚</p><p>ç”±äºæˆ‘ä»¬æœŸå¾…çš„æ’å€¼ç±»å‹æ˜¯å±æ€§å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»å®šä¹‰ç»“æ„ä½“å¼€å§‹ç€æ‰‹ï¼Œé¦–å…ˆä¸ºè¯¥ç»“æ„ä½“å®šä¹‰ä¸€ä¸ª <code>NSAttributedString</code> ç±»å‹çš„å±æ€§ï¼š</p><pre><code><span class="keyword">struct</span> AttributedString {
    <span class="keyword">var</span> attributedString: <span class="type">NSAttributedString</span>
}
</code></pre><p>æ­¤æ—¶éœ€è¦äº†è§£ä¸¤ä¸ªåè®®ï¼š<code>ExpressibleByStringLiteral</code> å’Œ <code>ExpressibleByStringInterpolation</code>ï¼Œåè€…ç»§æ‰¿äºå‰è€…ï¼ŒäºŒè€…åˆ†åˆ«æœ‰ä¸€ä¸ªå¿…é¡»å®ç°çš„åˆå§‹åŒ–æ–¹æ³•ï¼š</p><pre><code><span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringLiteral</span> {
    <span class="keyword">init</span>(stringLiteral: <span class="type">String</span>) {
        <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSAttributedString</span>(string: stringLiteral)
    }
}

<span class="comment">// ExpressibleByStringInterpolation inherits from ExpressibleByStringLiteral</span>
<span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringInterpolation</span> {
    <span class="keyword">init</span>(stringInterpolation: <span class="type">StringInterpolation</span>) {
        <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSAttributedString</span>(attributedString: stringInterpolation.<span class="property">attributedString</span>)
    }
}
</code></pre><p>å­—é¢é‡éƒ¨åˆ†åªéœ€è¦åˆå§‹åŒ–æ–¹æ³•å³å¯ï¼Œæ’å€¼çš„æƒ…å†µä¸‹è‡ªç„¶ä¼šå¤æ‚ä¸€äº›ï¼Œä»åˆå§‹åŒ–æ–¹æ³•æ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªå…³è”ç±»å‹å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚<code>StringInterpolation</code> æ‰çœŸæ­£åœ¨è´Ÿè´£åœ¨å¤„ç†æ’å€¼ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯å°†å„ä¸ªç»„æˆéƒ¨åˆ†é€šè¿‡ä¸€ç³»åˆ— append æ–¹æ³•ç»„è£…èµ·æ¥ï¼Œå†ä½œä¸ºå‚æ•°ä¼ ç»™ä¸Šé¢çš„åˆå§‹åŒ–æ–¹æ³• <code>init(stringInterpolation:)</code>ã€‚<code>appendLiteral(_:)</code> çš„èŒè´£æ˜¯å¤„ç†æ™®é€šçš„å­—ç¬¦ä¸²å­—é¢é‡ï¼Œåä¸º <code>appendInterpolation</code> çš„æ–¹æ³•ä»¬åˆ™æ˜¯æ‰¿æ‹…äº†å¤„ç†ç±»å‹äº”èŠ±å…«é—¨çš„æ’å€¼çš„ä»»åŠ¡ã€‚</p><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå°±åˆ†åˆ«ä¸ºå­—ç¬¦ä¸²åŠå…¶å±æ€§ï¼Œå›¾ç‰‡å®šä¹‰äº†ä¸åŒçš„ <code>appendInterpolation</code> æ–¹æ³•ï¼š</p><pre><code><span class="keyword">extension</span> <span class="type">AttributedString</span>: <span class="type">ExpressibleByStringInterpolation</span> {
    <span class="comment">// Custom String Interpolation Type</span>
    <span class="keyword">struct</span> StringInterpolation: <span class="type">StringInterpolationProtocol</span> {
        <span class="keyword">var</span> attributedString: <span class="type">NSMutableAttributedString</span>
        
        <span class="keyword">init</span>(literalCapacity: <span class="type">Int</span>, interpolationCount: <span class="type">Int</span>) {
            <span class="keyword">self</span>.<span class="property">attributedString</span> = <span class="type">NSMutableAttributedString</span>()
        }

        <span class="keyword">mutating func</span> appendLiteral(<span class="keyword">_</span> literal: <span class="type">String</span>) {
            <span class="keyword">let</span> attrString = <span class="type">NSAttributedString</span>(string: literal)
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(attrString)
        }
        
        <span class="keyword">mutating func</span> appendInterpolation(<span class="keyword">_</span> string: <span class="type">String</span>, stringAttributes: [<span class="type">StringAttribute</span>]) {
            <span class="keyword">let</span> attrString = <span class="type">NSAttributedString</span>(string: string,
                                                stringAttributes: stringAttributes)
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(attrString)
        }
        
        <span class="comment">// for UIImage</span>
        <span class="keyword">mutating func</span> appendInterpolation(image: <span class="type">UIImage</span>, offsetX: <span class="type">CGFloat</span>, offsetY: <span class="type">CGFloat</span>, scale: <span class="type">CGFloat</span> = <span class="number">1.0</span>) {
            <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()
            
            <span class="keyword">let</span> size: <span class="type">CGSize</span> = {
                <span class="keyword">guard</span> scale != <span class="number">1.0</span> <span class="keyword">else</span> { <span class="keyword">return</span> image.<span class="property">size</span> }
                <span class="keyword">return</span> image.<span class="property">size</span>.<span class="call">applying</span>(<span class="type">CGAffineTransform</span>(scaleX: scale, y: scale))
            }()
            
            attachment.<span class="property">bounds</span> = .<span class="keyword">init</span>(origin: .<span class="keyword">init</span>(x: offsetX, y: offsetY), size: size)
            attachment.<span class="property">image</span> = image
        
            <span class="keyword">self</span>.<span class="property">attributedString</span>.<span class="call">append</span>(<span class="type">NSAttributedString</span>(attachment: attachment))
        }
    }
}
</code></pre><p>å…³äº <code>appendLiteral(_:)</code> æ–¹æ³•ï¼Œæœ‰ä¸€ç‚¹ä¸å¾—ä¸è¯´ï¼Œå¦‚æœæƒ³è¦åœ¨å…¶ä¸­åšé™¤äº† append ä¹‹å¤–çš„äº‹ï¼ŒåŠ¡å¿…è¦ä¸‡åˆ†å°å¿ƒï¼Œé™¤äº†æ˜¾ç„¶å¯è§çš„å­—é¢é‡ä¹‹å¤–ï¼Œç©ºæ ¼ï¼Œæ¢è¡Œï¼Œç”šè‡³æ˜¯å­—ç¬¦ä¸²å‰åçš„ä¸å¯è§éƒ¨åˆ†éƒ½ä¼šå—åˆ°å…¶å½±å“ã€‚</p><p>ä¸¥æ ¼æ„ä¹‰ä¸Šæˆ‘ä»¬å·²ç»å®Œæˆäº†ç”¨å­—ç¬¦ä¸²æ’å€¼çš„æ–¹æ³•æ¥ç»„è£…å±æ€§å­—ç¬¦ä¸²ï¼Œå®åœ¨æ˜¯æœ‰äº›ä»¤äººæ¿€åŠ¨ï¼ä¸å¦‚è¶çƒ­æ‰“é“ï¼Œé¡ºæ‰‹æ·»åŠ ä¸¤ä¸ªä¾¿åˆ©æ–¹æ³•ï¼Œä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿå†æå‡ä¸€ç‚¹ç‚¹çµæ´»åº¦ã€‚</p><pre><code><span class="keyword">struct</span> AttributedString {
    <span class="keyword">var</span> attributedString: <span class="type">NSAttributedString</span>
    
    <span class="keyword">mutating func</span> append(<span class="keyword">_</span> newStr: <span class="type">AttributedString</span>) {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: attributedString)
        mutableAttributedString.<span class="call">append</span>(newStr.<span class="property">attributedString</span>)
        <span class="keyword">self</span>.<span class="property">attributedString</span> = mutableAttributedString
    }
    
    <span class="keyword">mutating func</span> append(contentsOf newStrs: [<span class="type">AttributedString</span>]) {
        <span class="keyword">let</span> mutableAttributedString = <span class="type">NSMutableAttributedString</span>(attributedString: attributedString)
        newStrs.<span class="call">forEach</span> { str <span class="keyword">in</span>
            mutableAttributedString.<span class="call">append</span>(str.<span class="property">attributedString</span>)
        }
        <span class="keyword">self</span>.<span class="property">attributedString</span> = mutableAttributedString
    }
}
</code></pre><p>åˆ°è¿™é‡Œï¼Œç»„è£…å±æ€§å­—ç¬¦ä¸²çš„è¿‡ç¨‹å˜å¾—ä¼˜é›…ä¸”çµæ´»äº†ä¸€äº›ã€‚</p><pre><code><span class="keyword">var</span> attrString1: <span class="type">AttributedString</span> = <span class="string">"""</span>
\(<span class="string">"è¸Ÿè¹°ä¸å¦‚", stringAttributes: [ .foregroundColor(.systemGray), .font(.systemFont(ofSize: 14.0)) ])</span>
\(<span class="string">"åœæ­¢æŠ±æ­‰", stringAttributes: [ .foregroundColor(.systemGray2), .font(.systemFont(ofSize: 14.0)) ])
"""</span>

<span class="keyword">let</span> attrString2: <span class="type">AttributedString</span> = <span class="string">"""</span>
\(image<span class="string">: UIImage(named: "stop") ?? UIImage(), offsetX: 0.0, offsetY: 0.0, scale: 0.5)</span>
\(<span class="string">"å†è¿‡ç§‹å¤©", stringAttributes: [ .foregroundColor(.systemGray3), .font(.systemFont(ofSize: 14.0)) ])</span>
\(<span class="string">"çƒ‚äº†èœ¿èœ’", stringAttributes: [ .foregroundColor(.systemGray4), .font(.systemFont(ofSize: 14.0)) ])
"""</span>

attrString1.<span class="call">append</span>(attrString2)

xxxxxlabel.<span class="property">attributedText</span> = attrString1.<span class="property">attributedString</span>
</code></pre><h2>å°¾å£°</h2><p>æˆ‘æƒ³å¾ˆå¤šäººå¯¹å±æ€§å­—ç¬¦ä¸²çš„æ„Ÿæƒ…åº”è¯¥æ˜¯çˆ±æ¨äº¤ç»‡çš„ï¼Œå¸Œæœ›è¿™ä¸¤ç¯‡æ–‡ç« èƒ½ä¸ºå®ƒæ‹‰å›å‡ å¼ çš„ç¥¨...ğŸ˜‚</p><blockquote><p>Source Code: https://github.com/Ckitakishi/PlayWithAttributedString</p></blockquote></div></article><div class="giscus mt-20"></div></div></div><footer class="flex flex-col text-sm font-light mt-auto text-zinc-500 dark:text-zinc-400"><p class="text-center mt-16">Copyright Â© 2014-2022 Ckitakishi</p><p class="text-center mt-1">Powered by <a href="https://github.com/johnsundell/publish" class="link-underline">Publish</a> &amp; <a href="https://github.com/Ckitakishi/PaletteTheme" class="link-underline">Palette</a></p><div class="grid grid-cols-8 w-full h-[8px] mt-6"><div class="bg-[#ab4642]"></div><div class="bg-[#dc9656]"></div><div class="bg-[#f7ca88]"></div><div class="bg-[#a1b56c]"></div><div class="bg-[#86c1b9]"></div><div class="bg-[#7cafc2]"></div><div class="bg-[#ba8baf]"></div><div class="bg-[#a16946]"></div></div></footer></div><script src="https://giscus.app/client.js"
        data-repo="Ckitakishi/Ckitakishi.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNTU4Njk1OQ=="
        data-category="General"
        data-category-id="DIC_kwDOAO3Wj84CBSR7"
        data-mapping="title"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script></body></html>