<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Ckitakishi.playground"/><link rel="canonical" href="ckitakishi.com/posts/TIL-%E5%B9%B4%E5%A4%8D%E4%B8%80%E5%B9%B4%E6%84%8F%E8%AF%86%E5%88%B0%E6%88%90%E9%95%BF%E7%9A%84%E5%9 ... E6%9C%88"/><meta name="twitter:url" content="ckitakishi.com/posts/TIL-%E5%B9%B4%E5%A4%8D%E4%B8%80%E5%B9%B4%E6%84%8F%E8%AF%86%E5%88%B0%E6%88%90%E9%95%BF%E7%9A%84%E5%9 ... E6%9C%88"/><meta name="og:url" content="ckitakishi.com/posts/TIL-%E5%B9%B4%E5%A4%8D%E4%B8%80%E5%B9%B4%E6%84%8F%E8%AF%86%E5%88%B0%E6%88%90%E9%95%BF%E7%9A%84%E5%9 ... E6%9C%88"/><title>[TIL] å¹´å¤ä¸€å¹´æ„è¯†åˆ°æˆé•¿çš„å››æœˆ | Ckitakishi.playground</title><meta name="twitter:title" content="[TIL] å¹´å¤ä¸€å¹´æ„è¯†åˆ°æˆé•¿çš„å››æœˆ | Ckitakishi.playground"/><meta name="og:title" content="[TIL] å¹´å¤ä¸€å¹´æ„è¯†åˆ°æˆé•¿çš„å››æœˆ | Ckitakishi.playground"/><meta name="description" content="ä¸ƒæœˆä¸»é¢˜ï¼šUniform Type Identifierï¼Œautoreleasepool, ZIPFoundation(ZIP64), CRC32 (Cyclic redundancy check), SQL - Prepared Statement, Attributes in Swift..."/><meta name="twitter:description" content="ä¸ƒæœˆä¸»é¢˜ï¼šUniform Type Identifierï¼Œautoreleasepool, ZIPFoundation(ZIP64), CRC32 (Cyclic redundancy check), SQL - Prepared Statement, Attributes in Swift..."/><meta name="og:description" content="ä¸ƒæœˆä¸»é¢˜ï¼šUniform Type Identifierï¼Œautoreleasepool, ZIPFoundation(ZIP64), CRC32 (Cyclic redundancy check), SQL - Prepared Statement, Attributes in Swift..."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Ckitakishi.playground"/></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">Ckitakishi.playground</a><nav><ul><li><a href="/">Home</a></li><li><a href="/posts" class="selected">Writing</a></li><li><a href="https://github.com/Ckitakishi?tab=repositories">Project</a></li><li><a href="/tags/æ±‚ç´¢é›†/">æ±‚ç´¢é›†</a></li><li><a href="/tags/æµ®ç”Ÿè®°/">æµ®ç”Ÿè®°</a></li><li><a href="/feed.rss">RSS</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><p>è®°å½•æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„ 1. æ–°çŸ¥ 2. å¯¹æ—§çŸ¥è¯†çš„æ–°è®¤çŸ¥ 3. é‡æ–°å”¤èµ·çš„è®°å¿† 4. review ä¸­é‡åˆ°çš„ä¸€äº›æœ‰è¶£çš„é—®é¢˜</p><h1>04/23</h1><hr><h2>UTI - Uniform Type Identifier</h2><p>åŒäº‹åœ¨åˆ†äº«ä¼šä¸­è¯¦ç»†è®²äº† UTIï¼Œç”¨è¿‡å¾ˆå¤šæ¬¡ï¼Œä½†å¤§æ¦‚ä¸€ç›´éƒ½åªæ‡‚ä¸‰æˆå§ï¼Œå¬å®Œåå¯¹ UTI çš„ç†è§£æ˜æ˜¾æ›´ç³»ç»ŸåŒ–äº†ä¸€äº›XD</p><p>èƒ½ä¸€ç¬é—´æƒ³èµ·æ¥çš„è¿ç”¨åœºæ™¯æœ‰ï¼š</p><ol><li>Share Extension</li><li>Drag and Drop</li><li>Pasteboard</li></ol><p>ç®€å•æ¥è¯´ï¼Œå¯¹äºæ–‡æœ¬ç±»å‹è€Œè¨€ï¼Œæ‰©å±•åå¯ä»¥æ˜¯ <code>.txt</code> æˆ– <code>.text</code>ï¼Œè€Œ MIME ç±»å‹æ˜¯ <code>text/plain</code>ï¼Œå½“æˆ‘ä»¬è¦å¤„ç†æ–‡æœ¬ç±»å‹æ—¶ï¼Œå¿…é¡»å°†ä»¥ä¸Šæ‰€æœ‰ç±»å‹å…¨éƒ¨è§†ä¸ºå¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä»¶éå¸¸ç¼ºä¹æ•ˆç‡çš„äº‹æƒ…ï¼Œè€Œ UTI å°±æ˜¯ç”¨æ¥å¤„ç†è¿™ä¸ªé—®é¢˜çš„ï¼Œä»–å°†æ‰€æœ‰ç±»å‹éƒ½ç»Ÿä¸€ä¸ºäº† <code>public.text</code>ï¼ŒUTI ç±»å‹å’Œå…¶ä»–æ‰€æœ‰ç±»å‹ç›¸äº’å…¼å®¹ã€‚</p><p>Refï¼šå…³äºè‡ªå®šä¹‰ UTI ç±»å‹ï¼ŒUTI ç±»å‹çš„ç»§æ‰¿æ€§ â€” <a href="https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html">https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding<em>utis/understand</em>utis<em>conc/understand</em>utis_conc.html</a></p><h1>04/20</h1><hr><h2>autoreleasepool</h2><p>æœ€è¿‘åšäº†ä¸€ç‚¹ Objective-C è½¬ Swiftï¼Œåœ¨ Objective-C ä¸­æˆ‘ä»¬å¸¸å¸¸ä¼šéœ€è¦ä½¿ç”¨ autoreleasepoolï¼Œä½†å¹¶ä¸æ„å‘³ç€é‡åˆ° Swift ä¹‹å <code>autoreleasepool</code> å°±ä¸å†éœ€è¦è€ƒè™‘ã€‚å½“ Swift è°ƒç”¨ Objective-C ä»£ç ï¼Œäº¦æˆ–æ˜¯ Objective-C è°ƒç”¨è¢«æ ‡è®°ä¸º @objc çš„ Swift æ–¹æ³•æ—¶ï¼Œå¦‚æœæ–¹æ³•è¿”å›çš„æ˜¯ autorelease çš„å€¼ï¼Œé‚£ Swift ä¹Ÿä¼šä¿æŒè¿™ä¸ªå€¼çš„ autorelease ç‰¹æ€§ã€‚</p><p>åœ¨ Objective-C ä¸­ï¼Œæœ‰æ—¶å€™ä¼šåœ¨å¾ªç¯ä¸­å†™ <code>autoreleasepool</code> æ¥é¿å…å†…å­˜çˆ†ç‚¸ï¼Œå› ä¸ºå¾ªç¯çš„æŒç»­ä¼šå¯¼è‡´æ²¡æœ‰æœºä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€‚</p><h1>04/15</h1><hr><h2>ZIPFoundation</h2><p><a href="https://thomas.zoechling.me/journal/2017/07/ZIPFoundation.html">https://thomas.zoechling.me/journal/2017/07/ZIPFoundation.html</a></p><p>A ZIP compression framework don't based on any 3rd party framework. Almost all of the swift ZIP framework based on minizip.</p><p>å°½ç®¡è¿™ä¸ªæ¡†æ¶ååˆ†ç®€æ´ç”šè‡³æ— æ³•å®Œå…¨æ»¡è¶³è¦æ±‚ï¼Œä½†ä½œè€…çš„è¿™ç¯‡æ–‡ç« è¿˜æ˜¯å¾ˆå€¼å¾—ä¸€è¯»ï¼Œåœ¨è®¾è®¡æ¡†æ¶æ—¶è€ƒè™‘çš„ä¸€äº›ç‚¹å¾ˆæœ‰å‚è€ƒä»·å€¼ã€‚</p><h2>ZIP64</h2><p><a href="https://en.wikipedia.org/wiki/ZIP_(file_format">https://en.wikipedia.org/wiki/ZIP<em>(file</em>format)#ZIP64</a>#ZIP64)</p><p>æ ‡å‡† ZIP æœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚ä¸èƒ½å®¹çº³è¶…è¿‡ 65535 ä¸ªæ–‡ä»¶ï¼ˆå› ä¸º eocd ä¸­åªæœ‰ 2 bytes ç”¨æ¥å­˜ entry çš„ä¿¡æ¯ã€‚ã€‚ï¼‰ï¼Œå‹ç¼©æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 4G ä¹‹ç±»ï¼Œå› æ­¤å‡ºç°äº† ZIP64 æ ‡å‡†ã€‚</p><h1>04/13</h1><hr><h2>CRC32 (Cyclic redundancy check)</h2><p>ZIP å‹ç¼©ä¸­ä½¿ç”¨çš„æ ¡éªŒæ–¹å¼æ˜¯ CRC32ï¼Œæ˜¯ CRCï¼ˆå¾ªç¯å†—ä½™æ ¡éªŒï¼‰æ–¹æ³•ä¸­çš„å…¶ä¸­ä¸€ç§ã€‚</p><p>è®°å¿†ä¸­ç¬¬ä¸€æ¬¡çŸ¥é“ CRC æ˜¯åœ¨å¯†ç å­¦çš„è¯¾æœ¬ä¸Šï¼Œå¥‡å¶æ ¡éªŒï¼Œ50% çš„å‡ºé”™æ¦‚ç‡ï¼Œè¿˜æœ‰æ ¡éªŒå’Œï¼Œä¹Ÿæœ‰ä¸å°çš„å‡ºé”™å¯èƒ½æ€§ï¼Œæ­¤å¤–å°±æ˜¯ CRC äº†ï¼Œå› ä¸ºé«˜æ•ˆä¸”æ£€é”™åŠ›å¾ˆé«˜ï¼Œè¢«å¹¿æ³›ç”¨åœ¨å­˜å‚¨ï¼Œå‹ç¼©ç­‰ä¹‹ä¸­ã€‚CRC32 æ˜¯ CRC æ ¡éªŒä¸­æœ€è¢«å¹¿æ³›ä½¿ç”¨çš„ä¹‹ä¸€ï¼Œä½†ä»–å¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå³ä¾¿ç¯¡æ”¹äº†å†…å®¹ï¼Œç”¨ CRC32 è¿›è¡Œæ ¡éªŒä¾ç„¶å¯èƒ½ä¼šå¾—åˆ°ç›¸åŒçš„å€¼ã€‚</p><p>é¢˜å¤–è¯ï¼Œå¦‚ä½•åœ¨å„ç§è¯­è¨€ä¸­ä½¿ç”¨ CRC32ï¼š<a href="https://rosettacode.org/wiki/CRC-32#Swift">https://rosettacode.org/wiki/CRC-32#Swift</a>ã€‚Swift çš„å®ç°æ³•å¯ä»¥è¯´å¹¶ä¸ä¸€å®šå®ç”¨ï¼Œä»–é€‰æ‹©äº†ç›´æ¥è°ƒç”¨ zlib ä¸­çš„ crc32 æ–¹æ³•w</p><h2>Strange Date Format</h2><p>e.g. 04/01, template = "Md"</p><p>en_US â‡’ 4/1</p><p>ja_JP â‡’ 4/1</p><p>en_JP â‡’ 04/01</p><blockquote><p><a href="https://stackoverflow.com/questions/67073224/get-a-unexpected-date-string-when-setting-template-to-md">https://stackoverflow.com/questions/67073224/get-a-unexpected-date-string-when-setting-template-to-md</a></p></blockquote><p>Still donâ€˜t know why Apple making this design..But we could resolve this <em>unexpected problem</em> by:</p><pre><code>formatter.<span class="property">dateFormat</span> = <span class="type">DateFormatter</span>.<span class="call">dateFormat</span>(
    fromTemplate: <span class="string">" Md"</span>,
    options: <span class="number">0</span>,
    locale: <span class="type">Locale</span>(identifier: <span class="string">"en_JP"</span>)
)?
.<span class="call">replacingOccurrences</span>(of: <span class="string">"MM"</span>, with: <span class="string">"M"</span>)
.<span class="call">replacingOccurrences</span>(of: <span class="string">"dd"</span>, with: <span class="string">"d"</span>)
</code></pre><h1>04/12</h1><hr><h2>SQL - Prepared Statement</h2><blockquote><p>INSERT INTO products (name, price) VALUES (?, ?);</p></blockquote><p>é€šå¸¸è¿™ä¹ˆåšçš„ä¼˜ç‚¹æ˜¯ï¼š</p><ol><li>é˜²æ­¢ SQL æ³¨å…¥</li><li>æ•ˆç‡æ›´é«˜ï¼Œé¿å…äº†å¤šæ¬¡è§£æç›¸åŒç»“æ„çš„ SQL è¯­å¥</li><li>...</li></ol><h1>04/08</h1><hr><h2>Attributes in Swift</h2><p>åˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><pre><code><span class="number">1</span>. <span class="keyword">@attribute</span> name
<span class="number">2</span>. <span class="keyword">@attribute</span>(attribute arguments)
</code></pre><p>ä»Šå¤©å†™äº†å†™ @inlineï¼Œå›å¿†äº†å‡ ä¸ªå¸¸ç”¨çš„ï¼š</p><h3>@inline å†…è”</h3><p>åœ¨ç¼–è¯‘çš„é˜¶æ®µç”¨å‡½æ•°ä½“å»æ›¿æ¢å‡½æ•°è°ƒç”¨ã€‚ä¼˜ç‚¹æ˜¯å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œä½†ä½œä¸ºäº¤æ¢ï¼Œbinary size ä¼šç•¥æœ‰å¢å¤§ã€‚</p><ul><li>@inline(_always) å¼ºåˆ¶å†…è”ï¼ˆä¸æ˜¯ 100%ï¼Œä¹Ÿæœ‰ä¾‹å¤–ï¼‰</li><li>@inline(never) æ— è®ºå¦‚ä½•éƒ½ä¸å†…è”</li></ul><h3>@inlinable å¯å†…è”</h3><p>å’Œ @inline çœ‹èµ·æ¥å¾ˆåƒï¼Œä½†æœ‰ç€æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚@inlinable å¯ä»¥ç”¨åœ¨ public å’Œ internal çš„æ–¹æ³•ï¼Œè®¡ç®—å±æ€§ç­‰ä¹‹ä¸Šï¼Œè¿™æ ·åœ¨æ¨¡å—å¤–è¢«è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œå†…è”ä¼˜åŒ–ã€‚è™½ç„¶å¯ä»¥è¢«ä¼˜åŒ–ï¼Œä½† internal ä¾ç„¶æ˜¯ä¸å¯ä»¥è¢«è®¿é—®çš„ï¼Œå¦å¤–ï¼Œå½“ä¸”ä»…ä½† internal è¢«æ ‡è®°ä¸º @usableFromInline çš„æ—¶å€™æ‰ä¼šè¢«ä½œä¸ºå¯¹è±¡ã€‚å¦‚æœåªå­˜åœ¨ä¸€ä¸ªæ¨¡å—ï¼Œå¹¶æ²¡æœ‰åªç”¨ @inlinable çš„å¿…è¦ã€‚</p><h3>@discardableResult å¯å¿½ç•¥çš„è¿”å›å€¼</h3><p>å…è®¸æœ‰è¿”å›å€¼çš„æ–¹æ³•ä¸è¿”å›ä»»ä½•å€¼</p><h3>@available</h3><p>æ˜¯ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„ attributeï¼Œç”¨äºæŒ‡å®šæœ€ä½ swift ç‰ˆæœ¬ï¼Œplatform çš„ç‰ˆæœ¬ä¹‹ç±»ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¼šå†™ @available(swift 99) æ¥é¿å…è¢« swift è°ƒç”¨ï¼Œ@available(iOS 14.0) æ¥ä½¿ç”¨ 14.0 æœ€æ–°çš„ APIã€‚</p><p>Ref. <a href="https://docs.swift.org/swift-book/ReferenceManual/Attributes.html#">https://docs.swift.org/swift-book/ReferenceManual/Attributes.html#</a></p><h1>04/07</h1><hr><h2>Access Photo Library</h2><p>Plist</p><ul><li>NSPhotoLibraryAddUsageDescription</li><li>NSPhotoLibraryUsageDescription</li><li>NSCameraUsageDescription</li></ul><h2>Render a UIView to a UIImage</h2><pre><code><span class="keyword">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(size: view.<span class="property">bounds</span>.<span class="property">size</span>)
<span class="keyword">let</span> image = renderer.<span class="call">image</span> { context <span class="keyword">in</span>
    view.<span class="call">drawHierarchy</span>(in: view.<span class="property">bounds</span>, afterScreenUpdates: <span class="keyword">true</span>)
}
</code></pre><h2>Take screenshot programmatically</h2><p><a href="https://developer.apple.com/library/archive/qa/qa1703/_index.html">https://developer.apple.com/library/archive/qa/qa1703/_index.html</a> (Outdated..)</p><h1>04/06</h1><hr><h2>Multi-cursor editing in Xcode</h2><ul><li>To add a new cursor, hold Control and SHIFT then click.</li><li>Hold Control and SHIFT then â†‘ or â†“</li><li>Hold Option then drag cursor around.</li></ul><h2>Formatter</h2><p><a href="https://nshipster.com/formatter/">https://nshipster.com/formatter/</a></p><p>å½“ä¸è®¾ç½®é»˜è®¤ template çš„æƒ…å†µä¸‹ï¼Œä¼šæŒ‰ç…§å„ <code>locale</code> çš„é»˜è®¤æ¨¡ç‰ˆæ¥æ˜¾ç¤ºæ—¥æœŸã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code><span class="comment">// JP: 2021/03/01
// KR: 2021.3.1.</span>

<span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()
formatter.<span class="property">locale</span> = locale
formatter.<span class="property">calendar</span> = <span class="type">Calendar</span>.<span class="property">autoupdatingCurrent</span>
formatter.<span class="property">dateStyle</span> = .<span class="dotAccess">short</span>
formatter.<span class="property">timeStyle</span> = .<span class="dotAccess">none</span>
</code></pre><p>è¿™åº”å½“è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¥½çš„å®è·µï¼Œå®Œå…¨å¯ä»¥å½“ä¸”ä»…å½“å¿…è¦çš„æ—¶å€™ä¸º <code>formatter</code> è®¾ç½® templateã€‚</p><h2>Detect user takes a screenshot</h2><pre><code><span class="type">NotificationCenter</span>.<span class="property">default</span>.<span class="call">addObserver</span>(
    <span class="keyword">self</span>,
    selector: <span class="keyword">#selector</span>(xxxxxx),
    name: <span class="type">UIApplication</span>.<span class="property">userDidTakeScreenshotNotification</span>,
    object: <span class="keyword">nil</span>
)
</code></pre><p>æ ¹æ®æ–‡æ¡£å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªé€šçŸ¥çš„ <code>userInfo</code> ä¸­å¹¶ä¸åŒ…å«ä»»ä½•ä¿¡æ¯ï¼Œä¸€ä¸ªæœ‰äº›ä»¤äººç»æœ›çš„æ¶ˆæ¯ã€‚è€ƒè™‘ä¸¤ä¸ªæ–¹æ¡ˆæ¥è·å¾—å›¾ç‰‡ã€‚</p><ol><li>ä»ç›¸å†Œè¯»å–ç¬¬ä¸€å¼ ç…§ç‰‡ï¼Œå¤šå°‘æœ‰äº› workaround çš„æ„å‘³ï¼Œå¹¶ä¸”éœ€è¦ç›¸å†Œæƒé™ã€‚</li><li>é‡æ–°æˆªå–å›¾ç‰‡ï¼Œæ½œåœ¨çš„é—®é¢˜æ˜¯æˆªå›¾å’Œç³»ç»Ÿæˆªå›¾å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚</li></ol><h1>04/05</h1><hr><h2>Long polling</h2><p>é•¿è½®è¯¢ï¼Œä¸è½®è¯¢çš„åŒºåˆ«åœ¨äºï¼Œåè€…æ˜¯ client å®šæœŸå»æ‹‰å–æ›´æ–°ï¼Œç»å¸¸ä¼šå¾—åˆ°ç©º responseï¼›è€Œé•¿è½®è¯¢ä¼š hold ä½è¿æ¥ï¼Œç›´åˆ° server æœ‰æ›´æ–°æ‰ä¼šè¿”å›ã€‚çœ‹ä¼¼ä¸€ç§ push çš„æ–¹å¼ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ pullã€‚</p><h1>04/02</h1><hr><h2>XCTUnwrap()</h2><p><a href="https://www.hackingwithswift.com/example-code/testing/how-to-check-and-unwrap-optionals-in-tests-using-xctunwrap">https://www.hackingwithswift.com/example-code/testing/how-to-check-and-unwrap-optionals-in-tests-using-xctunwrap</a></p><p>Easy to read than <code>guard</code> and <code>let</code>..</p></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/æ±‚ç´¢é›†">æ±‚ç´¢é›†</a></li><li><a href="/tags/ios">iOS</a></li><li><a href="/tags/swift">Swift</a></li><li><a href="/tags/til">TIL</a></li></ul></article></div><footer><p>Copyright Â© 2014-2022 Ckitakishi ğŸ¥‘ Powered by <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>